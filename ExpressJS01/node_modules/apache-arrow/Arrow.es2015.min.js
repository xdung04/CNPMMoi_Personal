// Licensed to the Apache Software Foundation (ASF) under one
// or more contributor license agreements.  See the NOTICE file
// distributed with this work for additional information
// regarding copyright ownership.  The ASF licenses this file
// to you under the Apache License, Version 2.0 (the
// "License"); you may not use this file except in compliance
// with the License.  You may obtain a copy of the License at
//
//   http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing,
// software distributed under the License is distributed on an
// "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
// KIND, either express or implied.  See the License for the
// specific language governing permissions and limitations
// under the License.
(function (global, factory) {
    typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :
    typeof define === 'function' && define.amd ? define(['exports'], factory) :
    (factory(global.Arrow = global.Arrow || {}));
}(this, (function (exports) {var h;function aa(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}}var ba=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,b,c){if(a==Array.prototype||a==Object.prototype)return a;a[b]=c.value;return a};
function ca(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var c=a[b];if(c&&c.Math==Math)return c}throw Error("Cannot find global object");}var da=ca(this);function ea(a,b){if(b)a:{var c=da;a=a.split(".");for(var d=0;d<a.length-1;d++){var e=a[d];if(!(e in c))break a;c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&b!=null&&ba(c,a,{configurable:!0,writable:!0,value:b})}}
ea("Symbol",function(a){function b(f){if(this instanceof b)throw new TypeError("Symbol is not a constructor");return new c(d+(f||"")+"_"+e++,f)}function c(f,g){this.Ib=f;ba(this,"description",{configurable:!0,writable:!0,value:g})}if(a)return a;c.prototype.toString=function(){return this.Ib};var d="jscomp_symbol_"+(Math.random()*1E9>>>0)+"_",e=0;return b});
ea("Symbol.iterator",function(a){if(a)return a;a=Symbol("Symbol.iterator");for(var b="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),c=0;c<b.length;c++){var d=da[b[c]];typeof d==="function"&&typeof d.prototype[a]!="function"&&ba(d.prototype,a,{configurable:!0,writable:!0,value:function(){return fa(aa(this))}})}return a});ea("Symbol.asyncIterator",function(a){return a?a:Symbol("Symbol.asyncIterator")});
ea("Symbol.toStringTag",function(a){return a?a:Symbol("Symbol.toStringTag")});function fa(a){a={next:a};a[Symbol.iterator]=function(){return this};return a}function ha(a){function b(d){return a.next(d)}function c(d){return a.throw(d)}return new Promise(function(d,e){function f(g){g.done?d(g.value):Promise.resolve(g.value).then(b,c).then(f,e)}f(a.next())})}function l(a){return ha(a())}
function ia(a){var b=a[Symbol.asyncIterator];if(b!==void 0)a=b.call(a);else{b=ja;var c=typeof Symbol!="undefined"&&Symbol.iterator&&a[Symbol.iterator];if(c)a=c.call(a);else if(typeof a.length=="number")a={next:aa(a)};else throw Error(String(a)+" is not an iterable or ArrayLike");a=new b(a)}return a}
function ja(a){this[Symbol.asyncIterator]=function(){return this};this[Symbol.iterator]=function(){return a};this.next=function(b){return Promise.resolve(a.next(b))};this["throw"]=function(b){return new Promise(function(c,d){var e=a["throw"];e!==void 0?c(e.call(a,b)):(c=a["return"],c!==void 0&&c.call(a),d(new TypeError("no `throw` method")))})};a["return"]!==void 0&&(this["return"]=function(b){return Promise.resolve(a["return"](b))})}function n(a,b){this.action=a;this.value=b}
function ka(a,b,c,d){this.method=a;this.ea=b;this.resolve=c;this.reject=d}function la(a){this.frame=a;this.next=null}function ma(){this.Ma=this.V=null}ma.prototype.first=function(){if(this.V)return this.V.frame;throw Error("no frames in executionQueue");};function na(a){a.V&&(a.V=a.V.next,a.V||(a.Ma=null))}ma.prototype.enqueue=function(a){a=new la(a);this.Ma?this.Ma.next=a:this.V=a;this.Ma=a};
function oa(a){this.Cb=a;this.S=null;this.L=new ma;this[Symbol.asyncIterator]=function(){return this};var b=this;this.Wb=function(c){var d=b.L.first();c.done===!0?(b.S=null,d.method="next",d.ea=c.value):(d.resolve({value:c.value,done:!1}),na(b.L));pa(b)};this.Vb=function(c){qa(b,c)};this.$a=function(c){ra(b,c)}}function ta(a,b,c){return new Promise(function(d,e){var f=a.L.V===null;a.L.enqueue(new ka(b,c,d,e));f&&pa(a)})}oa.prototype.next=function(a){return ta(this,"next",a)};
oa.prototype.return=function(a){return ta(this,"return",new n(0,a))};oa.prototype.throw=function(a){return ta(this,"throw",a)};function pa(a){if(a.L.V!==null)try{if(a.S){if(!a.S)throw Error("no delegate to perform execution");var b=a.L.first();if(b.method in a.S)try{a.S[b.method](b.ea).then(a.Wb,a.Vb).catch(a.$a)}catch(c){qa(a,c)}else a.S=null,pa(a)}else ua(a)}catch(c){ra(a,c)}}
function ua(a){var b=a.L.first();try{var c=a.Cb[b.method](b.ea);if(c.value instanceof n)switch(c.value.action){case 0:Promise.resolve(c.value.value).then(function(d){b.resolve({value:d,done:c.done});na(a.L);pa(a)},function(d){b.reject(d);na(a.L);pa(a)}).catch(a.$a);break;case 1:a.S=ia(c.value.value);b.method="next";b.ea=void 0;pa(a);break;case 2:Promise.resolve(c.value.value).then(function(d){b.method="next";b.ea=d;pa(a)},function(d){b.method="throw";b.ea=d;pa(a)}).catch(a.$a);break;default:throw Error("Unrecognized AsyncGeneratorWrapper$ActionEnum");
}else b.resolve(c),na(a.L),pa(a)}catch(d){b.reject(d),na(a.L),pa(a)}}function qa(a,b){var c=a.L.first();a.S=null;c.method="throw";c.ea=b;pa(a)}function ra(a,b){a.L.V!==null&&(a.L.first().reject(b),na(a.L));a.S&&"return"in a.S&&(a.S["return"](void 0),a.S=null);a.Cb["return"](void 0);pa(a)}const va=new TextDecoder("utf-8"),wa=a=>va.decode(a),xa=new TextEncoder;const q=a=>typeof a==="function",t=a=>a!=null&&Object(a)===a,ya=a=>"_getDOMStream"in a&&"_getNodeStream"in a,za=a=>t(a)&&q(a.cancel)&&q(a.getReader)&&!ya(a),Aa=a=>t(a)&&q(a.read)&&q(a.pipe)&&typeof a.readable==="boolean"&&!ya(a);const Ba=typeof SharedArrayBuffer!=="undefined"?SharedArrayBuffer:ArrayBuffer;function Ca(a){const b=a[0]?[a[0]]:[];let c,d,e,f;for(let g,k,m=0,p=0,r=a.length;++m<r;)g=b[p],k=a[m],!g||!k||g.buffer!==k.buffer||k.byteOffset<g.byteOffset?k&&(b[++p]=k):({byteOffset:c,byteLength:e}=g,{byteOffset:d,byteLength:f}=k,c+e<d||d+f<c?k&&(b[++p]=k):b[p]=new Uint8Array(g.buffer,c,d-c+f));return b}
function Da(a,b,c=0,d=b.byteLength){const e=a.byteLength,f=new Uint8Array(a.buffer,a.byteOffset,e);b=new Uint8Array(b.buffer,b.byteOffset,Math.min(d,e));f.set(b,c);return a}
function Ea(a,b){a=Ca(a);const c=a.reduce((m,p)=>m+p.byteLength,0);let d,e,f=0,g=-1;const k=Math.min(b||Number.POSITIVE_INFINITY,c);for(const m=a.length;++g<m;){b=a[g];d=b.subarray(0,Math.min(b.length,k-f));if(k<=f+d.length){d.length<b.length?a[g]=b.subarray(d.length):d.length===b.length&&g++;e?Da(e,d,f):e=d;break}Da(e||(e=new Uint8Array(k)),d,f);f+=d.length}return[e||new Uint8Array(0),a.slice(g),c-(e?e.byteLength:0)]}
function u(a,b){b=t(b)&&"done"in b&&"value"in b?b.value:b;if(b instanceof a)return a===Uint8Array?new a(b.buffer,b.byteOffset,b.byteLength):b;if(!b)return new a(0);typeof b==="string"&&(b=xa.encode(b));return b instanceof ArrayBuffer||b instanceof Ba?new a(b):t(b)&&q(b.clear)&&q(b.bytes)&&q(b.position)&&q(b.setPosition)&&q(b.capacity)&&q(b.getBufferIdentifier)&&q(b.createLong)?u(a,b.bytes()):ArrayBuffer.isView(b)?b.byteLength<=0?new a(0):new a(b.buffer,b.byteOffset,b.byteLength/a.BYTES_PER_ELEMENT):
a.from(b)}const Fa=a=>u(Uint8Array,a),Ga=a=>{a.next();return a};function*Ha(a,b){function*c(d){yield d}b=typeof b==="string"?c(b):ArrayBuffer.isView(b)?c(b):b instanceof ArrayBuffer?c(b):b instanceof Ba?c(b):t(b)&&q(b[Symbol.iterator])?b:c(b);yield*Ga(function*(d){let e=null;do e=d.next(yield u(a,e));while(!e.done)}(b[Symbol.iterator]()));return new a}
function Ja(a,b){return new oa(function*(){function c(f){return new oa(function*(){yield new n(1,Ga(function*(g){let k=null;do{let m;k=g.next(yield(m=k)==null?void 0:m.value)}while(!k.done)}(f[Symbol.iterator]())))}())}function d(f){return new oa(function*(){yield new n(0,yield new n(2,f))}())}if(t(b)&&q(b.then))return new n(0,yield new n(1,Ja(a,yield new n(2,b))));const e=typeof b==="string"?d(b):ArrayBuffer.isView(b)?d(b):b instanceof ArrayBuffer?d(b):b instanceof Ba?d(b):t(b)&&q(b[Symbol.iterator])?
c(b):t(b)&&q(b[Symbol.asyncIterator])?b:d(b);yield new n(1,Ga(function(f){return new oa(function*(){let g=null;do g=yield new n(2,f.next(yield new n(0,u(a,g))));while(!g.done)}())}(e[Symbol.asyncIterator]())));return new n(0,new a)}())}function Ka(a,b,c){if(a!==0){c=c.slice(0,b);for(let d=-1,e=c.length;++d<e;)c[d]+=a}return c.subarray(0,b)}function La(a,b){let c=0;const d=a.length;if(d!==b.length)return!1;if(d>0){do if(a[c]!==b[c])return!1;while(++c<d)}return!0}var v={};v.compareArrayLike=La;
v.joinUint8Arrays=Ea;v.memcpy=Da;v.rebaseValueOffsets=Ka;v.toArrayBufferView=u;v.toArrayBufferViewAsyncIterator=Ja;v.toArrayBufferViewIterator=Ha;v.toBigInt64Array=a=>u(BigInt64Array,a);v.toBigUint64Array=a=>u(BigUint64Array,a);v.toFloat32Array=a=>u(Float32Array,a);v.toFloat32ArrayAsyncIterator=a=>Ja(Float32Array,a);v.toFloat32ArrayIterator=a=>Ha(Float32Array,a);v.toFloat64Array=a=>u(Float64Array,a);v.toFloat64ArrayAsyncIterator=a=>Ja(Float64Array,a);v.toFloat64ArrayIterator=a=>Ha(Float64Array,a);
v.toInt16Array=a=>u(Int16Array,a);v.toInt16ArrayAsyncIterator=a=>Ja(Int16Array,a);v.toInt16ArrayIterator=a=>Ha(Int16Array,a);v.toInt32Array=a=>u(Int32Array,a);v.toInt32ArrayAsyncIterator=a=>Ja(Int32Array,a);v.toInt32ArrayIterator=a=>Ha(Int32Array,a);v.toInt8Array=a=>u(Int8Array,a);v.toInt8ArrayAsyncIterator=a=>Ja(Int8Array,a);v.toInt8ArrayIterator=a=>Ha(Int8Array,a);v.toUint16Array=a=>u(Uint16Array,a);v.toUint16ArrayAsyncIterator=a=>Ja(Uint16Array,a);v.toUint16ArrayIterator=a=>Ha(Uint16Array,a);
v.toUint32Array=a=>u(Uint32Array,a);v.toUint32ArrayAsyncIterator=a=>Ja(Uint32Array,a);v.toUint32ArrayIterator=a=>Ha(Uint32Array,a);v.toUint8Array=Fa;v.toUint8ArrayAsyncIterator=a=>Ja(Uint8Array,a);v.toUint8ArrayIterator=a=>Ha(Uint8Array,a);v.toUint8ClampedArray=a=>u(Uint8ClampedArray,a);v.toUint8ClampedArrayAsyncIterator=a=>Ja(Uint8ClampedArray,a);v.toUint8ClampedArrayIterator=a=>Ha(Uint8ClampedArray,a);function Ma(){throw Error('"toDOMStream" not available in this environment');}function Na(){throw Error('"toNodeStream" not available in this environment');}const Oa=a=>{a.next();return a};
function*Pa(a){let b,c=!1,d=[],e,f,g,k=0;({O:f,size:g}=(yield null)||{O:"read",size:0});a=Ha(Uint8Array,a)[Symbol.iterator]();try{do if({done:b,value:e}=Number.isNaN(g-k)?a.next():a.next(g-k),!b&&e.byteLength>0&&(d.push(e),k+=e.byteLength),b||g<=k){do{if(f==="peek")var m=Ea(d,g)[0];else[e,d,k]=Ea(d,g),m=e;({O:f,size:g}=yield m)}while(g<k)}while(!b)}catch(p){c=!0,typeof a.throw==="function"&&a.throw(p)}finally{c===!1&&typeof a.return==="function"&&a.return(null)}return null}
function Qa(a){return new oa(function*(){let b,c=!1,d=[],e,f,g,k=0;({O:f,size:g}=(yield new n(0,null))||{O:"read",size:0});const m=Ja(Uint8Array,a)[Symbol.asyncIterator]();try{do if({done:b,value:e}=Number.isNaN(g-k)?yield new n(2,m.next()):yield new n(2,m.next(g-k)),!b&&e.byteLength>0&&(d.push(e),k+=e.byteLength),b||g<=k){do{if(f==="peek")var p=Ea(d,g)[0];else[e,d,k]=Ea(d,g),p=e;({O:f,size:g}=yield new n(0,p))}while(g<k)}while(!b)}catch(r){c=!0,typeof m.throw==="function"&&(yield new n(2,m.throw(r)))}finally{c===
!1&&typeof m.return==="function"&&(yield new n(2,m.return(new Uint8Array(0))))}return new n(0,null)}())}
function Ra(a){return new oa(function*(){let b=!1,c=!1,d=[],e,f,g,k=0;({O:f,size:g}=(yield new n(0,null))||{O:"read",size:0});const m=new Sa(a);try{do if({done:b,value:e}=Number.isNaN(g-k)?yield new n(2,m.read()):yield new n(2,m.read(g-k)),!b&&e.byteLength>0&&(d.push(u(Uint8Array,e)),k+=e.byteLength),b||g<=k){do{if(f==="peek")var p=Ea(d,g)[0];else[e,d,k]=Ea(d,g),p=e;({O:f,size:g}=yield new n(0,p))}while(g<k)}while(!b)}catch(r){c=!0,yield new n(2,m.cancel(r))}finally{c===!1?yield new n(2,m.cancel()):
a.locked&&m.releaseLock()}return new n(0,null)}())}
class Sa{constructor(a){this.source=a;this.W=null;this.W=this.source.getReader();this.W.closed.catch(()=>{})}get closed(){return this.W?this.W.closed.catch(()=>{}):Promise.resolve()}releaseLock(){this.W&&this.W.releaseLock();this.W=null}cancel(a){const b=this;return l(function*(){const c=b.W,d=b.source;c&&(yield c.cancel(a).catch(()=>{}));d&&d.locked&&b.releaseLock()})}read(a){const b=this;return l(function*(){if(a===0)return{done:b.W==null,value:new Uint8Array(0)};const c=yield b.W.read();!c.done&&
(c.value=u(Uint8Array,c));return c})}}const Ta=(a,b)=>{const c=e=>d([b,e]);let d;return[b,c,new Promise(e=>(d=e)&&a.once(b,c))]};
function Ua(a){return new oa(function*(){function b(sa,Ia){r=p=null;return new Promise((Nc,rj)=>{for(const [Db,sj]of sa)a.off(Db,sj);try{const Db=a.destroy;Db&&Db.call(a,Ia);Ia=void 0}catch(Db){Ia=Db||Ia}finally{Ia!=null?rj(Ia):Nc()}})}const c=[];let d="error",e=!1,f=null,g,k,m=0,p=[],r;({O:g,size:k}=(yield new n(0,null))||{O:"read",size:0});if(a.isTTY)return yield new n(0,new Uint8Array(0)),new n(0,null);try{c[0]=Ta(a,"end");c[1]=Ta(a,"error");do{c[2]=Ta(a,"readable");[d,f]=yield new n(2,Promise.race(c.map(sa=>
sa[2])));if(d==="error")break;(e=d==="end")||(Number.isFinite(k-m)?(r=Fa(a.read(k-m)),r.byteLength<k-m&&(r=Fa(a.read()))):r=Fa(a.read()),r.byteLength>0&&(p.push(r),m+=r.byteLength));if(e||k<=m){do{if(g==="peek")var U=Ea(p,k)[0];else[r,p,m]=Ea(p,k),U=r;({O:g,size:k}=yield new n(0,U))}while(k<m)}}while(!e)}finally{yield new n(2,b(c,d==="error"?f:null))}return new n(0,null)}())};var w,Va=w||(w={});Va[Va.V1=0]="V1";Va[Va.V2=1]="V2";Va[Va.V3=2]="V3";Va[Va.V4=3]="V4";Va[Va.V5=4]="V5";var x,Wa=x||(x={});Wa[Wa.Sparse=0]="Sparse";Wa[Wa.Dense=1]="Dense";var y,Xa=y||(y={});Xa[Xa.HALF=0]="HALF";Xa[Xa.SINGLE=1]="SINGLE";Xa[Xa.DOUBLE=2]="DOUBLE";var Ya,Za=Ya||(Ya={});Za[Za.DAY=0]="DAY";Za[Za.MILLISECOND=1]="MILLISECOND";var z,$a=z||(z={});$a[$a.SECOND=0]="SECOND";$a[$a.MILLISECOND=1]="MILLISECOND";$a[$a.MICROSECOND=2]="MICROSECOND";$a[$a.NANOSECOND=3]="NANOSECOND";var A,ab=A||(A={});ab[ab.YEAR_MONTH=0]="YEAR_MONTH";ab[ab.DAY_TIME=1]="DAY_TIME";ab[ab.MONTH_DAY_NANO=2]="MONTH_DAY_NANO";const bb=new Int32Array(2);new Float32Array(bb.buffer);new Float64Array(bb.buffer);new Uint16Array((new Uint8Array([1,0])).buffer);var cb,db=cb||(cb={});db[db.UTF8_BYTES=1]="UTF8_BYTES";db[db.UTF16_STRING=2]="UTF16_STRING";function eb(a,b){return(a.l[b]|a.l[b+1]<<8)<<16>>16}function fb(a,b){return BigInt.asIntN(64,BigInt(a.v(b)>>>0)+(BigInt(a.v(b+4)>>>0)<<BigInt(32)))}function B(a,b,c){b-=a.v(b);return c<eb(a,b)?eb(a,b+c):0}function gb(a,b,c){b.h=c+a.v(c);b.g=a;return b}function hb(a,b,c){b+=a.v(b);const d=a.v(b);b+=4;b=a.l.subarray(b,b+d);return c===cb.UTF8_BYTES?b:a.ac.decode(b)}function ib(a,b){return b+a.v(b)}function jb(a,b){return b+a.v(b)+4}function kb(a,b){return a.v(b+a.v(b))}
class lb{constructor(a){this.l=a;this.gb=0;this.ac=new TextDecoder}clear(){this.gb=0}bytes(){return this.l}position(){return this.gb}setPosition(a){this.gb=a}v(a){return this.l[a]|this.l[a+1]<<8|this.l[a+2]<<16|this.l[a+3]<<24}ja(a,b){this.l[a]=b}lb(a,b){this.l[a]=b;this.l[a+1]=b>>8}Y(a,b){this.l[a]=b;this.l[a+1]=b>>8;this.l[a+2]=b>>16;this.l[a+3]=b>>24}aa(a,b){this.Y(a,Number(BigInt.asIntN(32,b)));this.Y(a+4,Number(BigInt.asIntN(32,b>>BigInt(32))))}};function mb(a){return a.g.bytes().subarray(a.g.position(),a.g.position()+a.offset())}function nb(a,b,c){b>a.ua&&(a.ua=b);const d=~(a.g.l.length-a.C+c)+1&b-1;for(;a.C<d+b+c;){const g=a.g.l.length;var e=a,f=a.g;const k=f.l.length;if(k&3221225472)throw Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");const m=k<<1,p=new lb(new Uint8Array(m));p.setPosition(m-k);p.bytes().set(f.bytes(),m-k);e.g=p;a.C+=a.g.l.length-g}a.pad(d)}function ob(a,b){nb(a,2,0);a.lb(b)}
function pb(a,b){nb(a,4,0);a.Y(b)}function qb(a,b,c,d){if(a.fa||c!=d)nb(a,1,0),a.ja(c),a.slot(b)}function rb(a,b,c){if(a.fa||b!=c)ob(a,b),a.slot(0)}function sb(a,b,c,d){if(a.fa||c!=d)pb(a,c),a.slot(b)}function tb(a,b,c){var d=BigInt("0");if(a.fa||c!==d)nb(a,8,0),a.aa(c),a.slot(b)}function ub(a,b){nb(a,4,0);a.Y(a.offset()-b+4)}function C(a,b,c){if(a.fa||c!=0)ub(a,c),a.slot(b)}function vb(a){if(a.ta)throw new TypeError("FlatBuffers: object serialization must not be nested.");}
function D(a,b){vb(a);a.X==null&&(a.X=[]);a.kb=b;for(let c=0;c<b;c++)a.X[c]=0;a.ta=!0;a.fb=a.offset()}
function E(a){if(a.X==null||!a.ta)throw Error("FlatBuffers: endObject called without startObject");pb(a,0);const b=a.offset();let c=a.kb-1;for(;c>=0&&a.X[c]==0;c--);for(var d=c+1;c>=0;c--)ob(a,a.X[c]!=0?b-a.X[c]:0);ob(a,b-a.fb);d=(d+2)*2;ob(a,d);let e=0;const f=a.C;c=0;a:for(;c<a.va.length;c++){const g=a.g.l.length-a.va[c];if(d==eb(a.g,g)){for(let k=2;k<d;k+=2)if(eb(a.g,f+k)!=eb(a.g,g+k))continue a;e=a.va[c];break}}e?(a.C=a.g.l.length-b,a.g.Y(a.C,e-b)):(a.va.push(a.offset()),a.g.Y(a.g.l.length-b,
a.offset()-b));a.ta=!1;return b}function wb(a,b,c,d){vb(a);a.jb=c;nb(a,4,b*c);nb(a,d,b*c)}function xb(a){a.Y(a.jb);return a.offset()}function yb(a,b){if(b===null||b===void 0)return 0;b=b instanceof Uint8Array?b:a.bc.encode(b);nb(a,1,0);a.ja(0);wb(a,1,b.length,1);a.g.setPosition(a.C-=b.length);a.g.bytes().set(b,a.C);return xb(a)}
class zb{constructor(){this.ua=1;this.X=null;this.kb=0;this.ta=!1;this.fb=0;this.va=[];this.jb=0;this.fa=!1;this.bc=new TextEncoder;this.g=new lb(new Uint8Array(1024));this.C=1024}clear(){this.g.clear();this.C=this.g.l.length;this.ua=1;this.X=null;this.kb=0;this.ta=!1;this.fb=0;this.va=[];this.jb=0;this.fa=!1}pad(a){for(let b=0;b<a;b++)this.g.ja(--this.C,0)}ja(a){this.g.ja(--this.C,a)}lb(a){this.g.lb(this.C-=2,a)}Y(a){this.g.Y(this.C-=4,a)}aa(a){this.g.aa(this.C-=8,a)}slot(a){this.X!==null&&(this.X[a]=
this.offset())}offset(){return this.g.l.length-this.C}finish(a,b,c){c=c?4:0;if(b){nb(this,this.ua,8+c);if(b.length!=4)throw new TypeError("FlatBuffers: file identifier must be length 4");for(let d=3;d>=0;d--)this.ja(b.charCodeAt(d))}nb(this,this.ua,4+c);ub(this,a);c&&pb(this,this.g.l.length-this.C);this.g.setPosition(this.C)}};var Ab,Bb=Ab||(Ab={});Bb[Bb.BUFFER=0]="BUFFER";var Cb,Eb=Cb||(Cb={});Eb[Eb.LZ4_FRAME=0]="LZ4_FRAME";Eb[Eb.ZSTD=1]="ZSTD";class Fb{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}codec(){const a=B(this.g,this.h,4);return a?this.g.l[this.h+a]<<24>>24:Cb.fc}method(){const a=B(this.g,this.h,6);return a?this.g.l[this.h+a]<<24>>24:Ab.dc}};class Gb{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}offset(){return fb(this.g,this.h)}length(){return fb(this.g,this.h+8)}};class Hb{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}length(){return fb(this.g,this.h)}nullCount(){return fb(this.g,this.h+8)}};function Ib(a){const b=B(a.g,a.h,6);return b?kb(a.g,a.h+b):0}function Jb(a){const b=B(a.g,a.h,8);return b?kb(a.g,a.h+b):0}class Kb{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}length(){const a=B(this.g,this.h,4);return a?fb(this.g,this.h+a):BigInt("0")}N(a,b){const c=B(this.g,this.h,6);return c?(b||new Hb).i(jb(this.g,this.h+c)+a*16,this.g):null}buffers(a,b){const c=B(this.g,this.h,8);return c?(b||new Gb).i(jb(this.g,this.h+c)+a*16,this.g):null}};class Lb{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}id(){const a=B(this.g,this.h,4);return a?fb(this.g,this.h+a):BigInt("0")}data(a){const b=B(this.g,this.h,6);return b?(a||new Kb).i(ib(this.g,this.h+b),this.g):null}Ja(){const a=B(this.g,this.h,8);return a?!!(this.g.l[this.h+a]<<24>>24):!1}};var Mb,Nb=Mb||(Mb={});Nb[Nb.Little=0]="Little";Nb[Nb.Big=1]="Big";var Ob,Pb=Ob||(Ob={});Pb[Pb.DenseArray=0]="DenseArray";class Qb{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}bitWidth(){const a=B(this.g,this.h,4);return a?this.g.v(this.h+a):0}isSigned(){const a=B(this.g,this.h,6);return a?!!(this.g.l[this.h+a]<<24>>24):!1}};function Rb(a){const b=B(a.g,a.h,6);return b?(new Qb).i(ib(a.g,a.h+b),a.g):null}class Sb{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}id(){const a=B(this.g,this.h,4);return a?fb(this.g,this.h+a):BigInt("0")}isOrdered(){const a=B(this.g,this.h,8);return a?!!(this.g.l[this.h+a]<<24>>24):!1}};class Tb{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}key(a){const b=B(this.g,this.h,4);return b?hb(this.g,this.h+b,a):null}value(a){const b=B(this.g,this.h,6);return b?hb(this.g,this.h+b,a):null}};class Ub{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}unit(){const a=B(this.g,this.h,4);return a?eb(this.g,this.h+a):Ya.MILLISECOND}};class Vb{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}precision(){const a=B(this.g,this.h,4);return a?this.g.v(this.h+a):0}scale(){const a=B(this.g,this.h,6);return a?this.g.v(this.h+a):0}bitWidth(){const a=B(this.g,this.h,8);return a?this.g.v(this.h+a):128}};class Wb{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}unit(){const a=B(this.g,this.h,4);return a?eb(this.g,this.h+a):z.MILLISECOND}};class Xb{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}byteWidth(){const a=B(this.g,this.h,4);return a?this.g.v(this.h+a):0}};class Yb{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}listSize(){const a=B(this.g,this.h,4);return a?this.g.v(this.h+a):0}};class Zb{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}precision(){const a=B(this.g,this.h,4);return a?eb(this.g,this.h+a):y.HALF}};class $b{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}unit(){const a=B(this.g,this.h,4);return a?eb(this.g,this.h+a):A.YEAR_MONTH}};class ac{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}keysSorted(){const a=B(this.g,this.h,4);return a?!!(this.g.l[this.h+a]<<24>>24):!1}};class bc{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}unit(){const a=B(this.g,this.h,4);return a?eb(this.g,this.h+a):z.MILLISECOND}bitWidth(){const a=B(this.g,this.h,6);return a?this.g.v(this.h+a):32}};class cc{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}unit(){const a=B(this.g,this.h,4);return a?eb(this.g,this.h+a):z.SECOND}timezone(a){const b=B(this.g,this.h,6);return b?hb(this.g,this.h+b,a):null}};class dc{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}mode(){const a=B(this.g,this.h,4);return a?eb(this.g,this.h+a):x.Sparse}typeIds(a){const b=B(this.g,this.h,6);return b?this.g.v(jb(this.g,this.h+b)+a*4):0}};var F,G=F||(F={});G[G.NONE=0]="NONE";G[G.Null=1]="Null";G[G.Int=2]="Int";G[G.FloatingPoint=3]="FloatingPoint";G[G.Binary=4]="Binary";G[G.Utf8=5]="Utf8";G[G.Bool=6]="Bool";G[G.Decimal=7]="Decimal";G[G.Date=8]="Date";G[G.Time=9]="Time";G[G.Timestamp=10]="Timestamp";G[G.Interval=11]="Interval";G[G.List=12]="List";G[G.Struct_=13]="Struct_";G[G.Union=14]="Union";G[G.FixedSizeBinary=15]="FixedSizeBinary";G[G.FixedSizeList=16]="FixedSizeList";G[G.Map=17]="Map";G[G.Duration=18]="Duration";
G[G.LargeBinary=19]="LargeBinary";G[G.LargeUtf8=20]="LargeUtf8";G[G.LargeList=21]="LargeList";G[G.RunEndEncoded=22]="RunEndEncoded";function ec(a,b){wb(a,4,b.length,4);for(let c=b.length-1;c>=0;c--)ub(a,b[c]);return xb(a)}function fc(a,b){wb(a,4,b.length,4);for(let c=b.length-1;c>=0;c--)ub(a,b[c]);return xb(a)}function hc(a){const b=B(a.g,a.h,14);return b?kb(a.g,a.h+b):0}
class ic{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}name(a){const b=B(this.g,this.h,4);return b?hb(this.g,this.h+b,a):null}nullable(){const a=B(this.g,this.h,6);return a?!!(this.g.l[this.h+a]<<24>>24):!1}type(a){const b=B(this.g,this.h,10);return b?gb(this.g,a,this.h+b):null}dictionary(a){const b=B(this.g,this.h,12);return b?(a||new Sb).i(ib(this.g,this.h+b),this.g):null}children(a,b){const c=B(this.g,this.h,14);return c?(b||new ic).i(ib(this.g,jb(this.g,this.h+c)+a*4),
this.g):null}Ga(a){const b=B(this.g,this.h,16);return b?(new Tb).i(ib(this.g,jb(this.g,this.h+b)+a*4),this.g):null}Ha(){const a=B(this.g,this.h,16);return a?kb(this.g,this.h+a):0}};function jc(a,b){wb(a,4,b.length,4);for(let c=b.length-1;c>=0;c--)ub(a,b[c]);return xb(a)}function kc(a,b){wb(a,4,b.length,4);for(let c=b.length-1;c>=0;c--)ub(a,b[c]);return xb(a)}function lc(a){const b=B(a.g,a.h,6);return b?kb(a.g,a.h+b):0}
class mc{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}fields(a,b){const c=B(this.g,this.h,6);return c?(b||new ic).i(ib(this.g,jb(this.g,this.h+c)+a*4),this.g):null}Ga(a){const b=B(this.g,this.h,8);return b?(new Tb).i(ib(this.g,jb(this.g,this.h+b)+a*4),this.g):null}Ha(){const a=B(this.g,this.h,8);return a?kb(this.g,this.h+a):0}features(a){const b=B(this.g,this.h,10);return b?fb(this.g,jb(this.g,this.h+b)+a*8):BigInt(0)}};var nc,oc=nc||(nc={});oc[oc.Row=0]="Row";oc[oc.Column=1]="Column";var pc,qc=pc||(pc={});qc[qc.NONE=0]="NONE";qc[qc.SparseTensorIndexCOO=1]="SparseTensorIndexCOO";qc[qc.SparseMatrixIndexCSX=2]="SparseMatrixIndexCSX";qc[qc.SparseTensorIndexCSF=3]="SparseTensorIndexCSF";var H,rc=H||(H={});rc[rc.NONE=0]="NONE";rc[rc.Schema=1]="Schema";rc[rc.DictionaryBatch=2]="DictionaryBatch";rc[rc.RecordBatch=3]="RecordBatch";rc[rc.Tensor=4]="Tensor";rc[rc.SparseTensor=5]="SparseTensor";var I,J=I||(I={});J[J.NONE=0]="NONE";J[J.Null=1]="Null";J[J.Int=2]="Int";J[J.Float=3]="Float";J[J.Binary=4]="Binary";J[J.Utf8=5]="Utf8";J[J.Bool=6]="Bool";J[J.Decimal=7]="Decimal";J[J.Date=8]="Date";J[J.Time=9]="Time";J[J.Timestamp=10]="Timestamp";J[J.Interval=11]="Interval";J[J.List=12]="List";J[J.Struct=13]="Struct";J[J.Union=14]="Union";J[J.FixedSizeBinary=15]="FixedSizeBinary";J[J.FixedSizeList=16]="FixedSizeList";J[J.Map=17]="Map";J[J.Duration=18]="Duration";J[J.LargeBinary=19]="LargeBinary";
J[J.LargeUtf8=20]="LargeUtf8";J[J.Dictionary=-1]="Dictionary";J[J.Int8=-2]="Int8";J[J.Int16=-3]="Int16";J[J.Int32=-4]="Int32";J[J.Int64=-5]="Int64";J[J.Uint8=-6]="Uint8";J[J.Uint16=-7]="Uint16";J[J.Uint32=-8]="Uint32";J[J.Uint64=-9]="Uint64";J[J.Float16=-10]="Float16";J[J.Float32=-11]="Float32";J[J.Float64=-12]="Float64";J[J.DateDay=-13]="DateDay";J[J.DateMillisecond=-14]="DateMillisecond";J[J.TimestampSecond=-15]="TimestampSecond";J[J.TimestampMillisecond=-16]="TimestampMillisecond";
J[J.TimestampMicrosecond=-17]="TimestampMicrosecond";J[J.TimestampNanosecond=-18]="TimestampNanosecond";J[J.TimeSecond=-19]="TimeSecond";J[J.TimeMillisecond=-20]="TimeMillisecond";J[J.TimeMicrosecond=-21]="TimeMicrosecond";J[J.TimeNanosecond=-22]="TimeNanosecond";J[J.DenseUnion=-23]="DenseUnion";J[J.SparseUnion=-24]="SparseUnion";J[J.IntervalDayTime=-25]="IntervalDayTime";J[J.IntervalYearMonth=-26]="IntervalYearMonth";J[J.DurationSecond=-27]="DurationSecond";J[J.DurationMillisecond=-28]="DurationMillisecond";
J[J.DurationMicrosecond=-29]="DurationMicrosecond";J[J.DurationNanosecond=-30]="DurationNanosecond";J[J.IntervalMonthDayNano=-31]="IntervalMonthDayNano";var sc,tc=sc||(sc={});tc[tc.OFFSET=0]="OFFSET";tc[tc.DATA=1]="DATA";tc[tc.VALIDITY=2]="VALIDITY";tc[tc.TYPE=3]="TYPE";function uc(a){if(a===null)return"null";if(a===void 0)return"undefined";switch(typeof a){case "number":return`${a}`;case "bigint":return`${a}`;case "string":return`"${a}"`}return typeof a[Symbol.toPrimitive]==="function"?a[Symbol.toPrimitive]("string"):ArrayBuffer.isView(a)?a instanceof BigInt64Array||a instanceof BigUint64Array?`[${[...a].map(b=>uc(b))}]`:`[${a}]`:ArrayBuffer.isView(a)?`[${a}]`:JSON.stringify(a,(b,c)=>typeof c==="bigint"?`${c}`:c)}var vc={};vc.valueToString=uc;function K(a){if(typeof a==="bigint"&&(a<Number.MIN_SAFE_INTEGER||a>Number.MAX_SAFE_INTEGER))throw new TypeError(`${a} is not safe to convert to a number.`);return Number(a)}function wc(a,b){return K(a/b)+K(a%b)/K(b)};const xc=Symbol.for("isArrowBigNum");function yc(a,...b){return b.length===0?Object.setPrototypeOf(u(this.TypedArray,a),this.constructor.prototype):Object.setPrototypeOf(new this.TypedArray(a,...b),this.constructor.prototype)}yc.prototype[xc]=!0;yc.prototype.toJSON=function(){return`"${zc(this)}"`};yc.prototype.valueOf=function(a){return Ac(this,a)};yc.prototype.toString=function(){return zc(this)};yc.prototype[Symbol.toPrimitive]=function(a="default"){switch(a){case "number":return Ac(this);case "default":return Bc(this)}return zc(this)};
function Cc(...a){return yc.apply(this,a)}function Dc(...a){return yc.apply(this,a)}function Ec(...a){return yc.apply(this,a)}Object.setPrototypeOf(Cc.prototype,Object.create(Int32Array.prototype));Object.setPrototypeOf(Dc.prototype,Object.create(Uint32Array.prototype));Object.setPrototypeOf(Ec.prototype,Object.create(Uint32Array.prototype));Object.assign(Cc.prototype,yc.prototype,{constructor:Cc,signed:!0,TypedArray:Int32Array,BigIntArray:BigInt64Array});
Object.assign(Dc.prototype,yc.prototype,{constructor:Dc,signed:!1,TypedArray:Uint32Array,BigIntArray:BigUint64Array});Object.assign(Ec.prototype,yc.prototype,{constructor:Ec,signed:!0,TypedArray:Uint32Array,BigIntArray:BigUint64Array});const Fc=BigInt(4294967296)*BigInt(4294967296)-BigInt(1);
function Ac(a,b){const {buffer:c,byteOffset:d,byteLength:e,signed:f}=a,g=new BigUint64Array(c,d,e/8);a=f&&g.at(-1)&BigInt(1)<<BigInt(63);var k=BigInt(0);let m=0;if(a){for(var p of g)k|=(p^Fc)*(BigInt(1)<<BigInt(64*m++));k*=BigInt(-1);k-=BigInt(1)}else for(var r of g)k|=r*(BigInt(1)<<BigInt(64*m++));return typeof b==="number"&&b>0?(r=BigInt("1".padEnd(b+1,"0")),p=a?-(k%r):k%r,k=K(k/r),+`${a&&k===0?"-":""}${k}.${`${p}`.padStart(b,"0")}`):K(k)}
function zc(a){if(a.byteLength===8)return`${(new a.BigIntArray(a.buffer,a.byteOffset,1))[0]}`;if(!a.signed)return Gc(a);let b=new Uint16Array(a.buffer,a.byteOffset,a.byteLength/2);if((new Int16Array([b.at(-1)]))[0]>=0)return Gc(a);b=b.slice();a=1;for(let c=0;c<b.length;c++){const d=b[c];b[c]=~d+a;a&=d===0?1:0}return`-${Gc(b)}`}function Bc(a){return a.byteLength===8?(new a.BigIntArray(a.buffer,a.byteOffset,1))[0]:zc(a)}
function Gc(a){let b="";const c=new Uint32Array(2);a=new Uint16Array(a.buffer,a.byteOffset,a.byteLength/2);const d=new Uint32Array((a=(new Uint16Array(a)).reverse()).buffer);let e;const f=a.length-1;do{for(c[0]=a[e=0];e<f;)a[e++]=c[1]=c[0]/10,c[0]=(c[0]-c[1]*10<<16)+a[e];a[e]=c[1]=c[0]/10;c[0]-=c[1]*10;b=`${c[0]}${b}`}while(d[0]||d[1]||d[2]||d[3]);let g;return(g=b)!=null?g:"0"}
class Hc{static new(a,b){switch(b){case !0:return new Cc(a);case !1:return new Dc(a)}switch(a.constructor){case Int8Array:case Int16Array:case Int32Array:case BigInt64Array:return new Cc(a)}return a.byteLength===16?new Ec(a):new Dc(a)}static kc(a){return new Cc(a)}constructor(a,b){return Hc.new(a,b)}}var Ic={};Ic.BN=Hc;Ic.bigNumToBigInt=Bc;Ic.bigNumToNumber=Ac;Ic.bigNumToString=zc;Ic.isArrowBigNumSymbol=xc;class L{static isNull(a){return(a==null?void 0:a.typeId)===I.Null}static isInt(a){return(a==null?void 0:a.typeId)===I.Int}static isFloat(a){return(a==null?void 0:a.typeId)===I.Float}static isBinary(a){return(a==null?void 0:a.typeId)===I.Binary}static isLargeBinary(a){return(a==null?void 0:a.typeId)===I.LargeBinary}static isUtf8(a){return(a==null?void 0:a.typeId)===I.Utf8}static isLargeUtf8(a){return(a==null?void 0:a.typeId)===I.LargeUtf8}static isBool(a){return(a==null?void 0:a.typeId)===I.Bool}static isDecimal(a){return(a==
null?void 0:a.typeId)===I.Decimal}static isDate(a){return(a==null?void 0:a.typeId)===I.Date}static isTime(a){return(a==null?void 0:a.typeId)===I.Time}static isTimestamp(a){return(a==null?void 0:a.typeId)===I.Timestamp}static isInterval(a){return(a==null?void 0:a.typeId)===I.Interval}static isDuration(a){return(a==null?void 0:a.typeId)===I.Duration}static isList(a){return(a==null?void 0:a.typeId)===I.List}static isStruct(a){return(a==null?void 0:a.typeId)===I.Struct}static isUnion(a){return(a==null?
void 0:a.typeId)===I.Union}static isFixedSizeBinary(a){return(a==null?void 0:a.typeId)===I.FixedSizeBinary}static isFixedSizeList(a){return(a==null?void 0:a.typeId)===I.FixedSizeList}static isMap(a){return(a==null?void 0:a.typeId)===I.Map}static isDictionary(a){return(a==null?void 0:a.typeId)===I.Dictionary}static isDenseUnion(a){return L.isUnion(a)&&a.mode===x.Dense}static isSparseUnion(a){return L.isUnion(a)&&a.mode===x.Sparse}constructor(a){this.typeId=a}}var Jc=Symbol.toStringTag,Kc,Lc=L.prototype;
Lc.children=null;Lc.ArrayType=Array;Lc.OffsetArrayType=Int32Array;Kc=Lc[Symbol.toStringTag]="DataType";L[Jc]=Kc;class Mc extends L{constructor(){super(I.Null)}toString(){return"Null"}}Mc[Symbol.toStringTag]=Mc.prototype[Symbol.toStringTag]="Null";
class Oc extends L{constructor(a,b){super(I.Int);this.isSigned=a;this.bitWidth=b}get ArrayType(){switch(this.bitWidth){case 8:return this.isSigned?Int8Array:Uint8Array;case 16:return this.isSigned?Int16Array:Uint16Array;case 32:return this.isSigned?Int32Array:Uint32Array;case 64:return this.isSigned?BigInt64Array:BigUint64Array}throw Error(`Unrecognized ${this[Symbol.toStringTag]} type`);}toString(){return`${this.isSigned?"I":"Ui"}nt${this.bitWidth}`}}var Pc=Symbol.toStringTag,Qc,Rc=Oc.prototype;
Rc.isSigned=null;Rc.bitWidth=null;Qc=Rc[Symbol.toStringTag]="Int";Oc[Pc]=Qc;class Sc extends Oc{constructor(){super(!0,8)}get ArrayType(){return Int8Array}}class Tc extends Oc{constructor(){super(!0,16)}get ArrayType(){return Int16Array}}class Uc extends Oc{constructor(){super(!0,32)}get ArrayType(){return Int32Array}}class Vc extends Oc{constructor(){super(!0,64)}get ArrayType(){return BigInt64Array}}class Wc extends Oc{constructor(){super(!1,8)}get ArrayType(){return Uint8Array}}
class Xc extends Oc{constructor(){super(!1,16)}get ArrayType(){return Uint16Array}}class Yc extends Oc{constructor(){super(!1,32)}get ArrayType(){return Uint32Array}}class Zc extends Oc{constructor(){super(!1,64)}get ArrayType(){return BigUint64Array}}Object.defineProperty(Sc.prototype,"ArrayType",{value:Int8Array});Object.defineProperty(Tc.prototype,"ArrayType",{value:Int16Array});Object.defineProperty(Uc.prototype,"ArrayType",{value:Int32Array});Object.defineProperty(Vc.prototype,"ArrayType",{value:BigInt64Array});
Object.defineProperty(Wc.prototype,"ArrayType",{value:Uint8Array});Object.defineProperty(Xc.prototype,"ArrayType",{value:Uint16Array});Object.defineProperty(Yc.prototype,"ArrayType",{value:Uint32Array});Object.defineProperty(Zc.prototype,"ArrayType",{value:BigUint64Array});
class $c extends L{constructor(a){super(I.Float);this.precision=a}get ArrayType(){switch(this.precision){case y.HALF:return Uint16Array;case y.SINGLE:return Float32Array;case y.DOUBLE:return Float64Array}throw Error(`Unrecognized ${this[Symbol.toStringTag]} type`);}toString(){return`Float${this.precision<<5||16}`}}var ad=Symbol.toStringTag,bd,cd=$c.prototype;cd.precision=null;bd=cd[Symbol.toStringTag]="Float";$c[ad]=bd;class dd extends $c{constructor(){super(y.HALF)}}
class ed extends $c{constructor(){super(y.SINGLE)}}class fd extends $c{constructor(){super(y.DOUBLE)}}Object.defineProperty(dd.prototype,"ArrayType",{value:Uint16Array});Object.defineProperty(ed.prototype,"ArrayType",{value:Float32Array});Object.defineProperty(fd.prototype,"ArrayType",{value:Float64Array});class gd extends L{constructor(){super(I.Binary)}toString(){return"Binary"}}var hd=Symbol.toStringTag,id,jd=gd.prototype;jd.ArrayType=Uint8Array;id=jd[Symbol.toStringTag]="Binary";gd[hd]=id;
class kd extends L{constructor(){super(I.LargeBinary)}toString(){return"LargeBinary"}}var ld=Symbol.toStringTag,md,nd=kd.prototype;nd.ArrayType=Uint8Array;nd.OffsetArrayType=BigInt64Array;md=nd[Symbol.toStringTag]="LargeBinary";kd[ld]=md;class od extends L{constructor(){super(I.Utf8)}toString(){return"Utf8"}}var pd=Symbol.toStringTag,qd,rd=od.prototype;rd.ArrayType=Uint8Array;qd=rd[Symbol.toStringTag]="Utf8";od[pd]=qd;
class sd extends L{constructor(){super(I.LargeUtf8)}toString(){return"LargeUtf8"}}var td=Symbol.toStringTag,ud,vd=sd.prototype;vd.ArrayType=Uint8Array;vd.OffsetArrayType=BigInt64Array;ud=vd[Symbol.toStringTag]="LargeUtf8";sd[td]=ud;class wd extends L{constructor(){super(I.Bool)}toString(){return"Bool"}}var xd=Symbol.toStringTag,yd,zd=wd.prototype;zd.ArrayType=Uint8Array;yd=zd[Symbol.toStringTag]="Bool";wd[xd]=yd;
class Ad extends L{constructor(a,b,c=128){super(I.Decimal);this.scale=a;this.precision=b;this.bitWidth=c}toString(){return`Decimal[${this.precision}e${this.scale>0?"+":""}${this.scale}]`}}var Bd=Symbol.toStringTag,Cd,Dd=Ad.prototype;Dd.scale=null;Dd.precision=null;Dd.ArrayType=Uint32Array;Cd=Dd[Symbol.toStringTag]="Decimal";Ad[Bd]=Cd;
class Ed extends L{constructor(a){super(I.Date);this.unit=a}toString(){return`Date${(this.unit+1)*32}<${Ya[this.unit]}>`}get ArrayType(){return this.unit===Ya.DAY?Int32Array:BigInt64Array}}var Fd=Symbol.toStringTag,Gd,Hd=Ed.prototype;Hd.unit=null;Gd=Hd[Symbol.toStringTag]="Date";Ed[Fd]=Gd;class Id extends Ed{constructor(){super(Ya.DAY)}}class Jd extends Ed{constructor(){super(Ya.MILLISECOND)}}
class Kd extends L{constructor(a,b){super(I.Time);this.unit=a;this.bitWidth=b}toString(){return`Time${this.bitWidth}<${z[this.unit]}>`}get ArrayType(){switch(this.bitWidth){case 32:return Int32Array;case 64:return BigInt64Array}throw Error(`Unrecognized ${this[Symbol.toStringTag]} type`);}}var Ld=Symbol.toStringTag,Md,Nd=Kd.prototype;Nd.unit=null;Nd.bitWidth=null;Md=Nd[Symbol.toStringTag]="Time";Kd[Ld]=Md;class Od extends Kd{constructor(){super(z.SECOND,32)}}
class Pd extends Kd{constructor(){super(z.MILLISECOND,32)}}class Qd extends Kd{constructor(){super(z.MICROSECOND,64)}}class Rd extends Kd{constructor(){super(z.NANOSECOND,64)}}class Sd extends L{constructor(a,b){super(I.Timestamp);this.unit=a;this.timezone=b}toString(){return`Timestamp<${z[this.unit]}${this.timezone?`, ${this.timezone}`:""}>`}}var Td=Symbol.toStringTag,Ud,Vd=Sd.prototype;Vd.unit=null;Vd.timezone=null;Vd.ArrayType=BigInt64Array;Ud=Vd[Symbol.toStringTag]="Timestamp";Sd[Td]=Ud;
class Wd extends Sd{constructor(a){super(z.SECOND,a)}}class Xd extends Sd{constructor(a){super(z.MILLISECOND,a)}}class Yd extends Sd{constructor(a){super(z.MICROSECOND,a)}}class Zd extends Sd{constructor(a){super(z.NANOSECOND,a)}}class $d extends L{constructor(a){super(I.Interval);this.unit=a}toString(){return`Interval<${A[this.unit]}>`}}var ae=Symbol.toStringTag,be,ce=$d.prototype;ce.unit=null;ce.ArrayType=Int32Array;be=ce[Symbol.toStringTag]="Interval";$d[ae]=be;
class de extends $d{constructor(){super(A.DAY_TIME)}}class ee extends $d{constructor(){super(A.YEAR_MONTH)}}class fe extends $d{constructor(){super(A.MONTH_DAY_NANO)}}class ge extends L{constructor(a){super(I.Duration);this.unit=a}toString(){return`Duration<${z[this.unit]}>`}}var he=Symbol.toStringTag,ie,je=ge.prototype;je.unit=null;je.ArrayType=BigInt64Array;ie=je[Symbol.toStringTag]="Duration";ge[he]=ie;class ke extends ge{constructor(){super(z.SECOND)}}
class le extends ge{constructor(){super(z.MILLISECOND)}}class me extends ge{constructor(){super(z.MICROSECOND)}}class ne extends ge{constructor(){super(z.NANOSECOND)}}class oe extends L{constructor(a){super(I.List);this.children=[a]}toString(){return`List<${this.valueType}>`}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}}var pe=Symbol.toStringTag,qe,re=oe.prototype;re.children=null;qe=re[Symbol.toStringTag]="List";
oe[pe]=qe;class se extends L{constructor(a){super(I.Struct);this.children=a}toString(){return`Struct<{${this.children.map(a=>`${a.name}:${a.type}`).join(", ")}}>`}}var te=Symbol.toStringTag,ue,ve=se.prototype;ve.children=null;ue=ve[Symbol.toStringTag]="Struct";se[te]=ue;
class we extends L{constructor(a,b,c){super(I.Union);this.mode=a;this.children=c;this.typeIds=b=Int32Array.from(b);this.typeIdToChildIndex=b.reduce((d,e,f)=>(d[e]=f)&&d||d,Object.create(null))}toString(){return`${this[Symbol.toStringTag]}<${this.children.map(a=>`${a.type}`).join(" | ")}>`}}var xe=Symbol.toStringTag,ye,ze=we.prototype;ze.mode=null;ze.typeIds=null;ze.children=null;ze.typeIdToChildIndex=null;ze.ArrayType=Int8Array;ye=ze[Symbol.toStringTag]="Union";we[xe]=ye;
class Ae extends we{constructor(a,b){super(x.Dense,a,b)}}class Be extends we{constructor(a,b){super(x.Sparse,a,b)}}class Ce extends L{constructor(a){super(I.FixedSizeBinary);this.byteWidth=a}toString(){return`FixedSizeBinary[${this.byteWidth}]`}}var De=Symbol.toStringTag,Ee,Fe=Ce.prototype;Fe.byteWidth=null;Fe.ArrayType=Uint8Array;Ee=Fe[Symbol.toStringTag]="FixedSizeBinary";Ce[De]=Ee;
class Ge extends L{constructor(a,b){super(I.FixedSizeList);this.listSize=a;this.children=[b]}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}toString(){return`FixedSizeList[${this.listSize}]<${this.valueType}>`}}var He=Symbol.toStringTag,Ie,Je=Ge.prototype;Je.children=null;Je.listSize=null;Ie=Je[Symbol.toStringTag]="FixedSizeList";Ge[He]=Ie;
class Ke extends L{constructor(a,b=!1){super(I.Map);this.children=[a];this.keysSorted=b;if(a){a.name="entries";let c;if(a==null?0:(c=a.type)==null?0:c.children){let d;(b=a==null?void 0:(d=a.type)==null?void 0:d.children[0])&&(b.name="key");let e;(a=a==null?void 0:(e=a.type)==null?void 0:e.children[1])&&(a.name="value")}}}get keyType(){return this.children[0].type.children[0].type}get valueType(){return this.children[0].type.children[1].type}get childType(){return this.children[0].type}toString(){return`Map<{${this.children[0].type.children.map(a=>
`${a.name}:${a.type}`).join(", ")}}>`}}var Le=Symbol.toStringTag,Me,Ne=Ke.prototype;Ne.children=null;Ne.keysSorted=null;Me=Ne[Symbol.toStringTag]="Map_";Ke[Le]=Me;const Oe=(a=>()=>++a)(-1);
class Pe extends L{constructor(a,b,c,d){super(I.Dictionary);this.indices=b;this.dictionary=a;this.isOrdered=d||!1;this.id=c==null?Oe():K(c)}get children(){return this.dictionary.children}get valueType(){return this.dictionary}get ArrayType(){return this.dictionary.ArrayType}toString(){return`Dictionary<${this.indices}, ${this.dictionary}>`}}var Qe=Symbol.toStringTag,Re,Se=Pe.prototype;Se.id=null;Se.indices=null;Se.isOrdered=null;Se.dictionary=null;Re=Se[Symbol.toStringTag]="Dictionary";Pe[Qe]=Re;
function Te(a){switch(a.typeId){case I.Decimal:return a.bitWidth/32;case I.Interval:return a.unit===A.MONTH_DAY_NANO?4:1+a.unit;case I.FixedSizeList:return a.listSize;case I.FixedSizeBinary:return a.byteWidth;default:return 1}};class Ue{visitMany(a,...b){return a.map((c,d)=>this.visit(c,...b.map(e=>e[d])))}visit(...a){return this.getVisitFn(a[0],!1).apply(this,a)}getVisitFn(a,b=!0){return Ve(this,a,b)}getVisitFnByTypeId(a,b=!0){return We(this,a,b)}visitNull(){return null}visitBool(){return null}visitInt(){return null}visitFloat(){return null}visitUtf8(){return null}visitLargeUtf8(){return null}visitBinary(){return null}visitLargeBinary(){return null}visitFixedSizeBinary(){return null}visitDate(){return null}visitTimestamp(){return null}visitTime(){return null}visitDecimal(){return null}visitList(){return null}visitStruct(){return null}visitUnion(){return null}visitDictionary(){return null}visitInterval(){return null}visitDuration(){return null}visitFixedSizeList(){return null}visitMap(){return null}}
function Ve(a,b,c=!0){return typeof b==="number"?We(a,b,c):typeof b==="string"&&b in I?We(a,I[b],c):b&&b instanceof L?We(a,Xe(b),c):(b==null?0:b.type)&&b.type instanceof L?We(a,Xe(b.type),c):We(a,I.NONE,c)}
function We(a,b,c=!0){let d=null;switch(b){case I.Null:d=a.visitNull;break;case I.Bool:d=a.visitBool;break;case I.Int:d=a.visitInt;break;case I.Int8:d=a.visitInt8||a.visitInt;break;case I.Int16:d=a.visitInt16||a.visitInt;break;case I.Int32:d=a.visitInt32||a.visitInt;break;case I.Int64:d=a.visitInt64||a.visitInt;break;case I.Uint8:d=a.visitUint8||a.visitInt;break;case I.Uint16:d=a.visitUint16||a.visitInt;break;case I.Uint32:d=a.visitUint32||a.visitInt;break;case I.Uint64:d=a.visitUint64||a.visitInt;
break;case I.Float:d=a.visitFloat;break;case I.Float16:d=a.visitFloat16||a.visitFloat;break;case I.Float32:d=a.visitFloat32||a.visitFloat;break;case I.Float64:d=a.visitFloat64||a.visitFloat;break;case I.Utf8:d=a.visitUtf8;break;case I.LargeUtf8:d=a.visitLargeUtf8;break;case I.Binary:d=a.visitBinary;break;case I.LargeBinary:d=a.visitLargeBinary;break;case I.FixedSizeBinary:d=a.visitFixedSizeBinary;break;case I.Date:d=a.visitDate;break;case I.DateDay:d=a.visitDateDay||a.visitDate;break;case I.DateMillisecond:d=
a.visitDateMillisecond||a.visitDate;break;case I.Timestamp:d=a.visitTimestamp;break;case I.TimestampSecond:d=a.visitTimestampSecond||a.visitTimestamp;break;case I.TimestampMillisecond:d=a.visitTimestampMillisecond||a.visitTimestamp;break;case I.TimestampMicrosecond:d=a.visitTimestampMicrosecond||a.visitTimestamp;break;case I.TimestampNanosecond:d=a.visitTimestampNanosecond||a.visitTimestamp;break;case I.Time:d=a.visitTime;break;case I.TimeSecond:d=a.visitTimeSecond||a.visitTime;break;case I.TimeMillisecond:d=
a.visitTimeMillisecond||a.visitTime;break;case I.TimeMicrosecond:d=a.visitTimeMicrosecond||a.visitTime;break;case I.TimeNanosecond:d=a.visitTimeNanosecond||a.visitTime;break;case I.Decimal:d=a.visitDecimal;break;case I.List:d=a.visitList;break;case I.Struct:d=a.visitStruct;break;case I.Union:d=a.visitUnion;break;case I.DenseUnion:d=a.visitDenseUnion||a.visitUnion;break;case I.SparseUnion:d=a.visitSparseUnion||a.visitUnion;break;case I.Dictionary:d=a.visitDictionary;break;case I.Interval:d=a.visitInterval;
break;case I.IntervalDayTime:d=a.visitIntervalDayTime||a.visitInterval;break;case I.IntervalYearMonth:d=a.visitIntervalYearMonth||a.visitInterval;break;case I.IntervalMonthDayNano:d=a.visitIntervalMonthDayNano||a.visitInterval;break;case I.Duration:d=a.visitDuration;break;case I.DurationSecond:d=a.visitDurationSecond||a.visitDuration;break;case I.DurationMillisecond:d=a.visitDurationMillisecond||a.visitDuration;break;case I.DurationMicrosecond:d=a.visitDurationMicrosecond||a.visitDuration;break;case I.DurationNanosecond:d=
a.visitDurationNanosecond||a.visitDuration;break;case I.FixedSizeList:d=a.visitFixedSizeList;break;case I.Map:d=a.visitMap}if(typeof d==="function")return d;if(!c)return()=>null;throw Error(`Unrecognized type '${I[b]}'`);}
function Xe(a){switch(a.typeId){case I.Null:return I.Null;case I.Int:const b=a.isSigned;switch(a.bitWidth){case 8:return b?I.Int8:I.Uint8;case 16:return b?I.Int16:I.Uint16;case 32:return b?I.Int32:I.Uint32;case 64:return b?I.Int64:I.Uint64}return I.Int;case I.Float:switch(a.precision){case y.HALF:return I.Float16;case y.SINGLE:return I.Float32;case y.DOUBLE:return I.Float64}return I.Float;case I.Binary:return I.Binary;case I.LargeBinary:return I.LargeBinary;case I.Utf8:return I.Utf8;case I.LargeUtf8:return I.LargeUtf8;
case I.Bool:return I.Bool;case I.Decimal:return I.Decimal;case I.Time:switch(a.unit){case z.SECOND:return I.TimeSecond;case z.MILLISECOND:return I.TimeMillisecond;case z.MICROSECOND:return I.TimeMicrosecond;case z.NANOSECOND:return I.TimeNanosecond}return I.Time;case I.Timestamp:switch(a.unit){case z.SECOND:return I.TimestampSecond;case z.MILLISECOND:return I.TimestampMillisecond;case z.MICROSECOND:return I.TimestampMicrosecond;case z.NANOSECOND:return I.TimestampNanosecond}return I.Timestamp;case I.Date:switch(a.unit){case Ya.DAY:return I.DateDay;
case Ya.MILLISECOND:return I.DateMillisecond}return I.Date;case I.Interval:switch(a.unit){case A.DAY_TIME:return I.IntervalDayTime;case A.YEAR_MONTH:return I.IntervalYearMonth;case A.MONTH_DAY_NANO:return I.IntervalMonthDayNano}return I.Interval;case I.Duration:switch(a.unit){case z.SECOND:return I.DurationSecond;case z.MILLISECOND:return I.DurationMillisecond;case z.MICROSECOND:return I.DurationMicrosecond;case z.NANOSECOND:return I.DurationNanosecond}return I.Duration;case I.Map:return I.Map;case I.List:return I.List;
case I.Struct:return I.Struct;case I.Union:switch(a.mode){case x.Dense:return I.DenseUnion;case x.Sparse:return I.SparseUnion}return I.Union;case I.FixedSizeBinary:return I.FixedSizeBinary;case I.FixedSizeList:return I.FixedSizeList;case I.Dictionary:return I.Dictionary}throw Error(`Unrecognized type '${I[a.typeId]}'`);}h=Ue.prototype;h.visitInt8=null;h.visitInt16=null;h.visitInt32=null;h.visitInt64=null;h.visitUint8=null;h.visitUint16=null;h.visitUint32=null;h.visitUint64=null;h.visitFloat16=null;
h.visitFloat32=null;h.visitFloat64=null;h.visitDateDay=null;h.visitDateMillisecond=null;h.visitTimestampSecond=null;h.visitTimestampMillisecond=null;h.visitTimestampMicrosecond=null;h.visitTimestampNanosecond=null;h.visitTimeSecond=null;h.visitTimeMillisecond=null;h.visitTimeMicrosecond=null;h.visitTimeNanosecond=null;h.visitDenseUnion=null;h.visitSparseUnion=null;h.visitIntervalDayTime=null;h.visitIntervalYearMonth=null;h.visitIntervalMonthDayNano=null;h.visitDuration=null;
h.visitDurationSecond=null;h.visitDurationMillisecond=null;h.visitDurationMicrosecond=null;h.visitDurationNanosecond=null;const Ye=new Float64Array(1),Ze=new Uint32Array(Ye.buffer);function $e(a){const b=(a&31744)>>10,c=(a&1023)/1024;a=Math.pow(-1,(a&32768)>>15);switch(b){case 31:return a*(c?Number.NaN:1/0);case 0:return a*(c?6.103515625E-5*c:0)}return a*Math.pow(2,b-15)*(1+c)}
function af(a){if(a!==a)return 32256;Ye[0]=a;a=(Ze[1]&2147483648)>>16&65535;let b=Ze[1]&2146435072,c=0;b>=1089470464?Ze[0]>0?b=31744:(b=(b&2080374784)>>16,c=(Ze[1]&1048575)>>10):b<=1056964608?(c=1048576+(Ze[1]&1048575),c=1048576+(c<<(b>>20)-998)>>21,b=0):(b=b-1056964608>>10,c=(Ze[1]&1048575)+512>>10);return a|b|c&65535}var bf={};bf.float64ToUint16=af;bf.uint16ToFloat64=$e;class cf extends Ue{}function M(a){return(b,c,d)=>{if(b.setValid(c,d!=null))return a(b,c,d)}}
const df=(a,b,c,d)=>{if(c+1<b.length){const e=K(b[c]);b=K(b[c+1]);a.set(d.subarray(0,b-e),e)}},ef=({values:a},b,c)=>{a[b]=c},ff=({values:a},b,c)=>{a[b]=c},gf=({values:a},b,c)=>{a[b]=af(c)},hf=({values:a},b,c)=>{a[b]=Math.floor(c.valueOf()/864E5)},jf=({values:a},b,c)=>{a[b]=BigInt(c)},kf=({stride:a,values:b},c,d)=>{b.set(d.subarray(0,a),a*c)},lf=({values:a,valueOffsets:b},c,d)=>df(a,b,c,d),mf=({values:a,valueOffsets:b},c,d)=>df(a,b,c,xa.encode(d)),nf=(a,b,c)=>{a.type.unit===Ya.DAY?hf(a,b,c):jf(a,b,
c)},of=({values:a},b,c)=>{a[b]=BigInt(c/1E3)},pf=({values:a},b,c)=>{a[b]=BigInt(c)},qf=({values:a},b,c)=>{a[b]=BigInt(c*1E3)},rf=({values:a},b,c)=>{a[b]=BigInt(c*1E6)},sf=(a,b,c)=>{switch(a.type.unit){case z.SECOND:return of(a,b,c);case z.MILLISECOND:return pf(a,b,c);case z.MICROSECOND:return qf(a,b,c);case z.NANOSECOND:return rf(a,b,c)}},tf=({values:a},b,c)=>{a[b]=c},uf=({values:a},b,c)=>{a[b]=c},vf=({values:a},b,c)=>{a[b]=c},wf=({values:a},b,c)=>{a[b]=c},xf=(a,b,c)=>{switch(a.type.unit){case z.SECOND:return tf(a,
b,c);case z.MILLISECOND:return uf(a,b,c);case z.MICROSECOND:return vf(a,b,c);case z.NANOSECOND:return wf(a,b,c)}},yf=({values:a,stride:b},c,d)=>{a.set(d.subarray(0,b),b*c)},zf=(a,b)=>(c,d,e,f)=>d&&c(d,a,b[f]),Af=(a,b)=>(c,d,e,f)=>d&&c(d,a,b.get(f)),Bf=(a,b)=>(c,d,e)=>d&&c(d,a,b.get(e.name)),Cf=(a,b)=>(c,d,e)=>d&&c(d,a,b[e.name]),Ef=(a,b,c)=>{Df.visit(a.children[a.type.typeIdToChildIndex[a.typeIds[b]]],a.valueOffsets[b],c)},Ff=(a,b,c)=>{Df.visit(a.children[a.type.typeIdToChildIndex[a.typeIds[b]]],
b,c)},Jf=(a,b,c)=>{switch(a.type.unit){case A.YEAR_MONTH:return Gf(a,b,c);case A.DAY_TIME:return Hf(a,b,c);case A.MONTH_DAY_NANO:return If(a,b,c)}},Hf=({values:a},b,c)=>{a.set(c.subarray(0,2),2*b)},Gf=({values:a},b,c)=>{a[b]=c[0]*12+c[1]%12},If=({values:a,stride:b},c,d)=>{a.set(d.subarray(0,b),b*c)},Kf=({values:a},b,c)=>{a[b]=c},Lf=({values:a},b,c)=>{a[b]=c},Mf=({values:a},b,c)=>{a[b]=c},Nf=({values:a},b,c)=>{a[b]=c},Of=(a,b,c)=>{switch(a.type.unit){case z.SECOND:return Kf(a,b,c);case z.MILLISECOND:return Lf(a,
b,c);case z.MICROSECOND:return Mf(a,b,c);case z.NANOSECOND:return Nf(a,b,c)}};h=cf.prototype;h.visitBool=M(({offset:a,values:b},c,d)=>{a+=c;d?b[a>>3]|=1<<a%8:b[a>>3]&=~(1<<a%8)});h.visitInt=M(ef);h.visitInt8=M(ef);h.visitInt16=M(ef);h.visitInt32=M(ef);h.visitInt64=M(ef);h.visitUint8=M(ef);h.visitUint16=M(ef);h.visitUint32=M(ef);h.visitUint64=M(ef);h.visitFloat=M((a,b,c)=>{switch(a.type.precision){case y.HALF:return gf(a,b,c);case y.SINGLE:case y.DOUBLE:return ff(a,b,c)}});h.visitFloat16=M(gf);
h.visitFloat32=M(ff);h.visitFloat64=M(ff);h.visitUtf8=M(mf);h.visitLargeUtf8=M(mf);h.visitBinary=M(lf);h.visitLargeBinary=M(lf);h.visitFixedSizeBinary=M(kf);h.visitDate=M(nf);h.visitDateDay=M(hf);h.visitDateMillisecond=M(jf);h.visitTimestamp=M(sf);h.visitTimestampSecond=M(of);h.visitTimestampMillisecond=M(pf);h.visitTimestampMicrosecond=M(qf);h.visitTimestampNanosecond=M(rf);h.visitTime=M(xf);h.visitTimeSecond=M(tf);h.visitTimeMillisecond=M(uf);h.visitTimeMicrosecond=M(vf);h.visitTimeNanosecond=M(wf);
h.visitDecimal=M(yf);h.visitList=M((a,b,c)=>{const d=a.children[0];a=a.valueOffsets;const e=Df.getVisitFn(d);if(Array.isArray(c))for(let f=-1,g=a[b],k=a[b+1];g<k;)e(d,g++,c[++f]);else for(let f=-1,g=a[b],k=a[b+1];g<k;)e(d,g++,c.get(++f))});h.visitStruct=M((a,b,c)=>{const d=a.type.children.map(f=>Df.getVisitFn(f.type)),e=c instanceof Map?Bf(b,c):c instanceof N?Af(b,c):Array.isArray(c)?zf(b,c):Cf(b,c);a.type.children.forEach((f,g)=>e(d[g],a.children[g],f,g))});
h.visitUnion=M((a,b,c)=>{a.type.mode===x.Dense?Ef(a,b,c):Ff(a,b,c)});h.visitDenseUnion=M(Ef);h.visitSparseUnion=M(Ff);h.visitDictionary=M((a,b,c)=>{let d;(d=a.dictionary)==null||d.set(a.values[b],c)});h.visitInterval=M(Jf);h.visitIntervalDayTime=M(Hf);h.visitIntervalYearMonth=M(Gf);h.visitIntervalMonthDayNano=M(If);h.visitDuration=M(Of);h.visitDurationSecond=M(Kf);h.visitDurationMillisecond=M(Lf);h.visitDurationMicrosecond=M(Mf);h.visitDurationNanosecond=M(Nf);
h.visitFixedSizeList=M((a,b,c)=>{const d=a.stride;a=a.children[0];const e=Df.getVisitFn(a);if(Array.isArray(c))for(let f=-1,g=b*d;++f<d;)e(a,g+f,c[f]);else for(let f=-1,g=b*d;++f<d;)e(a,g+f,c.get(f))});h.visitMap=M((a,b,c)=>{const d=a.children[0],e=a.valueOffsets;a=Df.getVisitFn(d);let {[b]:f,[b+1]:g}=e;b=c instanceof Map?c.entries():Object.entries(c);for(const k of b)if(a(d,f,k),++f>=g)break});const Df=new cf;const Pf=Symbol.for("parent"),Qf=Symbol.for("rowIndex");
class Rf{constructor(a,b){this[Pf]=a;this[Qf]=b;return new Proxy(this,Sf)}toArray(){return Object.values(this.toJSON())}toJSON(){const a=this[Qf],b=this[Pf],c=b.type.children,d={};for(let e=-1,f=c.length;++e<f;)d[c[e].name]=Tf.visit(b.children[e],a);return d}toString(){return`{${[...this].map(([a,b])=>`${uc(a)}: ${uc(b)}`).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}[Symbol.iterator](){return new Uf(this[Pf],this[Qf])}}
class Uf{constructor(a,b){this.Ab=0;this.children=a.children;this.rowIndex=b;this.zb=a.type.children;this.numChildren=this.zb.length}[Symbol.iterator](){return this}next(){const a=this.Ab;return a<this.numChildren?(this.Ab=a+1,{done:!1,value:[this.zb[a].name,Tf.visit(this.children[a],this.rowIndex)]}):{done:!0,value:null}}}
Object.defineProperties(Rf.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[Pf]:{writable:!0,enumerable:!1,configurable:!1,value:null},[Qf]:{writable:!0,enumerable:!1,configurable:!1,value:-1}});
class Vf{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(a){return a[Pf].type.children.map(b=>b.name)}has(a,b){return a[Pf].type.children.some(c=>c.name===b)}getOwnPropertyDescriptor(a,b){if(a[Pf].type.children.some(c=>c.name===b))return{writable:!0,enumerable:!0,configurable:!0}}get(a,b){if(Reflect.has(a,b))return a[b];var c=a[Pf].type.children.findIndex(d=>d.name===b);if(c!==-1)return c=Tf.visit(a[Pf].children[c],a[Qf]),Reflect.set(a,b,c),c}set(a,b,c){const d=
a[Pf].type.children.findIndex(e=>e.name===b);return d!==-1?(Df.visit(a[Pf].children[d],a[Qf],c),Reflect.set(a,b,c)):Reflect.has(a,b)||typeof b==="symbol"?Reflect.set(a,b,c):!1}}const Sf=new Vf;class Wf extends Ue{}function O(a){return(b,c)=>b.getValid(c)?a(b,c):null}
const Xf=(a,b,c)=>{if(c+1>=b.length)return null;const d=K(b[c]);b=K(b[c+1]);return a.subarray(d,b)},Yf=({values:a},b)=>864E5*a[b],Zf=({values:a},b)=>K(a[b]),$f=({stride:a,values:b},c)=>b[a*c],ag=({values:a},b)=>a[b],bg=({values:a,valueOffsets:b},c)=>Xf(a,b,c),cg=({values:a,valueOffsets:b},c)=>{a=Xf(a,b,c);return a!==null?va.decode(a):null},dg=({values:a},b)=>1E3*K(a[b]),eg=({values:a},b)=>K(a[b]),fg=({values:a},b)=>wc(a[b],BigInt(1E3)),gg=({values:a},b)=>wc(a[b],BigInt(1E6)),hg=({values:a},b)=>a[b],
ig=({values:a},b)=>a[b],jg=({values:a},b)=>a[b],kg=({values:a},b)=>a[b],lg=(a,b)=>Tf.visit(a.children[a.type.typeIdToChildIndex[a.typeIds[b]]],a.valueOffsets[b]),mg=(a,b)=>Tf.visit(a.children[a.type.typeIdToChildIndex[a.typeIds[b]]],b),ng=({values:a},b)=>a.subarray(2*b,2*(b+1)),og=({values:a},b)=>{a=a[b];b=new Int32Array(2);b[0]=Math.trunc(a/12);b[1]=Math.trunc(a%12);return b},pg=({values:a},b)=>a.subarray(4*b,4*(b+1)),qg=({values:a},b)=>a[b],rg=({values:a},b)=>a[b],sg=({values:a},b)=>a[b],tg=({values:a},
b)=>a[b];h=Wf.prototype;h.visitNull=O(()=>null);h.visitBool=O(({offset:a,values:b},c)=>{a+=c;return(b[a>>3]&1<<a%8)!==0});h.visitInt=O(({values:a},b)=>a[b]);h.visitInt8=O($f);h.visitInt16=O($f);h.visitInt32=O($f);h.visitInt64=O(ag);h.visitUint8=O($f);h.visitUint16=O($f);h.visitUint32=O($f);h.visitUint64=O(ag);h.visitFloat=O(({type:a,values:b},c)=>a.precision!==y.HALF?b[c]:$e(b[c]));h.visitFloat16=O(({stride:a,values:b},c)=>$e(b[a*c]));h.visitFloat32=O($f);h.visitFloat64=O($f);h.visitUtf8=O(cg);
h.visitLargeUtf8=O(cg);h.visitBinary=O(bg);h.visitLargeBinary=O(bg);h.visitFixedSizeBinary=O(({stride:a,values:b},c)=>b.subarray(a*c,a*(c+1)));h.visitDate=O((a,b)=>a.type.unit===Ya.DAY?Yf(a,b):Zf(a,b));h.visitDateDay=O(Yf);h.visitDateMillisecond=O(Zf);h.visitTimestamp=O((a,b)=>{switch(a.type.unit){case z.SECOND:return dg(a,b);case z.MILLISECOND:return eg(a,b);case z.MICROSECOND:return fg(a,b);case z.NANOSECOND:return gg(a,b)}});h.visitTimestampSecond=O(dg);h.visitTimestampMillisecond=O(eg);
h.visitTimestampMicrosecond=O(fg);h.visitTimestampNanosecond=O(gg);h.visitTime=O((a,b)=>{switch(a.type.unit){case z.SECOND:return hg(a,b);case z.MILLISECOND:return ig(a,b);case z.MICROSECOND:return jg(a,b);case z.NANOSECOND:return kg(a,b)}});h.visitTimeSecond=O(hg);h.visitTimeMillisecond=O(ig);h.visitTimeMicrosecond=O(jg);h.visitTimeNanosecond=O(kg);h.visitDecimal=O(({values:a,stride:b},c)=>new Ec(a.subarray(b*c,b*(c+1))));
h.visitList=O((a,b)=>{const c=a.stride,d=a.children,{[b*c]:e,[b*c+1]:f}=a.valueOffsets;a=d[0].slice(e,f-e);return new N([a])});h.visitStruct=O((a,b)=>new Rf(a,b));h.visitUnion=O((a,b)=>a.type.mode===x.Dense?lg(a,b):mg(a,b));h.visitDenseUnion=O(lg);h.visitSparseUnion=O(mg);h.visitDictionary=O((a,b)=>{let c;return(c=a.dictionary)==null?void 0:c.get(a.values[b])});h.visitInterval=O((a,b)=>a.type.unit===A.MONTH_DAY_NANO?pg(a,b):a.type.unit===A.DAY_TIME?ng(a,b):og(a,b));h.visitIntervalDayTime=O(ng);
h.visitIntervalYearMonth=O(og);h.visitIntervalMonthDayNano=O(pg);h.visitDuration=O((a,b)=>{switch(a.type.unit){case z.SECOND:return qg(a,b);case z.MILLISECOND:return rg(a,b);case z.MICROSECOND:return sg(a,b);case z.NANOSECOND:return tg(a,b)}});h.visitDurationSecond=O(qg);h.visitDurationMillisecond=O(rg);h.visitDurationMicrosecond=O(sg);h.visitDurationNanosecond=O(tg);h.visitFixedSizeList=O((a,b)=>{const c=a.stride;a=a.children[0].slice(b*c,c);return new N([a])});
h.visitMap=O((a,b)=>{const c=a.children,{[b]:d,[b+1]:e}=a.valueOffsets;return new ug(c[0].slice(d,e-d))});const Tf=new Wf;const vg=Symbol.for("keys"),wg=Symbol.for("vals"),xg=Symbol.for("kKeysAsStrings"),yg=Symbol.for("_kKeysAsStrings");
class ug{constructor(a){this[vg]=(new N([a.children[0]])).memoize();this[wg]=a.children[1];return new Proxy(this,new zg)}get [xg](){return this[yg]||(this[yg]=Array.from(this[vg].toArray(),String))}[Symbol.iterator](){return new Ag(this[vg],this[wg])}get size(){return this[vg].length}toArray(){return Object.values(this.toJSON())}toJSON(){const a=this[vg],b=this[wg],c={};for(let d=-1,e=a.length;++d<e;)c[a.get(d)]=Tf.visit(b,d);return c}toString(){return`{${[...this].map(([a,b])=>`${uc(a)}: ${uc(b)}`).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}}
class Ag{constructor(a,b){this.keys=a;this.cc=b;this.Eb=0;this.$b=a.length}[Symbol.iterator](){return this}next(){const a=this.Eb;if(a===this.$b)return{done:!0,value:null};this.Eb++;return{done:!1,value:[this.keys.get(a),Tf.visit(this.cc,a)]}}}
class zg{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(a){return a[xg]}has(a,b){return a[xg].includes(b)}getOwnPropertyDescriptor(a,b){if(a[xg].indexOf(b)!==-1)return{writable:!0,enumerable:!0,configurable:!0}}get(a,b){if(Reflect.has(a,b))return a[b];var c=a[xg].indexOf(b);if(c!==-1)return c=Tf.visit(Reflect.get(a,wg),c),Reflect.set(a,b,c),c}set(a,b,c){const d=a[xg].indexOf(b);return d!==-1?(Df.visit(Reflect.get(a,wg),d,c),Reflect.set(a,b,c)):Reflect.has(a,
b)?Reflect.set(a,b,c):!1}}Object.defineProperties(ug.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[vg]:{writable:!0,enumerable:!1,configurable:!1,value:null},[wg]:{writable:!0,enumerable:!1,configurable:!1,value:null},[yg]:{writable:!0,enumerable:!1,configurable:!1,value:null}});let Bg;function Cg(a,b,c,d){const {length:e=0}=a;b=typeof b!=="number"?0:b;c=typeof c!=="number"?e:c;b<0&&(b=(b%e+e)%e);c<0&&(c=(c%e+e)%e);c<b&&(Bg=b,b=c,c=Bg);c>e&&(c=e);return d?d(a,b,c):[b,c]}const Dg=a=>a!==a;function Eg(a){if(typeof a!=="object"||a===null)return a!==a?Dg:b=>b===a;if(a instanceof Date){const b=a.valueOf();return c=>c instanceof Date?c.valueOf()===b:!1}return ArrayBuffer.isView(a)?b=>b?La(a,b):!1:a instanceof Map?Fg(a):Array.isArray(a)?Gg(a):a instanceof N?Hg(a):Ig(a)}
function Gg(a){const b=[];for(let c=-1,d=a.length;++c<d;)b[c]=Eg(a[c]);return Jg(b)}function Fg(a){let b=-1;const c=[];for(const d of a.values())c[++b]=Eg(d);return Jg(c)}function Hg(a){const b=[];for(let c=-1,d=a.length;++c<d;)b[c]=Eg(a.get(c));return Jg(b)}function Ig(a){const b=Object.keys(a),c=[];for(let d=-1,e=b.length;++d<e;)c[d]=Eg(a[b[d]]);return Jg(c,b)}
function Jg(a,b){return c=>{if(!c||typeof c!=="object")return!1;switch(c.constructor){case Array:a:{var d=a.length;if(c.length!==d)c=!1;else{for(var e=-1;++e<d;)if(!a[e](c[e])){c=!1;break a}c=!0}}return c;case Map:return Kg(a,c,c.keys());case ug:case Rf:case Object:case void 0:return Kg(a,c,b||Object.keys(c))}if(c instanceof N)a:if(d=a.length,c.length!==d)c=!1;else{for(e=-1;++e<d;)if(!a[e](c.get(e))){c=!1;break a}c=!0}else c=!1;return c}}
function Kg(a,b,c){c=c[Symbol.iterator]();const d=b instanceof Map?b.keys():Object.keys(b)[Symbol.iterator]();b=b instanceof Map?b.values():Object.values(b)[Symbol.iterator]();let e=0;const f=a.length;let g=b.next(),k=c.next(),m=d.next();for(;e<f&&!k.done&&!m.done&&!g.done&&k.value===m.value&&a[e](g.value);++e,k=c.next(),m=d.next(),g=b.next());if(e===f&&k.done&&m.done&&g.done)return!0;c.return&&c.return();d.return&&d.return();b.return&&b.return();return!1}var Lg={};Lg.clampRange=Cg;
Lg.createElementComparator=Eg;Lg.wrapIndex=(a,b)=>a<0?b+a:a;function Mg(a,b,c,d){return(c&1<<d)!==0}function Ng(a,b,c,d){return(c&1<<d)>>d}function Og(a,b,c){const d=c.byteLength+7&-8;if(a>0||c.byteLength<d){const e=new Uint8Array(d);e.set(a%8===0?c.subarray(a>>3):Pg(new Qg(c,a,b,null,Mg)).subarray(0,d));return e}return c}function Pg(a){const b=[];let c=0,d=0,e=0;for(const f of a)f&&(e|=1<<d),++d===8&&(b[c++]=e,e=d=0);if(c===0||d>0)b[c++]=e;a=new Uint8Array(b.length+7&-8);a.set(b);return a}
class Qg{constructor(a,b,c,d,e){this.bytes=a;this.length=c;this.context=d;this.get=e;this.Za=b%8;this.yb=b>>3;this.xb=a[this.yb++];this.index=0}next(){return this.index<this.length?(this.Za===8&&(this.Za=0,this.xb=this.bytes[this.yb++]),{value:this.get(this.context,this.index++,this.xb,this.Za++)}):{done:!0,value:null}}[Symbol.iterator](){return this}}
function Rg(a,b,c){if(c-b<=0)return 0;if(c-b<8){var d=0;for(var e of new Qg(a,b,c-b,a,Ng))d+=e;return d}d=c>>3<<3;e=b+(b%8===0?0:8-b%8);return Rg(a,b,e)+Rg(a,d,c)+Sg(a,e>>3,d-e>>3)}function Sg(a,b,c){let d=0;b=Math.trunc(b);const e=new DataView(a.buffer,a.byteOffset,a.byteLength);for(a=c===void 0?a.byteLength:b+c;a-b>=4;)d+=Tg(e.getUint32(b)),b+=4;for(;a-b>=2;)d+=Tg(e.getUint16(b)),b+=2;for(;a-b>=1;)d+=Tg(e.getUint8(b)),b+=1;return d}
function Tg(a){a=Math.trunc(a);a-=a>>>1&1431655765;a=(a&858993459)+(a>>>2&858993459);return(a+(a>>>4)&252645135)*16843009>>>24}var Ug={};Ug.BitIterator=Qg;Ug.getBit=Ng;Ug.getBool=Mg;Ug.packBools=Pg;Ug.popcnt_array=Sg;Ug.popcnt_bit_range=Rg;Ug.popcnt_uint32=Tg;Ug.setBool=function(a,b,c){return c?!!(a[b>>3]|=1<<b%8)||!0:!(a[b>>3]&=~(1<<b%8))&&!1};Ug.truncateBitmap=Og;function Vg(a,b,c){return a.map(d=>d.slice(b,c))}function Wg(a,b){if(a.typeId===I.Null)return a.clone(a.type,0,b,0);const c=a.length,d=a.nullCount,e=(new Uint8Array((b+63&-64)>>3)).fill(255,0,c>>3);e[c>>3]=(1<<c-(c&-8))-1;d>0&&e.set(Og(a.offset,c,a.nullBitmap),0);const f=a.buffers;f[sc.VALIDITY]=e;return a.clone(a.type,0,b,d+(b-c),f)}
class P{get typeId(){return this.type.typeId}get ArrayType(){return this.type.ArrayType}get buffers(){return[this.valueOffsets,this.values,this.nullBitmap,this.typeIds]}get nullable(){if(this.P!==0){const a=this.type;return L.isSparseUnion(a)?this.children.some(b=>b.nullable):L.isDenseUnion(a)?this.children.some(b=>b.nullable):this.nullBitmap&&this.nullBitmap.byteLength>0}return!0}get byteLength(){let a=0;const b=this.valueOffsets,c=this.values,d=this.nullBitmap,e=this.typeIds;b&&(a+=b.byteLength);
c&&(a+=c.byteLength);d&&(a+=d.byteLength);e&&(a+=e.byteLength);return this.children.reduce((f,g)=>f+g.byteLength,a)}get nullCount(){if(L.isUnion(this.type))return this.children.reduce((c,d)=>c+d.nullCount,0);let a=this.P,b;a<=-1&&(b=this.nullBitmap)&&(this.P=a=b.length===0?0:this.length-Rg(b,this.offset,this.offset+this.length));return a}constructor(a,b,c,d,e,f=[],g){this.type=a;this.children=f;this.dictionary=g;this.offset=Math.floor(Math.max(b||0,0));this.length=Math.floor(Math.max(c||0,0));this.P=
Math.floor(Math.max(d||0,-1));let k;e instanceof P?(this.stride=e.stride,this.values=e.values,this.typeIds=e.typeIds,this.nullBitmap=e.nullBitmap,this.valueOffsets=e.valueOffsets):(this.stride=Te(a),e&&((k=e[0])&&(this.valueOffsets=k),(k=e[1])&&(this.values=k),(k=e[2])&&(this.nullBitmap=k),(k=e[3])&&(this.typeIds=k)))}getValid(a){const b=this.type;return L.isUnion(b)?this.children[b.typeIdToChildIndex[this.typeIds[a]]].getValid(b.mode===x.Dense?this.valueOffsets[a]:a):this.nullable&&this.nullCount>
0?(a=this.offset+a,(this.nullBitmap[a>>3]&1<<a%8)!==0):!0}setValid(a,b){var c=this.type;if(L.isUnion(c)){var d=this.children[c.typeIdToChildIndex[this.typeIds[a]]];a=c.mode===x.Dense?this.valueOffsets[a]:a;c=d.getValid(a);d.setValid(a,b)}else{({nullBitmap:d}=this);c=this.offset;var e=this.length,f=c+a;a=1<<f%8;f>>=3;if(!d||d.byteLength<=f)d=(new Uint8Array((c+e+63&-64)>>3)).fill(255),this.nullCount>0?(d.set(Og(c,e,this.nullBitmap),0),Object.assign(this,{nullBitmap:d})):Object.assign(this,{nullBitmap:d,
P:0});e=d[f];c=(e&a)!==0;d[f]=b?e|a:e&~a}c!==!!b&&(this.P=this.nullCount+(b?-1:1));return b}clone(a=this.type,b=this.offset,c=this.length,d=this.P,e=this,f=this.children){return new P(a,b,c,d,e,f,this.dictionary)}slice(a,b){const c=this.stride,d=this.typeId,e=this.children,f=+(this.P===0)-1,g=d===16?c:1;let k;const m=this.buffers;(k=m[sc.TYPE])&&(m[sc.TYPE]=k.subarray(a,a+b));(k=m[sc.OFFSET])&&(m[sc.OFFSET]=k.subarray(a,a+b+1))||(k=m[sc.DATA])&&(m[sc.DATA]=d===6?k:k.subarray(c*a,c*(a+b)));return this.clone(this.type,
this.offset+a,b,f,m,e.length===0||this.valueOffsets?e:Vg(e,g*a,g*b))}}P.prototype.children=Object.freeze([]);
class Xg extends Ue{visit(a){return this.getVisitFn(a.type).call(this,a)}visitNull(a){const {type:b,offset:c=0,length:d=0}=a;return new P(b,c,d,d)}visitBool(a){const {type:b,offset:c=0}=a,d=u(Uint8Array,a.nullBitmap),e=u(b.ArrayType,a.data),{length:f=e.length>>3,nullCount:g=a.nullBitmap?-1:0}=a;return new P(b,c,f,g,[void 0,e,d])}visitInt(a){const {type:b,offset:c=0}=a,d=u(Uint8Array,a.nullBitmap),e=u(b.ArrayType,a.data),{length:f=e.length,nullCount:g=a.nullBitmap?-1:0}=a;return new P(b,c,f,g,[void 0,
e,d])}visitFloat(a){const {type:b,offset:c=0}=a,d=u(Uint8Array,a.nullBitmap),e=u(b.ArrayType,a.data),{length:f=e.length,nullCount:g=a.nullBitmap?-1:0}=a;return new P(b,c,f,g,[void 0,e,d])}visitUtf8(a){const {type:b,offset:c=0}=a,d=u(Uint8Array,a.data),e=u(Uint8Array,a.nullBitmap),f=u(Int32Array,a.valueOffsets),{length:g=f.length-1,nullCount:k=a.nullBitmap?-1:0}=a;return new P(b,c,g,k,[f,d,e])}visitLargeUtf8(a){const {type:b,offset:c=0}=a,d=u(Uint8Array,a.data),e=u(Uint8Array,a.nullBitmap),f=u(BigInt64Array,
a.valueOffsets),{length:g=f.length-1,nullCount:k=a.nullBitmap?-1:0}=a;return new P(b,c,g,k,[f,d,e])}visitBinary(a){const {type:b,offset:c=0}=a,d=u(Uint8Array,a.data),e=u(Uint8Array,a.nullBitmap),f=u(Int32Array,a.valueOffsets),{length:g=f.length-1,nullCount:k=a.nullBitmap?-1:0}=a;return new P(b,c,g,k,[f,d,e])}visitLargeBinary(a){const {type:b,offset:c=0}=a,d=u(Uint8Array,a.data),e=u(Uint8Array,a.nullBitmap),f=u(BigInt64Array,a.valueOffsets),{length:g=f.length-1,nullCount:k=a.nullBitmap?-1:0}=a;return new P(b,
c,g,k,[f,d,e])}visitFixedSizeBinary(a){const {type:b,offset:c=0}=a,d=u(Uint8Array,a.nullBitmap),e=u(b.ArrayType,a.data),{length:f=e.length/Te(b),nullCount:g=a.nullBitmap?-1:0}=a;return new P(b,c,f,g,[void 0,e,d])}visitDate(a){const {type:b,offset:c=0}=a,d=u(Uint8Array,a.nullBitmap),e=u(b.ArrayType,a.data),{length:f=e.length/Te(b),nullCount:g=a.nullBitmap?-1:0}=a;return new P(b,c,f,g,[void 0,e,d])}visitTimestamp(a){const {type:b,offset:c=0}=a,d=u(Uint8Array,a.nullBitmap),e=u(b.ArrayType,a.data),{length:f=
e.length/Te(b),nullCount:g=a.nullBitmap?-1:0}=a;return new P(b,c,f,g,[void 0,e,d])}visitTime(a){const {type:b,offset:c=0}=a,d=u(Uint8Array,a.nullBitmap),e=u(b.ArrayType,a.data),{length:f=e.length/Te(b),nullCount:g=a.nullBitmap?-1:0}=a;return new P(b,c,f,g,[void 0,e,d])}visitDecimal(a){const {type:b,offset:c=0}=a,d=u(Uint8Array,a.nullBitmap),e=u(b.ArrayType,a.data),{length:f=e.length/Te(b),nullCount:g=a.nullBitmap?-1:0}=a;return new P(b,c,f,g,[void 0,e,d])}visitList(a){const {type:b,offset:c=0,child:d}=
a,e=u(Uint8Array,a.nullBitmap),f=u(Int32Array,a.valueOffsets),{length:g=f.length-1,nullCount:k=a.nullBitmap?-1:0}=a;return new P(b,c,g,k,[f,void 0,e],[d])}visitStruct(a){const {type:b,offset:c=0,children:d=[]}=a,e=u(Uint8Array,a.nullBitmap),{length:f=d.reduce((k,{length:m})=>Math.max(k,m),0),nullCount:g=a.nullBitmap?-1:0}=a;return new P(b,c,f,g,[void 0,void 0,e],d)}visitUnion(a){const {type:b,offset:c=0,children:d=[]}=a,e=u(b.ArrayType,a.typeIds),{length:f=e.length,nullCount:g=-1}=a;if(L.isSparseUnion(b))return new P(b,
c,f,g,[void 0,void 0,void 0,e],d);a=u(Int32Array,a.valueOffsets);return new P(b,c,f,g,[a,void 0,void 0,e],d)}visitDictionary(a){const {type:b,offset:c=0}=a,d=u(Uint8Array,a.nullBitmap),e=u(b.indices.ArrayType,a.data),{dictionary:f=new N([(new Xg).visit({type:b.dictionary})])}=a,{length:g=e.length,nullCount:k=a.nullBitmap?-1:0}=a;return new P(b,c,g,k,[void 0,e,d],[],f)}visitInterval(a){const {type:b,offset:c=0}=a,d=u(Uint8Array,a.nullBitmap),e=u(b.ArrayType,a.data),{length:f=e.length/Te(b),nullCount:g=
a.nullBitmap?-1:0}=a;return new P(b,c,f,g,[void 0,e,d])}visitDuration(a){const {type:b,offset:c=0}=a,d=u(Uint8Array,a.nullBitmap),e=u(b.ArrayType,a.data),{length:f=e.length,nullCount:g=a.nullBitmap?-1:0}=a;return new P(b,c,f,g,[void 0,e,d])}visitFixedSizeList(a){const {type:b,offset:c=0,child:d=(new Xg).visit({type:b.valueType})}=a,e=u(Uint8Array,a.nullBitmap),{length:f=d.length/Te(b),nullCount:g=a.nullBitmap?-1:0}=a;return new P(b,c,f,g,[void 0,void 0,e],[d])}visitMap(a){const {type:b,offset:c=0,
child:d=(new Xg).visit({type:b.childType})}=a,e=u(Uint8Array,a.nullBitmap),f=u(Int32Array,a.valueOffsets),{length:g=f.length-1,nullCount:k=a.nullBitmap?-1:0}=a;return new P(b,c,g,k,[f,void 0,e],[d])}}const Yg=new Xg;function Q(a){return Yg.visit(a)};class Zg{constructor(a=0,b){this.Fb=a;this.Db=b;this.bb=0;this.Bb=this.Db(0)}next(){for(;this.bb<this.Fb;){const a=this.Bb.next();if(!a.done)return a;++this.bb<this.Fb&&(this.Bb=this.Db(this.bb))}return{done:!0,value:null}}[Symbol.iterator](){return this}}function $g(a){return a.some(b=>b.nullable)}function ah(a){return a.reduce((b,c)=>b+c.nullCount,0)}function bh(a){return a.reduce((b,c,d)=>{b[d+1]=b[d]+c.length;return b},new Uint32Array(a.length+1))}
function ch(a,b,c,d){const e=[];for(let f=-1,g=a.length;++f<g;){const k=a[f],m=b[f],p=k.length;if(m>=d)break;if(c>=m+p)continue;if(m>=c&&m+p<=d){e.push(k);continue}const r=Math.max(0,c-m);e.push(k.slice(r,Math.min(d-m,p)-r))}e.length===0&&e.push(a[0].slice(0,0));return e}function dh(a,b,c,d){let e=0,f,g=b.length-1;do{if(e>=g-1)return c<b[g]?d(a,e,c-b[e]):null;f=e+Math.trunc((g-e)*.5);c<b[f]?g=f:e=f}while(e<g)}function eh(a,b){return a.getValid(b)}
function fh(a){function b(c,d,e){return a(c[d],e)}return function(c){return dh(this.data,this.j,c,b)}}function gh(a){function b(d,e,f){return a(d[e],f,c)}let c;return function(d,e){const f=this.data;c=e;d=dh(f,this.j,d,b);c=void 0;return d}}function hh(a){function b(d,e,f){var g=f;f=0;for(let k=e-1,m=d.length;++k<m;){e=d[k];if(~(g=a(e,c,g)))return f+g;g=0;f+=e.length}return-1}let c;return function(d,e){c=d;d=this.data;e=typeof e!=="number"?b(d,0,0):dh(d,this.j,e,b);c=void 0;return e}};class ih extends Ue{}function R(a,b,c){if(b===void 0)return-1;if(b===null)switch(a.typeId){case I.Union:break;case I.Dictionary:break;default:a:{const e=a.nullBitmap;if(e&&!(a.nullCount<=0)){b=0;for(var d of new Qg(e,a.offset+(c||0),a.length,e,Mg)){if(!d){a=b;break a}++b}}a=-1}return a}d=Tf.getVisitFn(a);b=Eg(b);for(let e=(c||0)-1,f=a.length;++e<f;)if(b(d(a,e)))return e;return-1}
function jh(a,b,c){const d=Tf.getVisitFn(a);b=Eg(b);for(let e=(c||0)-1,f=a.length;++e<f;)if(b(d(a,e)))return e;return-1}h=ih.prototype;h.visitNull=function(a,b){return b===null&&a.length>0?0:-1};h.visitBool=R;h.visitInt=R;h.visitInt8=R;h.visitInt16=R;h.visitInt32=R;h.visitInt64=R;h.visitUint8=R;h.visitUint16=R;h.visitUint32=R;h.visitUint64=R;h.visitFloat=R;h.visitFloat16=R;h.visitFloat32=R;h.visitFloat64=R;h.visitUtf8=R;h.visitLargeUtf8=R;h.visitBinary=R;h.visitLargeBinary=R;
h.visitFixedSizeBinary=R;h.visitDate=R;h.visitDateDay=R;h.visitDateMillisecond=R;h.visitTimestamp=R;h.visitTimestampSecond=R;h.visitTimestampMillisecond=R;h.visitTimestampMicrosecond=R;h.visitTimestampNanosecond=R;h.visitTime=R;h.visitTimeSecond=R;h.visitTimeMillisecond=R;h.visitTimeMicrosecond=R;h.visitTimeNanosecond=R;h.visitDecimal=R;h.visitList=R;h.visitStruct=R;h.visitUnion=R;h.visitDenseUnion=jh;h.visitSparseUnion=jh;h.visitDictionary=R;h.visitInterval=R;h.visitIntervalDayTime=R;
h.visitIntervalYearMonth=R;h.visitIntervalMonthDayNano=R;h.visitDuration=R;h.visitDurationSecond=R;h.visitDurationMillisecond=R;h.visitDurationMicrosecond=R;h.visitDurationNanosecond=R;h.visitFixedSizeList=R;h.visitMap=R;const kh=new ih;class lh extends Ue{}function S(a){const b=a.type;if(a.nullCount===0&&a.stride===1&&(L.isInt(b)&&b.bitWidth!==64||L.isTime(b)&&b.bitWidth!==64||L.isFloat(b)&&b.precision!==y.HALF))return new Zg(a.data.length,d=>{d=a.data[d];return d.values.subarray(0,d.length)[Symbol.iterator]()});let c=0;return new Zg(a.data.length,d=>{d=a.data[d].length;const e=a.slice(c,c+d);c+=d;return new mh(e)})}
class mh{constructor(a){this.Gb=a;this.index=0}next(){return this.index<this.Gb.length?{value:this.Gb.get(this.index++)}:{done:!0,value:null}}[Symbol.iterator](){return this}}h=lh.prototype;h.visitNull=S;h.visitBool=S;h.visitInt=S;h.visitInt8=S;h.visitInt16=S;h.visitInt32=S;h.visitInt64=S;h.visitUint8=S;h.visitUint16=S;h.visitUint32=S;h.visitUint64=S;h.visitFloat=S;h.visitFloat16=S;h.visitFloat32=S;h.visitFloat64=S;h.visitUtf8=S;h.visitLargeUtf8=S;h.visitBinary=S;h.visitLargeBinary=S;
h.visitFixedSizeBinary=S;h.visitDate=S;h.visitDateDay=S;h.visitDateMillisecond=S;h.visitTimestamp=S;h.visitTimestampSecond=S;h.visitTimestampMillisecond=S;h.visitTimestampMicrosecond=S;h.visitTimestampNanosecond=S;h.visitTime=S;h.visitTimeSecond=S;h.visitTimeMillisecond=S;h.visitTimeMicrosecond=S;h.visitTimeNanosecond=S;h.visitDecimal=S;h.visitList=S;h.visitStruct=S;h.visitUnion=S;h.visitDenseUnion=S;h.visitSparseUnion=S;h.visitDictionary=S;h.visitInterval=S;h.visitIntervalDayTime=S;
h.visitIntervalYearMonth=S;h.visitIntervalMonthDayNano=S;h.visitDuration=S;h.visitDurationSecond=S;h.visitDurationMillisecond=S;h.visitDurationMicrosecond=S;h.visitDurationNanosecond=S;h.visitFixedSizeList=S;h.visitMap=S;const nh=new lh;const oh={},ph={};
class N{constructor(a){a=a[0]instanceof N?a.flatMap(f=>f.data):a;if(a.length===0||a.some(f=>!(f instanceof P)))throw new TypeError("Vector constructor expects an Array of Data instances.");let b;const c=(b=a[0])==null?void 0:b.type;switch(a.length){case 0:this.j=[0];break;case 1:const {get:f,set:g,indexOf:k}=oh[c.typeId],m=a[0];this.isValid=p=>m.getValid(p);this.get=p=>f(m,p);this.set=(p,r)=>g(m,p,r);this.indexOf=p=>k(m,p);this.j=[0,m.length];break;default:Object.setPrototypeOf(this,ph[c.typeId]),
this.j=bh(a)}this.data=a;this.type=c;this.stride=Te(c);let d,e;this.numChildren=(e=(d=c.children)==null?void 0:d.length)!=null?e:0;this.length=this.j.at(-1)}get byteLength(){return this.data.reduce((a,b)=>a+b.byteLength,0)}get nullable(){return $g(this.data)}get nullCount(){return ah(this.data)}get ArrayType(){return this.type.ArrayType}get [Symbol.toStringTag](){return`${this.VectorName}<${this.type[Symbol.toStringTag]}>`}get VectorName(){return`${I[this.type.typeId]}Vector`}isValid(){return!1}get(){return null}at(a){return this.get(a<
0?this.length+a:a)}set(){}indexOf(){return-1}includes(a,b){return this.indexOf(a,b)>-1}[Symbol.iterator](){return nh.visit(this)}concat(...a){return new N(this.data.concat(a.flatMap(b=>b.data).flat(Number.POSITIVE_INFINITY)))}slice(a,b){return new N(Cg(this,a,b,({data:c,j:d},e,f)=>ch(c,d,e,f)))}toJSON(){return[...this]}toArray(){const a=this.data,b=this.length,c=this.stride,d=this.ArrayType;switch(this.type.typeId){case I.Int:case I.Float:case I.Decimal:case I.Time:case I.Timestamp:switch(a.length){case 0:return new d;
case 1:return a[0].values.subarray(0,b*c);default:return a.reduce((e,{values:f,length:g})=>{e.wb.set(f.subarray(0,g*c),e.offset);e.offset+=g*c;return e},{wb:new d(b*c),offset:0}).wb}}return[...this]}toString(){return`[${[...this].join()}]`}getChild(a){let b;return this.getChildAt((b=this.type.children)==null?void 0:b.findIndex(c=>c.name===a))}getChildAt(a){return a>-1&&a<this.numChildren?new N(this.data.map(({children:b})=>b[a])):null}get isMemoized(){return L.isDictionary(this.type)?this.data[0].dictionary.isMemoized:
!1}memoize(){if(L.isDictionary(this.type)){const a=new qh(this.data[0].dictionary),b=this.data.map(c=>{c=c.clone();c.dictionary=a;return c});return new N(b)}return new qh(this)}unmemoize(){if(L.isDictionary(this.type)&&this.isMemoized){const a=this.data[0].dictionary.unmemoize(),b=this.data.map(c=>{c=c.clone();c.dictionary=a;return c});return new N(b)}return this}}
N[Symbol.toStringTag]=(a=>{a.type=L.prototype;a.data=[];a.length=0;a.stride=1;a.numChildren=0;a.j=new Uint32Array([0]);a[Symbol.isConcatSpreadable]=!0;var b=Object.keys(I).map(c=>I[c]).filter(c=>typeof c==="number"&&c!==I.NONE);for(const c of b){b=Tf.getVisitFnByTypeId(c);const d=Df.getVisitFnByTypeId(c),e=kh.getVisitFnByTypeId(c);oh[c]={get:b,set:d,indexOf:e};ph[c]=Object.create(a,{isValid:{value:fh(eh)},get:{value:fh(Tf.getVisitFnByTypeId(c))},set:{value:gh(Df.getVisitFnByTypeId(c))},indexOf:{value:hh(kh.getVisitFnByTypeId(c))}})}return"Vector"})(N.prototype);
class qh extends N{constructor(a){super(a.data);const b=this.get,c=this.set,d=this.slice,e=Array(this.length);Object.defineProperty(this,"get",{value(f){var g=e[f];if(g!==void 0)return g;g=b.call(this,f);return e[f]=g}});Object.defineProperty(this,"set",{value(f,g){c.call(this,f,g);e[f]=g}});Object.defineProperty(this,"slice",{value:(f,g)=>new qh(d.call(this,f,g))});Object.defineProperty(this,"isMemoized",{value:!0});Object.defineProperty(this,"unmemoize",{value:()=>new N(this.data)});Object.defineProperty(this,
"memoize",{value:()=>this})}}
function rh(a){if(a){if(a instanceof P)return new N([a]);if(a instanceof N)return new N(a.data);if(a.type instanceof L)return new N([Q(a)]);if(Array.isArray(a))return new N(a.flatMap(b=>b instanceof P?[b]:b instanceof N?b.data:rh(b).data));if(ArrayBuffer.isView(a)){a instanceof DataView&&(a=new Uint8Array(a.buffer));const b={offset:0,length:a.length,nullCount:-1,data:a};if(a instanceof Int8Array)return new N([Q(Object.assign({},b,{type:new Sc}))]);if(a instanceof Int16Array)return new N([Q(Object.assign({},b,
{type:new Tc}))]);if(a instanceof Int32Array)return new N([Q(Object.assign({},b,{type:new Uc}))]);if(a instanceof BigInt64Array)return new N([Q(Object.assign({},b,{type:new Vc}))]);if(a instanceof Uint8Array||a instanceof Uint8ClampedArray)return new N([Q(Object.assign({},b,{type:new Wc}))]);if(a instanceof Uint16Array)return new N([Q(Object.assign({},b,{type:new Xc}))]);if(a instanceof Uint32Array)return new N([Q(Object.assign({},b,{type:new Yc}))]);if(a instanceof BigUint64Array)return new N([Q(Object.assign({},
b,{type:new Zc}))]);if(a instanceof Float32Array)return new N([Q(Object.assign({},b,{type:new ed}))]);if(a instanceof Float64Array)return new N([Q(Object.assign({},b,{type:new fd}))])}}throw Error("Unrecognized input");};function sh(a){if(!a||a.length<=0)return function(){return!0};let b="";const c=a.filter(d=>d===d);c.length>0&&(b=`
    switch (x) {${c.map(d=>`
        case ${typeof d!=="bigint"?uc(d):`${uc(d)}n`}:`).join("")}
            return false;
    }`);a.length!==c.length&&(b=`if (x !== x) return false;\n${b}`);return new Function("x",`${b}\nreturn true;`)};function th(a,b){a=Math.ceil(a)*b-1;return(a-a%64+64||64)/b}function uh(a,b=0){return a.length>=b?a.subarray(0,b):Da(new a.constructor(b),a,0)}function vh(a,b){if(b>0){a.length+=b;b=a.length*a.stride;const c=a.buffer.length;b>=c&&(a.buffer=uh(a.buffer,c===0?th(b*1,a.BYTES_PER_ELEMENT):th(b*2,a.BYTES_PER_ELEMENT)))}return a}
class wh{constructor(a,b=0,c=1){this.length=Math.ceil(b/c);this.buffer=new a(this.length);this.stride=c;this.BYTES_PER_ELEMENT=a.BYTES_PER_ELEMENT;this.ArrayType=a}get byteLength(){return Math.ceil(this.length*this.stride)*this.BYTES_PER_ELEMENT}get reservedLength(){return this.buffer.length/this.stride}get reservedByteLength(){return this.buffer.byteLength}set(){return this}append(a){return this.set(this.length,a)}flush(a=this.length){a=th(a*this.stride,this.BYTES_PER_ELEMENT);a=uh(this.buffer,a);
this.clear();return a}clear(){this.length=0;this.buffer=new this.ArrayType;return this}}class xh extends wh{get(a){return this.buffer[a]}set(a,b){vh(this,a-this.length+1);this.buffer[a*this.stride]=b;return this}}
class yh extends xh{constructor(){super(Uint8Array,0,.125);this.La=0}get Zb(){return this.length-this.La}get(a){return this.buffer[a>>3]>>a%8&1}set(a,b){const {buffer:c}=vh(this,a-this.length+1),d=a>>3;a%=8;const e=c[d]>>a&1;b?e===0&&(c[d]|=1<<a,++this.La):e===1&&(c[d]&=~(1<<a),--this.La);return this}clear(){this.La=0;return super.clear()}}
class zh extends xh{constructor(a){super(a.OffsetArrayType,1,1)}append(a){return this.set(this.length-1,a)}set(a,b){const c=this.length-1,d=vh(this,a-c+1).buffer;c<a++&&c>=0&&d.fill(d[c],c,a);d[a]=d[a-1]+b;return this}flush(a=this.length-1){a>this.length&&this.set(a-1,this.BYTES_PER_ELEMENT>4?BigInt(0):0);return super.flush(a+1)}};class Ah{static throughNode(){throw Error('"throughNode" not available in this environment');}static throughDOM(){throw Error('"throughDOM" not available in this environment');}constructor({type:a,nullValues:b}){this.length=0;this.finished=!1;this.type=a;this.children=[];this.nullValues=b;this.stride=Te(a);this.F=new yh;b&&b.length>0&&(this.qb=sh(b))}toVector(){return new N([this.flush()])}get ArrayType(){return this.type.ArrayType}get nullCount(){return this.F.Zb}get numChildren(){return this.children.length}get byteLength(){let a=
0;const b=this.j,c=this.o,d=this.F,e=this.$,f=this.children;b&&(a+=b.byteLength);c&&(a+=c.byteLength);d&&(a+=d.byteLength);e&&(a+=e.byteLength);return f.reduce((g,k)=>g+k.byteLength,a)}get reservedLength(){return this.F.reservedLength}get reservedByteLength(){let a=0;this.j&&(a+=this.j.reservedByteLength);this.o&&(a+=this.o.reservedByteLength);this.F&&(a+=this.F.reservedByteLength);this.$&&(a+=this.$.reservedByteLength);return this.children.reduce((b,c)=>b+c.reservedByteLength,a)}get valueOffsets(){return this.j?
this.j.buffer:null}get values(){return this.o?this.o.buffer:null}get nullBitmap(){return this.F?this.F.buffer:null}get typeIds(){return this.$?this.$.buffer:null}append(a){return this.set(this.length,a)}isValid(a){return this.qb(a)}set(a,b){this.setValid(a,this.isValid(b))&&this.setValue(a,b);return this}setValue(a,b){this.B(this,a,b)}setValid(a,b){this.length=this.F.set(a,+b).length;return b}addChild(){throw Error(`Cannot append children to non-nested type "${this.type}"`);}getChildAt(a){return this.children[a]||
null}flush(){let a,b,c,d;const e=this.type,f=this.length,g=this.nullCount;var k=this.j;const m=this.o,p=this.F;let r;(b=(r=this.$)==null?void 0:r.flush(f))?d=k==null?void 0:k.flush(f):a=(d=k==null?void 0:k.flush(f))?m==null?void 0:m.flush(k.get(k.length-1)):m==null?void 0:m.flush(f);g>0&&(c=p==null?void 0:p.flush(f));k=this.children.map(U=>U.flush());this.clear();return Q({type:e,length:f,nullCount:g,children:k,child:k[0],data:a,typeIds:b,nullBitmap:c,valueOffsets:d})}finish(){this.finished=!0;for(const a of this.children)a.finish();
return this}clear(){this.length=0;let a;(a=this.F)==null||a.clear();let b;(b=this.o)==null||b.clear();let c;(c=this.j)==null||c.clear();let d;(d=this.$)==null||d.clear();for(const e of this.children)e.clear();return this}}h=Ah.prototype;h.length=1;h.stride=1;h.children=null;h.finished=!1;h.nullValues=null;h.qb=()=>!0;class Bh extends Ah{constructor(a){super(a);this.o=new xh(this.ArrayType,0,this.stride)}setValue(a,b){const c=this.o;vh(c,a-c.length+1);return super.setValue(a,b)}}
function Ch(a){const b=a.H,c=a.K;a.K=0;a.H=void 0;b&&b.size>0&&a.U(b,c)}
class Dh extends Ah{constructor(a){super(a);this.K=0;this.j=new zh(a.type)}setValue(a,b){const c=this.H||(this.H=new Map),d=c.get(a);d&&(this.K-=d.length);this.K+=b instanceof ug?b[vg].length:b.length;c.set(a,b)}setValid(a,b){return super.setValid(a,b)?!0:((this.H||(this.H=new Map)).set(a,void 0),!1)}clear(){this.K=0;this.H=void 0;return super.clear()}flush(){Ch(this);return super.flush()}finish(){Ch(this);return super.finish()}};class Eh{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}offset(){return fb(this.g,this.h)}cb(){return this.g.v(this.h+8)}bodyLength(){return fb(this.g,this.h+16)}};class Fh{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}version(){const a=B(this.g,this.h,4);return a?eb(this.g,this.h+a):w.V1}schema(a){const b=B(this.g,this.h,6);return b?(a||new mc).i(ib(this.g,this.h+b),this.g):null}dictionaries(a,b){const c=B(this.g,this.h,8);return c?(b||new Eh).i(jb(this.g,this.h+c)+a*24,this.g):null}ib(a){const b=B(this.g,this.h,10);return b?(new Eh).i(jb(this.g,this.h+b)+a*24,this.g):null}Ga(a){const b=B(this.g,this.h,12);return b?(new Tb).i(ib(this.g,
jb(this.g,this.h+b)+a*4),this.g):null}Ha(){const a=B(this.g,this.h,12);return a?kb(this.g,this.h+a):0}};class T{constructor(a=[],b,c,d=w.V5){this.fields=a||[];this.metadata=b||new Map;c||(c=Gh(this.fields));this.dictionaries=c;this.Ka=d}get [Symbol.toStringTag](){return"Schema"}get names(){return this.fields.map(a=>a.name)}toString(){return`Schema<{ ${this.fields.map((a,b)=>`${b}: ${a}`).join(", ")} }>`}select(a){const b=new Set(a);a=this.fields.filter(c=>b.has(c.name));return new T(a,this.metadata)}selectAt(a){a=a.map(b=>this.fields[b]).filter(Boolean);return new T(a,this.metadata)}assign(...a){var b=
a[0]instanceof T?a[0]:Array.isArray(a[0])?new T(a[0]):new T(a);const c=[...this.fields];a=Hh(Hh(new Map,this.metadata),b.metadata);b=b.fields.filter(e=>{const f=c.findIndex(g=>g.name===e.name);return~f?(c[f]=e.clone({metadata:Hh(Hh(new Map,c[f].metadata),e.metadata)}))&&!1:!0});const d=Gh(b,new Map);return new T([...c,...b],a,new Map([...this.dictionaries,...d]))}}T.prototype.fields=null;T.prototype.metadata=null;T.prototype.dictionaries=null;
class V{static new(...a){let [b,c,d,e]=a;a[0]&&typeof a[0]==="object"&&({name:b}=a[0],c===void 0&&(c=a[0].type),d===void 0&&(d=a[0].nullable),e===void 0&&(e=a[0].metadata));return new V(`${b}`,c,d,e)}constructor(a,b,c=!1,d){this.name=a;this.type=b;this.nullable=c;this.metadata=d||new Map}get typeId(){return this.type.typeId}get [Symbol.toStringTag](){return"Field"}toString(){return`${this.name}: ${this.type}`}clone(...a){let [b,c,d,e]=a;a[0]&&typeof a[0]==="object"?{name:b=this.name,type:c=this.type,
nullable:d=this.nullable,metadata:e=this.metadata}=a[0]:[b=this.name,c=this.type,d=this.nullable,e=this.metadata]=a;return V.new(b,c,d,e)}}V.prototype.type=null;V.prototype.name=null;V.prototype.nullable=null;V.prototype.metadata=null;function Hh(a,b){return new Map([...(a||new Map),...(b||new Map)])}
function Gh(a,b=new Map){for(let c=-1,d=a.length;++c<d;){const e=a[c].type;if(L.isDictionary(e))if(!b.has(e.id))b.set(e.id,e.dictionary);else if(b.get(e.id)!==e.dictionary)throw Error("Cannot create Schema containing two different dictionaries with the same Id");e.children&&e.children.length>0&&Gh(e.children,b)}return b};function*Ih(a){for(let b,c=-1,d=a.numDictionaries;++c<d;)if(b=a.Ia(c))yield b}
class Jh{static decode(a){a=new lb(u(Uint8Array,a));a=(new Fh).i(a.v(a.position())+a.position(),a);const b=T.decode(a.schema(),new Map,a.version());return new Kh(b,a)}static encode(a){const b=new zb;var c=T.encode(b,a.schema);wb(b,24,a.numRecordBatches,8);for(var d of[...a.ib()].slice().reverse())Lh.encode(b,d);d=xb(b);wb(b,24,a.numDictionaries,8);for(const e of[...Ih(a)].slice().reverse())Lh.encode(b,e);a=xb(b);D(b,5);C(b,1,c);rb(b,w.V5,w.V1);C(b,3,d);C(b,2,a);c=E(b);b.finish(c);return mb(b)}get numRecordBatches(){return this.ba.length}get numDictionaries(){return this.ob.length}constructor(a,
b=w.V5,c,d){this.schema=a;this.version=b;c&&(this.ba=c);d&&(this.ob=d)}*ib(){for(let a,b=-1,c=this.numRecordBatches;++b<c;)if(a=this.ga(b))yield a}ga(a){return a>=0&&a<this.numRecordBatches&&this.ba[a]||null}Ia(a){return a>=0&&a<this.numDictionaries&&this.ob[a]||null}}
class Kh extends Jh{get numRecordBatches(){var a=this.m;const b=B(a.g,a.h,10);return b?kb(a.g,a.h+b):0}get numDictionaries(){var a=this.m;const b=B(a.g,a.h,8);return b?kb(a.g,a.h+b):0}constructor(a,b){super(a,b.version());this.m=b}ga(a){return a>=0&&a<this.numRecordBatches&&(a=this.m.ib(a))?Lh.decode(a):null}Ia(a){return a>=0&&a<this.numDictionaries&&(a=this.m.dictionaries(a))?Lh.decode(a):null}}
class Lh{static decode(a){return new Lh(a.cb(),a.bodyLength(),a.offset())}static encode(a,b){var c=BigInt(b.offset),d=b.cb;b=BigInt(b.bodyLength);nb(a,8,24);a.aa(BigInt(b!=null?b:0));a.pad(4);a.Y(d);a.aa(BigInt(c!=null?c:0));return a.offset()}constructor(a,b,c){this.cb=a;this.offset=K(c);this.bodyLength=K(b)}};const Mh=Object.freeze({done:!0,value:void 0});class Nh{constructor(a){this.na=a}get schema(){return this.na.schema}get batches(){return this.na.batches||[]}get dictionaries(){return this.na.dictionaries||[]}}function Oh(a){return a.mb||(a.mb=a.toDOMStream())}function Ph(a,b,c){return Ph(a.sb||(a.sb=a.toNodeStream()),b,c)}class Qh{tee(){return Oh(this).tee()}pipeTo(a,b){return Oh(this).pipeTo(a,b)}pipeThrough(a,b){return Oh(this).pipeThrough(a,b)}}
class Rh extends Qh{constructor(){super();this.o=[];this.ia=[];this.Oa=new Promise(a=>this.M=a)}get closed(){return this.Oa}cancel(a){const b=this;return l(function*(){yield b.return(a)})}write(a){if(!this.M)throw Error("AsyncQueue is closed");this.ia.length<=0?this.o.push(a):this.ia.shift().resolve({done:!1,value:a})}abort(a){this.M&&(this.ia.length<=0?this.Ra={error:a}:this.ia.shift().reject({done:!0,value:a}))}close(){if(this.M){const a=this.ia;for(;a.length>0;)a.shift().resolve(Mh);this.M();this.M=
void 0}}[Symbol.asyncIterator](){return this}toDOMStream(a){return Ma(this.M||this.Ra?this:this.o,a)}toNodeStream(){return Na()}throw(a){const b=this;return l(function*(){yield b.abort(a);return Mh})}return(){const a=this;return l(function*(){yield a.close();return Mh})}read(a){const b=this;return l(function*(){return(yield b.next(a,"read")).value})}peek(a){const b=this;return l(function*(){return(yield b.next(a,"peek")).value})}next(){return this.o.length>0?Promise.resolve({done:!1,value:this.o.shift()}):
this.Ra?Promise.reject({done:!0,value:this.Ra.error}):this.M?new Promise((a,b)=>{this.ia.push({resolve:a,reject:b})}):Promise.resolve(Mh)}};class Sh extends Rh{write(a){if((a=u(Uint8Array,a)).byteLength>0)return super.write(a)}toString(a=!1){a?(a=this.toUint8Array(!0),a=va.decode(a)):a=this.toUint8Array(!1).then(wa);return a}toUint8Array(a=!1){return a?Ea(this.o)[0]:(()=>{const b=this;return l(function*(){const c=[];let d=0;var e;try{for(var f=ia(b);;){var g=yield f.next();if(g.done)break;const m=g.value;c.push(m);d+=m.byteLength}}catch(m){var k={error:m}}finally{try{g&&!g.done&&(e=f.return)&&(yield e.call(f))}finally{if(k)throw k.error;
}}return Ea(c,d)[0]})})()}}class Th{constructor(a){a&&(this.source=new Uh(Oa(Pa(a))))}[Symbol.iterator](){return this}next(a){return this.source.next(a)}throw(a){return this.source.throw(a)}return(a){return this.source.return(a)}peek(a){return this.source.peek(a)}read(a){return this.source.read(a)}}
class Vh{constructor(a){a instanceof Vh?this.source=a.source:a instanceof Sh?this.source=new Wh(Oa(Qa(a))):Aa(a)?this.source=new Wh(Oa(Ua(a))):za(a)?this.source=new Wh(Oa(Ra(a))):t(a)&&za(a.body)?this.source=new Wh(Oa(Ra(a.body))):t(a)&&q(a[Symbol.iterator])?this.source=new Wh(Oa(Pa(a))):t(a)&&q(a.then)?this.source=new Wh(Oa(Qa(a))):t(a)&&q(a[Symbol.asyncIterator])&&(this.source=new Wh(Oa(Qa(a))))}[Symbol.asyncIterator](){return this}next(a){return this.source.next(a)}throw(a){return this.source.throw(a)}return(a){return this.source.return(a)}get closed(){return this.source.closed}cancel(a){return this.source.cancel(a)}peek(a){return this.source.peek(a)}read(a){return this.source.read(a)}}
class Uh{constructor(a){this.source=a}cancel(a){this.return(a)}peek(a){return this.next(a,"peek").value}read(a){return this.next(a,"read").value}next(a,b="read"){return this.source.next({O:b,size:a})}throw(a){return Object.create(this.source.throw&&this.source.throw(a)||Mh)}return(a){return Object.create(this.source.return&&this.source.return(a)||Mh)}}
class Wh{constructor(a){this.source=a;this.Oa=new Promise(b=>this.M=b)}cancel(a){const b=this;return l(function*(){yield b.return(a)})}get closed(){return this.Oa}read(a){const b=this;return l(function*(){return(yield b.next(a,"read")).value})}peek(a){const b=this;return l(function*(){return(yield b.next(a,"peek")).value})}next(a,b="read"){const c=this;return l(function*(){return yield c.source.next({O:b,size:a})})}throw(a){const b=this;return l(function*(){const c=b.source.throw&&(yield b.source.throw(a))||
Mh;b.M&&b.M();b.M=void 0;return Object.create(c)})}return(a){const b=this;return l(function*(){const c=b.source.return&&(yield b.source.return(a))||Mh;b.M&&b.M();b.M=void 0;return Object.create(c)})}};class Xh extends Th{constructor(a){super();this.position=0;this.buffer=u(Uint8Array,a);this.size=this.buffer.byteLength}v(a){const {buffer:b,byteOffset:c}=this.ha(a,4);return(new DataView(b,c)).getInt32(0,!0)}seek(a){this.position=Math.min(a,this.size);return a<this.size}read(a){const b=this.buffer,c=this.size,d=this.position;return b&&d<c?(typeof a!=="number"&&(a=Number.POSITIVE_INFINITY),this.position=Math.min(c,d+Math.min(c-d,a)),b.subarray(d,this.position)):null}ha(a,b){const c=this.buffer,d=
Math.min(this.size,a+b);return c?c.subarray(a,d):new Uint8Array(b)}close(){this.buffer&&(this.buffer=null)}throw(a){this.close();return{done:!0,value:a}}return(a){this.close();return{done:!0,value:a}}}
class Yh extends Vh{constructor(a,b){super();this.position=0;this.J=a;typeof b==="number"?this.size=b:this.H=(()=>{const c=this;return l(function*(){c.size=(yield a.stat()).size;delete c.H})})()}v(a){const b=this;return l(function*(){const {buffer:c,byteOffset:d}=yield b.ha(a,4);return(new DataView(c,d)).getInt32(0,!0)})}seek(a){const b=this;return l(function*(){b.H&&(yield b.H);b.position=Math.min(a,b.size);return a<b.size})}read(a){const b=this;return l(function*(){b.H&&(yield b.H);const c=b.J;
var d=b.size,e=b.position;if(c&&e<d){typeof a!=="number"&&(a=Number.POSITIVE_INFINITY);let f=0,g=0;d=Math.min(d,e+Math.min(d-e,a));const k=new Uint8Array(Math.max(0,(b.position=d)-e));for(;(e+=g)<d&&(f+=g)<k.byteLength;)({hc:g}=yield c.read(k,f,k.byteLength-f,e));return k}return null})}ha(a,b){const c=this;return l(function*(){c.H&&(yield c.H);const d=c.J;var e=c.size;return d&&a+b<e?(e=new Uint8Array(Math.min(e,a+b)-a),(yield d.read(e,0,b,a)).buffer):new Uint8Array(b)})}close(){const a=this;return l(function*(){const b=
a.J;a.J=null;b&&(yield b.close())})}throw(a){const b=this;return l(function*(){yield b.close();return{done:!0,value:a}})}return(a){const b=this;return l(function*(){yield b.close();return{done:!0,value:a}})}};function Zh(a){a<0&&(a=4294967295+a+1);return`0x${a.toString(16)}`}const $h=[1,10,100,1E3,1E4,1E5,1E6,1E7,1E8];
function ai(a,b){const c=new Uint32Array([a.buffer[1]>>>16,a.buffer[1]&65535,a.buffer[0]>>>16,a.buffer[0]&65535]);b=new Uint32Array([b.buffer[1]>>>16,b.buffer[1]&65535,b.buffer[0]>>>16,b.buffer[0]&65535]);let d=c[3]*b[3];a.buffer[0]=d&65535;let e=d>>>16;d=c[2]*b[3];e+=d;d=c[3]*b[2]>>>0;e+=d;a.buffer[0]+=e<<16;a.buffer[1]=e>>>0<d?65536:0;a.buffer[1]+=e>>>16;a.buffer[1]+=c[1]*b[3]+c[2]*b[2]+c[3]*b[1];a.buffer[1]+=c[0]*b[3]+c[1]*b[2]+c[2]*b[1]+c[3]*b[0]<<16}
function bi(a,b){const c=a.buffer[0]+b.buffer[0]>>>0;a.buffer[1]+=b.buffer[1];c<a.buffer[0]>>>0&&++a.buffer[1];a.buffer[0]=c}class ci{constructor(a){this.buffer=a}high(){return this.buffer[1]}low(){return this.buffer[0]}lessThan(a){return this.buffer[1]<a.buffer[1]||this.buffer[1]===a.buffer[1]&&this.buffer[0]<a.buffer[0]}equals(a){return this.buffer[1]===a.buffer[1]&&this.buffer[0]==a.buffer[0]}greaterThan(a){return a.lessThan(this)}hex(){return`${Zh(this.buffer[1])} ${Zh(this.buffer[0])}`}}
class W extends ci{times(a){ai(this,a);return this}plus(a){bi(this,a);return this}static from(a,b=new Uint32Array(2)){return W.fromString(typeof a==="string"?a:a.toString(),b)}static fromNumber(a,b=new Uint32Array(2)){return W.fromString(a.toString(),b)}static fromString(a,b=new Uint32Array(2)){const c=a.length;b=new W(b);for(let d=0;d<c;){const e=8<c-d?8:c-d,f=new W(new Uint32Array([Number.parseInt(a.slice(d,d+e),10),0])),g=new W(new Uint32Array([$h[e],0]));b.times(g);b.plus(f);d+=e}return b}static convertArray(a){const b=
new Uint32Array(a.length*2);for(let c=-1,d=a.length;++c<d;)W.from(a[c],new Uint32Array(b.buffer,b.byteOffset+2*c*4,2));return b}static multiply(a,b){return(new W(new Uint32Array(a.buffer))).times(b)}static add(a,b){return(new W(new Uint32Array(a.buffer))).plus(b)}}
class di extends ci{negate(){this.buffer[0]=~this.buffer[0]+1;this.buffer[1]=~this.buffer[1];this.buffer[0]==0&&++this.buffer[1];return this}times(a){ai(this,a);return this}plus(a){bi(this,a);return this}lessThan(a){const b=this.buffer[1]<<0,c=a.buffer[1]<<0;return b<c||b===c&&this.buffer[0]<a.buffer[0]}static from(a,b=new Uint32Array(2)){return di.fromString(typeof a==="string"?a:a.toString(),b)}static fromNumber(a,b=new Uint32Array(2)){return di.fromString(a.toString(),b)}static fromString(a,b=
new Uint32Array(2)){const c=a.startsWith("-"),d=a.length;b=new di(b);for(let e=c?1:0;e<d;){const f=8<d-e?8:d-e,g=new di(new Uint32Array([Number.parseInt(a.slice(e,e+f),10),0])),k=new di(new Uint32Array([$h[f],0]));b.times(k);b.plus(g);e+=f}return c?b.negate():b}static convertArray(a){const b=new Uint32Array(a.length*2);for(let c=-1,d=a.length;++c<d;)di.from(a[c],new Uint32Array(b.buffer,b.byteOffset+2*c*4,2));return b}static multiply(a,b){return(new di(new Uint32Array(a.buffer))).times(b)}static add(a,
b){return(new di(new Uint32Array(a.buffer))).plus(b)}}
class ei{constructor(a){this.buffer=a}high(){return new di(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2))}low(){return new di(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset,2))}negate(){this.buffer[0]=~this.buffer[0]+1;this.buffer[1]=~this.buffer[1];this.buffer[2]=~this.buffer[2];this.buffer[3]=~this.buffer[3];this.buffer[0]==0&&++this.buffer[1];this.buffer[1]==0&&++this.buffer[2];this.buffer[2]==0&&++this.buffer[3];return this}times(a){const b=new W(new Uint32Array([this.buffer[3],
0])),c=new W(new Uint32Array([this.buffer[2],0])),d=new W(new Uint32Array([this.buffer[1],0])),e=new W(new Uint32Array([this.buffer[0],0])),f=new W(new Uint32Array([a.buffer[3],0])),g=new W(new Uint32Array([a.buffer[2],0])),k=new W(new Uint32Array([a.buffer[1],0]));a=new W(new Uint32Array([a.buffer[0],0]));let m=W.multiply(e,a);this.buffer[0]=m.low();const p=new W(new Uint32Array([m.high(),0]));m=W.multiply(d,a);p.plus(m);m=W.multiply(e,k);p.plus(m);this.buffer[1]=p.low();this.buffer[3]=p.lessThan(m)?
1:0;this.buffer[2]=p.high();(new W(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2))).plus(W.multiply(c,a)).plus(W.multiply(d,k)).plus(W.multiply(e,g));this.buffer[3]+=W.multiply(b,a).plus(W.multiply(c,k)).plus(W.multiply(d,g)).plus(W.multiply(e,f)).low();return this}plus(a){const b=new Uint32Array(4);b[3]=this.buffer[3]+a.buffer[3]>>>0;b[2]=this.buffer[2]+a.buffer[2]>>>0;b[1]=this.buffer[1]+a.buffer[1]>>>0;b[0]=this.buffer[0]+a.buffer[0]>>>0;b[0]<this.buffer[0]>>>0&&++b[1];b[1]<this.buffer[1]>>>
0&&++b[2];b[2]<this.buffer[2]>>>0&&++b[3];this.buffer[3]=b[3];this.buffer[2]=b[2];this.buffer[1]=b[1];this.buffer[0]=b[0];return this}hex(){return`${Zh(this.buffer[3])} ${Zh(this.buffer[2])} ${Zh(this.buffer[1])} ${Zh(this.buffer[0])}`}static multiply(a,b){return(new ei(new Uint32Array(a.buffer))).times(b)}static add(a,b){return(new ei(new Uint32Array(a.buffer))).plus(b)}static from(a,b=new Uint32Array(4)){return ei.fromString(typeof a==="string"?a:a.toString(),b)}static fromNumber(a,b=new Uint32Array(4)){return ei.fromString(a.toString(),
b)}static fromString(a,b=new Uint32Array(4)){const c=a.startsWith("-"),d=a.length;b=new ei(b);for(let e=c?1:0;e<d;){const f=8<d-e?8:d-e,g=new ei(new Uint32Array([Number.parseInt(a.slice(e,e+f),10),0,0,0])),k=new ei(new Uint32Array([$h[f],0,0,0]));b.times(k);b.plus(g);e+=f}return c?b.negate():b}static convertArray(a){const b=new Uint32Array(a.length*4);for(let c=-1,d=a.length;++c<d;)ei.from(a[c],new Uint32Array(b.buffer,b.byteOffset+16*c,4));return b}}var fi={};fi.BaseInt64=ci;fi.Int128=ei;
fi.Int64=di;fi.Uint64=W;function gi(a){const b=a.length,c=new Int32Array(b*2);for(let d=0,e=0;d<b;d++){const f=a[d];let g;c[e++]=(g=f.days)!=null?g:0;let k;c[e++]=(k=f.milliseconds)!=null?k:0}return c}function hi(a){const b=a.length,c=new Int32Array(b*4);for(let e=0,f=0;e<b;e++){var d=a[e];let g;c[f++]=(g=d.months)!=null?g:0;let k;c[f++]=(k=d.days)!=null?k:0;(d=d.nanoseconds)?(c[f++]=Number(BigInt(d)&BigInt(4294967295)),c[f++]=Number(BigInt(d)>>BigInt(32))):f+=2}return c}
function ii(a){const b=a.length,c=Array(b/2);for(let d=0,e=0;d<b;d+=2)c[e++]={days:a[d],milliseconds:a[d+1]};return c}function ji(a,b){const c=a.length,d=Array(c/4);for(let e=0,f=0;e<c;e+=4){const g=BigInt(a[e+3])<<BigInt(32)|BigInt(a[e+2]>>>0);d[f++]={months:a[e],days:a[e+1],nanoseconds:b?`${g}`:g}}return d}var ki={};ki.toIntervalDayTimeInt32Array=gi;ki.toIntervalDayTimeObjects=ii;ki.toIntervalMonthDayNanoInt32Array=hi;ki.toIntervalMonthDayNanoObjects=ji;function X(a){return a.N[++a.Yb]}function li(a){return a.buffers[++a.Xb]}
class mi extends Ue{constructor(a,b,c,d,e=w.V5){super();this.Xb=this.Yb=-1;this.bytes=a;this.N=b;this.buffers=c;this.dictionaries=d;this.Ka=e}visit(a){return super.visit(a instanceof V?a.type:a)}visitNull(a,{length:b}=X(this)){return Q({type:a,length:b})}visitBool(a,{length:b,nullCount:c}=X(this)){return Q({type:a,length:b,nullCount:c,nullBitmap:this.D(a,c),data:this.G(a)})}visitInt(a,{length:b,nullCount:c}=X(this)){return Q({type:a,length:b,nullCount:c,nullBitmap:this.D(a,c),data:this.G(a)})}visitFloat(a,
{length:b,nullCount:c}=X(this)){return Q({type:a,length:b,nullCount:c,nullBitmap:this.D(a,c),data:this.G(a)})}visitUtf8(a,{length:b,nullCount:c}=X(this)){return Q({type:a,length:b,nullCount:c,nullBitmap:this.D(a,c),valueOffsets:this.ca(a),data:this.G(a)})}visitLargeUtf8(a,{length:b,nullCount:c}=X(this)){return Q({type:a,length:b,nullCount:c,nullBitmap:this.D(a,c),valueOffsets:this.ca(a),data:this.G(a)})}visitBinary(a,{length:b,nullCount:c}=X(this)){return Q({type:a,length:b,nullCount:c,nullBitmap:this.D(a,
c),valueOffsets:this.ca(a),data:this.G(a)})}visitLargeBinary(a,{length:b,nullCount:c}=X(this)){return Q({type:a,length:b,nullCount:c,nullBitmap:this.D(a,c),valueOffsets:this.ca(a),data:this.G(a)})}visitFixedSizeBinary(a,{length:b,nullCount:c}=X(this)){return Q({type:a,length:b,nullCount:c,nullBitmap:this.D(a,c),data:this.G(a)})}visitDate(a,{length:b,nullCount:c}=X(this)){return Q({type:a,length:b,nullCount:c,nullBitmap:this.D(a,c),data:this.G(a)})}visitTimestamp(a,{length:b,nullCount:c}=X(this)){return Q({type:a,
length:b,nullCount:c,nullBitmap:this.D(a,c),data:this.G(a)})}visitTime(a,{length:b,nullCount:c}=X(this)){return Q({type:a,length:b,nullCount:c,nullBitmap:this.D(a,c),data:this.G(a)})}visitDecimal(a,{length:b,nullCount:c}=X(this)){return Q({type:a,length:b,nullCount:c,nullBitmap:this.D(a,c),data:this.G(a)})}visitList(a,{length:b,nullCount:c}=X(this)){return Q({type:a,length:b,nullCount:c,nullBitmap:this.D(a,c),valueOffsets:this.ca(a),child:this.visit(a.children[0])})}visitStruct(a,{length:b,nullCount:c}=
X(this)){return Q({type:a,length:b,nullCount:c,nullBitmap:this.D(a,c),children:this.visitMany(a.children)})}visitUnion(a,{length:b,nullCount:c}=X(this)){this.Ka<w.V5&&this.D(a,c);return a.mode===x.Sparse?this.visitSparseUnion(a,{length:b,nullCount:c}):this.visitDenseUnion(a,{length:b,nullCount:c})}visitDenseUnion(a,{length:b,nullCount:c}=X(this)){return Q({type:a,length:b,nullCount:c,typeIds:this.hb(a),valueOffsets:this.ca(a),children:this.visitMany(a.children)})}visitSparseUnion(a,{length:b,nullCount:c}=
X(this)){return Q({type:a,length:b,nullCount:c,typeIds:this.hb(a),children:this.visitMany(a.children)})}visitDictionary(a,{length:b,nullCount:c}=X(this)){return Q({type:a,length:b,nullCount:c,nullBitmap:this.D(a,c),data:this.G(a.indices),dictionary:this.dictionaries.get(a.id)})}visitInterval(a,{length:b,nullCount:c}=X(this)){return Q({type:a,length:b,nullCount:c,nullBitmap:this.D(a,c),data:this.G(a)})}visitDuration(a,{length:b,nullCount:c}=X(this)){return Q({type:a,length:b,nullCount:c,nullBitmap:this.D(a,
c),data:this.G(a)})}visitFixedSizeList(a,{length:b,nullCount:c}=X(this)){return Q({type:a,length:b,nullCount:c,nullBitmap:this.D(a,c),child:this.visit(a.children[0])})}visitMap(a,{length:b,nullCount:c}=X(this)){return Q({type:a,length:b,nullCount:c,nullBitmap:this.D(a,c),valueOffsets:this.ca(a),child:this.visit(a.children[0])})}D(a,b){var c=li(this);return b>0&&this.G(a,c)||new Uint8Array(0)}ca(a){return this.G(a)}hb(a){return this.G(a)}G(a,{length:b,offset:c}=li(this)){return this.bytes.subarray(c,
c+b)}}
class ni extends mi{constructor(a,b,c,d,e){super(new Uint8Array(0),b,c,d,e);this.sources=a}D(a,b){({offset:a}=li(this));return b<=0?new Uint8Array(0):Pg(this.sources[a])}ca(a){({offset:b}=li(this));var b;return u(Uint8Array,u(a.OffsetArrayType,this.sources[b]))}hb(a){({offset:b}=li(this));var b;return u(Uint8Array,u(a.ArrayType,this.sources[b]))}G(a,{offset:b}=li(this)){const c=this.sources;if(L.isTimestamp(a)||(L.isInt(a)||L.isTime(a))&&a.bitWidth===64||L.isDuration(a)||L.isDate(a)&&a.unit===Ya.MILLISECOND)return u(Uint8Array,
di.convertArray(c[b]));if(L.isDecimal(a))return u(Uint8Array,ei.convertArray(c[b]));if(L.isBinary(a)||L.isLargeBinary(a)||L.isFixedSizeBinary(a))return oi(c[b]);if(L.isBool(a))return Pg(c[b]);if(L.isUtf8(a)||L.isLargeUtf8(a))return xa.encode(c[b].join(""));if(L.isInterval(a))switch(a.unit){case A.DAY_TIME:return gi(c[b]);case A.MONTH_DAY_NANO:return hi(c[b])}return u(Uint8Array,u(a.ArrayType,c[b].map(d=>+d)))}}
function oi(a){a=a.join("");const b=new Uint8Array(a.length/2);for(let c=0;c<a.length;c+=2)b[c>>1]=Number.parseInt(a.slice(c,c+2),16);return b};class pi extends Dh{constructor(a){super(a);this.o=new wh(Uint8Array)}get byteLength(){let a=this.K+this.length*4;this.j&&(a+=this.j.byteLength);this.o&&(a+=this.o.byteLength);this.F&&(a+=this.F.byteLength);return a}setValue(a,b){return super.setValue(a,u(Uint8Array,b))}U(a,b){const c=this.j;b=vh(this.o,b).buffer;let d=0;for(const [e,f]of a)f===void 0?c.set(e,0):(a=f.length,b.set(f,d),c.set(e,a),d+=a)}};class qi extends Dh{constructor(a){super(a);this.o=new wh(Uint8Array)}get byteLength(){let a=this.K+this.length*4;this.j&&(a+=this.j.byteLength);this.o&&(a+=this.o.byteLength);this.F&&(a+=this.F.byteLength);return a}setValue(a,b){return super.setValue(a,u(Uint8Array,b))}U(a,b){const c=this.j;b=vh(this.o,b).buffer;let d=0;for(const [e,f]of a)f===void 0?c.set(e,BigInt(0)):(a=f.length,b.set(f,d),c.set(e,BigInt(a)),d+=a)}};class ri extends Ah{constructor(a){super(a);this.o=new yh}setValue(a,b){this.o.set(a,+b)}};class si extends Bh{}si.prototype.B=nf;class ti extends si{}ti.prototype.B=hf;class ui extends si{}ui.prototype.B=jf;class vi extends Bh{}vi.prototype.B=yf;class wi extends Ah{constructor({type:a,nullValues:b,dictionaryHashFunction:c}){super({type:new Pe(a.dictionary,a.indices,a.id,a.isOrdered)});this.F=null;this.za=0;this.rb=Object.create(null);this.indices=xi({type:this.type.indices,nullValues:b});this.dictionary=xi({type:this.type.dictionary,nullValues:null});typeof c==="function"&&(this.valueToKey=c)}get values(){return this.indices.values}get nullCount(){return this.indices.nullCount}get nullBitmap(){return this.indices.nullBitmap}get byteLength(){return this.indices.byteLength+
this.dictionary.byteLength}get reservedLength(){return this.indices.reservedLength+this.dictionary.reservedLength}get reservedByteLength(){return this.indices.reservedByteLength+this.dictionary.reservedByteLength}isValid(a){return this.indices.isValid(a)}setValid(a,b){const c=this.indices;b=c.setValid(a,b);this.length=c.length;return b}setValue(a,b){const c=this.rb,d=this.valueToKey(b);let e=c[d];e===void 0&&(c[d]=e=this.za+this.dictionary.append(b).length-1);return this.indices.setValue(a,e)}flush(){var a=
this.type;const b=this.Ob,c=this.dictionary.toVector();a=this.indices.flush().clone(a);a.dictionary=b?b.concat(c):c;this.finished||(this.za+=c.length);this.Ob=a.dictionary;this.clear();return a}finish(){this.indices.finish();this.dictionary.finish();this.za=0;this.rb=Object.create(null);return super.finish()}clear(){this.indices.clear();this.dictionary.clear();return super.clear()}valueToKey(a){return typeof a==="string"?a:`${a}`}};class yi extends Bh{}yi.prototype.B=kf;class zi extends Ah{setValue(a,b){const [c]=this.children;a*=this.stride;for(let d=-1,e=this.stride;++d<e;)c.set(a+d,b[d])}setValid(a,b){super.setValid(a,b)||this.children[0].setValid((a+1)*this.stride-1,!1);return b}addChild(a,b="0"){if(this.numChildren>0)throw Error("FixedSizeListBuilder can only have one child.");const c=this.children.push(a);this.type=new Ge(this.type.listSize,new V(b,a.type,!0));return c}};class Ai extends Bh{setValue(a,b){this.o.set(a,b)}}class Bi extends Ai{setValue(a,b){super.setValue(a,af(b))}}class Ci extends Ai{}class Di extends Ai{};class Ei extends Bh{}Ei.prototype.B=Jf;class Fi extends Ei{}Fi.prototype.B=Hf;class Gi extends Ei{}Gi.prototype.B=Gf;class Hi extends Ei{}Hi.prototype.B=If;class Ii extends Bh{}Ii.prototype.B=Of;class Ji extends Ii{}Ji.prototype.B=Kf;class Ki extends Ii{}Ki.prototype.B=Lf;class Li extends Ii{}Li.prototype.B=Mf;class Mi extends Ii{}Mi.prototype.B=Nf;class Ni extends Bh{setValue(a,b){this.o.set(a,b)}}class Oi extends Ni{}class Pi extends Ni{}class Qi extends Ni{}class Ri extends Ni{}class Si extends Ni{}class Ti extends Ni{}class Ui extends Ni{}class Vi extends Ni{};class Wi extends Dh{constructor(a){super(a);this.j=new zh(a.type)}addChild(a,b="0"){if(this.numChildren>0)throw Error("ListBuilder can only have one child.");this.children[this.numChildren]=a;this.type=new oe(new V(b,a.type,!0));return this.numChildren-1}U(a){const b=this.j,[c]=this.children;for(const [d,e]of a)if(typeof e==="undefined")b.set(d,0);else{a=e;const f=a.length,g=b.set(d,f).buffer[d];for(let k=-1;++k<f;)c.set(g+k,a[k])}}};class Xi extends Dh{set(a,b){return super.set(a,b)}setValue(a,b){b=b instanceof Map?b:new Map(Object.entries(b));const c=this.H||(this.H=new Map),d=c.get(a);d&&(this.K-=d.size);this.K+=b.size;c.set(a,b)}addChild(a,b=`${this.numChildren}`){if(this.numChildren>0)throw Error("ListBuilder can only have one child.");this.children[this.numChildren]=a;this.type=new Ke(new V(b,a.type,!0),this.type.keysSorted);return this.numChildren-1}U(a){const b=this.j,[c]=this.children;for(const [d,e]of a)if(e===void 0)b.set(d,
0);else{let {[d]:f,[d+1]:g}=b.set(d,e.size).buffer;for(const k of e.entries())if(c.set(f,k),++f>=g)break}}};class Yi extends Ah{setValue(){}setValid(a,b){this.length=Math.max(a+1,this.length);return b}};class Zi extends Ah{setValue(a,b){const c=this.children,d=this.type;switch(Array.isArray(b)||b.constructor){case !0:return d.children.forEach((e,f)=>c[f].set(a,b[f]));case Map:return d.children.forEach((e,f)=>c[f].set(a,b.get(e.name)));default:return d.children.forEach((e,f)=>c[f].set(a,b[e.name]))}}setValid(a,b){super.setValid(a,b)||this.children.forEach(c=>c.setValid(a,b));return b}addChild(a,b=`${this.numChildren}`){const c=this.children.push(a);this.type=new se([...this.type.children,new V(b,
a.type,!0)]);return c}};class $i extends Bh{}$i.prototype.B=sf;class aj extends $i{}aj.prototype.B=of;class bj extends $i{}bj.prototype.B=pf;class cj extends $i{}cj.prototype.B=qf;class dj extends $i{}dj.prototype.B=rf;class ej extends Bh{}ej.prototype.B=xf;class fj extends ej{}fj.prototype.B=tf;class gj extends ej{}gj.prototype.B=uf;class hj extends ej{}hj.prototype.B=vf;class ij extends ej{}ij.prototype.B=wf;class jj extends Ah{constructor(a){super(a);this.$=new xh(Int8Array,0,1);typeof a.valueToChildTypeId==="function"&&(this.tb=a.valueToChildTypeId)}get typeIdToChildIndex(){return this.type.typeIdToChildIndex}append(a,b){return this.set(this.length,a,b)}set(a,b,c){c===void 0&&(c=this.tb(this,b,a));this.setValue(a,b,c);return this}setValue(a,b,c){this.$.set(a,c);let d;(d=this.children[this.type.typeIdToChildIndex[c]])==null||d.set(a,b);this.length=Math.max(a+1,this.length)}addChild(a,b=`${this.children.length}`){const c=
this.children.push(a),d=this.type,e=d.mode,f=d.typeIds;a=[...d.children,new V(b,a.type)];this.type=new we(e,[...f,c],a);return c}tb(){throw Error("Cannot map UnionBuilder value to child typeId. Pass the `childTypeId` as the second argument to unionBuilder.append(), or supply a `valueToChildTypeId` function as part of the UnionBuilder constructor options.");}}class kj extends jj{}
class lj extends jj{constructor(a){super(a);this.j=new xh(Int32Array)}setValue(a,b,c){c=this.$.set(a,c).buffer[a];c=this.getChildAt(this.type.typeIdToChildIndex[c]);const d=this.j.set(a,c.length).buffer[a];c==null||c.set(d,b);this.length=Math.max(a+1,this.length)}};class mj extends Dh{constructor(a){super(a);this.o=new wh(Uint8Array)}get byteLength(){let a=this.K+this.length*4;this.j&&(a+=this.j.byteLength);this.o&&(a+=this.o.byteLength);this.F&&(a+=this.F.byteLength);return a}setValue(a,b){return super.setValue(a,xa.encode(b))}U(){}}mj.prototype.U=pi.prototype.U;class nj extends Dh{constructor(a){super(a);this.o=new wh(Uint8Array)}get byteLength(){let a=this.K+this.length*4;this.j&&(a+=this.j.byteLength);this.o&&(a+=this.o.byteLength);this.F&&(a+=this.F.byteLength);return a}setValue(a,b){return super.setValue(a,xa.encode(b))}U(){}}nj.prototype.U=qi.prototype.U;class oj extends Ue{visitNull(){return Yi}visitBool(){return ri}visitInt(){return Ni}visitInt8(){return Oi}visitInt16(){return Pi}visitInt32(){return Qi}visitInt64(){return Ri}visitUint8(){return Si}visitUint16(){return Ti}visitUint32(){return Ui}visitUint64(){return Vi}visitFloat(){return Ai}visitFloat16(){return Bi}visitFloat32(){return Ci}visitFloat64(){return Di}visitUtf8(){return mj}visitLargeUtf8(){return nj}visitBinary(){return pi}visitLargeBinary(){return qi}visitFixedSizeBinary(){return yi}visitDate(){return si}visitDateDay(){return ti}visitDateMillisecond(){return ui}visitTimestamp(){return $i}visitTimestampSecond(){return aj}visitTimestampMillisecond(){return bj}visitTimestampMicrosecond(){return cj}visitTimestampNanosecond(){return dj}visitTime(){return ej}visitTimeSecond(){return fj}visitTimeMillisecond(){return gj}visitTimeMicrosecond(){return hj}visitTimeNanosecond(){return ij}visitDecimal(){return vi}visitList(){return Wi}visitStruct(){return Zi}visitUnion(){return jj}visitDenseUnion(){return lj}visitSparseUnion(){return kj}visitDictionary(){return wi}visitInterval(){return Ei}visitIntervalDayTime(){return Fi}visitIntervalYearMonth(){return Gi}visitIntervalMonthDayNano(){return Hi}visitDuration(){return Ii}visitDurationSecond(){return Ji}visitDurationMillisecond(){return Ki}visitDurationMicrosecond(){return Li}visitDurationNanosecond(){return Mi}visitFixedSizeList(){return zi}visitMap(){return Xi}}
const pj=new oj;function qj(a,b,c){return b===c||Array.isArray(b)&&Array.isArray(c)&&b.length===c.length&&b.every((d,e)=>a.compareFields(d,c[e]))}class tj extends Ue{compareSchemas(a,b){return a===b||b instanceof a.constructor&&qj(this,a.fields,b.fields)}compareFields(a,b){return a===b||b instanceof a.constructor&&a.name===b.name&&a.nullable===b.nullable&&this.visit(a.type,b.type)}}function uj(a,b){return b instanceof a.constructor}function vj(a,b){return a===b||uj(a,b)}
function wj(a,b){return a===b||uj(a,b)&&a.bitWidth===b.bitWidth&&a.isSigned===b.isSigned}function xj(a,b){return a===b||uj(a,b)&&a.precision===b.precision}function yj(a,b){return a===b||uj(a,b)&&a.unit===b.unit}function zj(a,b){return a===b||uj(a,b)&&a.unit===b.unit&&a.timezone===b.timezone}function Aj(a,b){return a===b||uj(a,b)&&a.unit===b.unit&&a.bitWidth===b.bitWidth}
function Bj(a,b){return a===b||uj(a,b)&&a.mode===b.mode&&a.typeIds.every((c,d)=>c===b.typeIds[d])&&qj(Cj,a.children,b.children)}function Dj(a,b){return a===b||uj(a,b)&&a.unit===b.unit}function Ej(a,b){return a===b||uj(a,b)&&a.unit===b.unit}h=tj.prototype;h.visitNull=vj;h.visitBool=vj;h.visitInt=wj;h.visitInt8=wj;h.visitInt16=wj;h.visitInt32=wj;h.visitInt64=wj;h.visitUint8=wj;h.visitUint16=wj;h.visitUint32=wj;h.visitUint64=wj;h.visitFloat=xj;h.visitFloat16=xj;h.visitFloat32=xj;h.visitFloat64=xj;
h.visitUtf8=vj;h.visitLargeUtf8=vj;h.visitBinary=vj;h.visitLargeBinary=vj;h.visitFixedSizeBinary=function(a,b){return a===b||uj(a,b)&&a.byteWidth===b.byteWidth};h.visitDate=yj;h.visitDateDay=yj;h.visitDateMillisecond=yj;h.visitTimestamp=zj;h.visitTimestampSecond=zj;h.visitTimestampMillisecond=zj;h.visitTimestampMicrosecond=zj;h.visitTimestampNanosecond=zj;h.visitTime=Aj;h.visitTimeSecond=Aj;h.visitTimeMillisecond=Aj;h.visitTimeMicrosecond=Aj;h.visitTimeNanosecond=Aj;h.visitDecimal=vj;
h.visitList=function(a,b){return a===b||uj(a,b)&&a.children.length===b.children.length&&qj(Cj,a.children,b.children)};h.visitStruct=function(a,b){return a===b||uj(a,b)&&a.children.length===b.children.length&&qj(Cj,a.children,b.children)};h.visitUnion=Bj;h.visitDenseUnion=Bj;h.visitSparseUnion=Bj;h.visitDictionary=function(a,b){return a===b||uj(a,b)&&a.id===b.id&&a.isOrdered===b.isOrdered&&Cj.visit(a.indices,b.indices)&&Cj.visit(a.dictionary,b.dictionary)};h.visitInterval=Dj;
h.visitIntervalDayTime=Dj;h.visitIntervalYearMonth=Dj;h.visitIntervalMonthDayNano=Dj;h.visitDuration=Ej;h.visitDurationSecond=Ej;h.visitDurationMillisecond=Ej;h.visitDurationMicrosecond=Ej;h.visitDurationNanosecond=Ej;h.visitFixedSizeList=function(a,b){return a===b||uj(a,b)&&a.listSize===b.listSize&&a.children.length===b.children.length&&qj(Cj,a.children,b.children)};
h.visitMap=function(a,b){return a===b||uj(a,b)&&a.keysSorted===b.keysSorted&&a.children.length===b.children.length&&qj(Cj,a.children,b.children)};const Cj=new tj;function Fj(a,b){return Cj.compareSchemas(a,b)}function Gj(a,b){return Cj.visit(a,b)};function xi(a){var b=a.type;const c=new (pj.getVisitFn(b)())(a);if(b.children&&b.children.length>0){const d=a.children||[],e={nullValues:a.nullValues};a=Array.isArray(d)?(f,g)=>d[g]||e:({name:f})=>d[f]||e;for(const [f,g]of b.children.entries()){b=g.type;const k=a(g,f);c.children.push(xi(Object.assign({},k,{type:b})))}}return c}
function Hj(a,b){if(a instanceof P||a instanceof N||a.type instanceof L||ArrayBuffer.isView(a))return rh(a);b={type:b!=null?b:Ij(a),nullValues:[null]};a=[...Jj(b)(a)];a=a.length===1?a[0]:a.reduce((c,d)=>c.concat(d));return L.isDictionary(a.type)?a.memoize():a}
function Ij(a){if(a.length===0)return new Mc;var b=0;let c=0,d=0,e=0,f=0,g=0,k=0,m=0;for(const p of a)if(p==null)++b;else{switch(typeof p){case "bigint":++g;continue;case "boolean":++k;continue;case "number":++e;continue;case "string":++f;continue;case "object":Array.isArray(p)?++c:Object.prototype.toString.call(p)==="[object Date]"?++m:++d;continue}throw new TypeError("Unable to infer Vector type from input values, explicit type declaration expected.");}if(e+b===a.length)return new fd;if(f+b===a.length)return new Pe(new od,
new Uc);if(g+b===a.length)return new Vc;if(k+b===a.length)return new wd;if(m+b===a.length)return new Xd;if(c+b===a.length){const p=Ij(a[a.findIndex(r=>r!=null)]);if(a.every(r=>r==null||Gj(p,Ij(r))))return new oe(new V("",p,!0))}else if(d+b===a.length){b=new Map;for(const p of a)for(const r of Object.keys(p))b.has(r)||p[r]==null||b.set(r,new V(r,Ij([p[r]]),!0));return new se([...b.values()])}throw new TypeError("Unable to infer Vector type from input values, explicit type declaration expected.");}
function Jj(a){const {queueingStrategy:b="count"}=a,{highWaterMark:c=b!=="bytes"?Number.POSITIVE_INFINITY:16384}=a,d=b!=="bytes"?"length":"byteLength";return function*(e){let f=0;const g=xi(a);for(const k of e)g.append(k)[d]>=c&&++f&&(yield g.toVector());if(g.finish().length>0||f===0)yield g.toVector()}};function Kj(a,b){return Lj(a,b.map(c=>c.data.concat()))}function Lj(a,b){const c=[...a.fields],d=[],e={eb:b.reduce((U,sa)=>Math.max(U,sa.length),0)};let f=0,g=0,k=-1;const m=b.length;let p,r=[];for(;e.eb-- >0;){g=Number.POSITIVE_INFINITY;for(k=-1;++k<m;)r[k]=p=b[k].shift(),g=Math.min(g,p?p.length:g);Number.isFinite(g)&&(r=Mj(c,g,r,b,e),g>0&&(d[f++]=Q({type:new se(c),length:g,nullCount:0,children:r.slice()})))}return[a=a.assign(c),d.map(U=>new Y(a,U))]}
function Mj(a,b,c,d,e){const f=(b+63&-64)>>3;for(let k=-1,m=d.length;++k<m;){const p=c[k];let r;var g=(r=p)==null?void 0:r.length;if(g>=b)g===b?c[k]=p:(c[k]=p.slice(0,b),e.eb=Math.max(e.eb,d[k].unshift(p.slice(b,g-b))));else{g=a[k];a[k]=g.clone({nullable:!0});let U,sa;c[k]=(sa=(U=p)==null?void 0:Wg(U,b))!=null?sa:Q({type:g.type,length:b,nullCount:b,nullBitmap:new Uint8Array(f)})}}return c};class Nj{constructor(...a){if(a.length===0)return this.batches=[],this.schema=new T([]),this.j=[0],this;let b,c;a[0]instanceof T&&(b=a.shift());a.at(-1)instanceof Uint32Array&&(c=a.pop());const d=m=>{if(m){if(m instanceof Y)return[m];if(m instanceof Nj)return m.batches;if(m instanceof P){if(m.type instanceof se)return[new Y(new T(m.type.children),m)]}else{if(Array.isArray(m))return m.flatMap(r=>d(r));if(typeof m[Symbol.iterator]==="function")return[...m].flatMap(r=>d(r));if(typeof m==="object"){var p=
Object.keys(m);const r=p.map(Ia=>new N([m[Ia]]));let U;const sa=(U=b)!=null?U:new T(p.map((Ia,Nc)=>new V(String(Ia),r[Nc].type,r[Nc].nullable)));[,p]=Kj(sa,r);return p.length===0?[new Y(m)]:p}}}return[]};a=a.flatMap(m=>d(m));let e,f,g;b=(g=(f=b)!=null?f:(e=a[0])==null?void 0:e.schema)!=null?g:new T([]);if(!(b instanceof T))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");for(const m of a){if(!(m instanceof Y))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");
if(!Fj(b,m.schema))throw new TypeError("Table and inner RecordBatch schemas must be equivalent.");}this.schema=b;this.batches=a;let k;this.j=(k=c)!=null?k:bh(this.data)}get data(){return this.batches.map(({data:a})=>a)}get numCols(){return this.schema.fields.length}get numRows(){return this.data.reduce((a,b)=>a+b.length,0)}get nullCount(){this.P===-1&&(this.P=ah(this.data));return this.P}isValid(){return!1}get(){return null}at(a){return this.get(a<0?this.numRows+a:a)}set(){}indexOf(){return-1}[Symbol.iterator](){return this.batches.length>
0?nh.visit(new N(this.data)):[][Symbol.iterator]()}toArray(){return[...this]}toString(){return`[\n  ${this.toArray().join(",\n  ")}\n]`}concat(...a){const b=this.schema;a=this.data.concat(a.flatMap(({data:c})=>c));return new Nj(b,a.map(c=>new Y(b,c)))}slice(a,b){const c=this.schema;[a,b]=Cg({length:this.numRows},a,b);a=ch(this.data,this.j,a,b);return new Nj(c,a.map(d=>new Y(c,d)))}getChild(a){return this.getChildAt(this.schema.fields.findIndex(b=>b.name===a))}getChildAt(a){if(a>-1&&a<this.schema.fields.length){const c=
this.data.map(d=>d.children[a]);if(c.length===0){var {type:b}=this.schema.fields[a];b=Q({type:b,length:0,nullCount:0});c.push(Wg(b,this.numRows))}return new N(c)}return null}setChild(a,b){let c;return this.setChildAt((c=this.schema.fields)==null?void 0:c.findIndex(d=>d.name===a),b)}setChildAt(a,b){let c=this.schema;var d=[...this.batches];if(a>-1&&a<this.numCols){b||(b=new N([Q({type:new Mc,length:this.numRows})]));d=c.fields.slice();const e=d[a].clone({type:b.type}),f=this.schema.fields.map((g,k)=>
this.getChildAt(k));[d[a],f[a]]=[e,b];[c,d]=Kj(c,f)}return new Nj(c,d)}select(a){const b=this.schema.fields.reduce((c,d,e)=>c.set(d.name,e),new Map);return this.selectAt(a.map(c=>b.get(c)).filter(c=>c>-1))}selectAt(a){const b=this.schema.selectAt(a),c=this.batches.map(d=>d.selectAt(a));return new Nj(b,c)}assign(a){const b=this.schema.fields,[c,d]=a.schema.fields.reduce((g,k,m)=>{const [p,r]=g,U=b.findIndex(sa=>sa.name===k.name);~U?r[U]=m:p.push(m);return g},[[],[]]),e=this.schema.assign(a.schema),
f=[...b.map((g,k)=>[k,d[k]]).map(([g,k])=>k===void 0?this.getChildAt(g):a.getChildAt(k)),...c.map(g=>a.getChildAt(g))].filter(Boolean);return new Nj(...Kj(e,f))}}var Oj=Symbol.toStringTag,Pj=Nj.prototype;Pj.schema=null;Pj.batches=[];Pj.j=new Uint32Array([0]);Pj.P=-1;Pj[Symbol.isConcatSpreadable]=!0;Pj.isValid=fh(eh);Pj.get=fh(Tf.getVisitFn(I.Struct));Pj.set=gh(Df.getVisitFn(I.Struct));Pj.indexOf=hh(kh.getVisitFn(I.Struct));Nj[Oj]="Table";class Y{constructor(...a){switch(a.length){case 2:[this.schema]=a;if(!(this.schema instanceof T))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");[,this.data=Q({nullCount:0,type:new se(this.schema.fields),children:this.schema.fields.map(g=>Q({type:g.type,nullCount:0}))})]=a;if(!(this.data instanceof P))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");[this.schema,this.data]=Qj(this.schema,this.data.children);break;case 1:const [b]=a,{fields:c,
children:d,length:e}=Object.keys(b).reduce((g,k,m)=>{g.children[m]=b[k];g.length=Math.max(g.length,b[k].length);g.fields[m]=V.new({name:k,type:b[k].type,nullable:!0});return g},{length:0,fields:[],children:[]});a=new T(c);const f=Q({type:new se(c),length:e,children:d,nullCount:0});[this.schema,this.data]=Qj(a,f.children,e);break;default:throw new TypeError("RecordBatch constructor expects an Object mapping names to child Data, or a [Schema, Data] pair.");}}get dictionaries(){return this.Nb||(this.Nb=
Rj(this.schema.fields,this.data.children))}get numCols(){return this.schema.fields.length}get numRows(){return this.data.length}get nullCount(){return this.data.nullCount}isValid(a){return this.data.getValid(a)}get(a){return Tf.visit(this.data,a)}at(a){return this.get(a<0?this.numRows+a:a)}set(a,b){return Df.visit(this.data,a,b)}indexOf(a,b){return kh.visit(this.data,a,b)}[Symbol.iterator](){return nh.visit(new N([this.data]))}toArray(){return[...this]}concat(...a){return new Nj(this.schema,[this,
...a])}slice(a,b){[a]=(new N([this.data])).slice(a,b).data;return new Y(this.schema,a)}getChild(a){let b;return this.getChildAt((b=this.schema.fields)==null?void 0:b.findIndex(c=>c.name===a))}getChildAt(a){return a>-1&&a<this.schema.fields.length?new N([this.data.children[a]]):null}setChild(a,b){let c;return this.setChildAt((c=this.schema.fields)==null?void 0:c.findIndex(d=>d.name===a),b)}setChildAt(a,b){var c=this.schema,d=this.data;if(a>-1&&a<this.numCols){b||(b=new N([Q({type:new Mc,length:this.numRows})]));
const e=c.fields.slice();d=d.children.slice();c=e[a].clone({type:b.type});[e[a],d[a]]=[c,b.data[0]];c=new T(e,new Map(this.schema.metadata));d=Q({type:new se(e),children:d})}return new Y(c,d)}select(a){const b=this.schema.select(a),c=new se(b.fields),d=[];for(const e of a)a=this.schema.fields.findIndex(f=>f.name===e),~a&&(d[a]=this.data.children[a]);return new Y(b,Q({type:c,length:this.numRows,children:d}))}selectAt(a){const b=this.schema.selectAt(a);a=a.map(c=>this.data.children[c]).filter(Boolean);
a=Q({type:new se(b.fields),length:this.numRows,children:a});return new Y(b,a)}}var Sj=Symbol.toStringTag,Tj=Y.prototype;Tj.P=-1;Tj[Symbol.isConcatSpreadable]=!0;Y[Sj]="RecordBatch";
function Qj(a,b,c=b.reduce((d,e)=>Math.max(d,e.length),0)){const d=[...a.fields],e=[...b],f=(c+63&-64)>>3;for(const [g,k]of a.fields.entries()){const m=b[g];if(!m||m.length!==c){d[g]=k.clone({nullable:!0});let p,r;e[g]=(r=(p=m)==null?void 0:Wg(p,c))!=null?r:Q({type:k.type,length:c,nullCount:c,nullBitmap:new Uint8Array(f)})}}return[a.assign(d),Q({type:new se(d),length:c,children:e})]}
function Rj(a,b,c=new Map){var d;if(((d=a==null?void 0:a.length)!=null?d:0)>0&&(a==null?void 0:a.length)===(b==null?void 0:b.length))for(let f=-1,g=a.length;++f<g;){var {type:e}=a[f];d=b[f];let k,m;for(const p of[d,...(((k=d)==null?void 0:(m=k.dictionary)==null?void 0:m.data)||[])]){let r;Rj(e.children,(r=p)==null?void 0:r.children,c)}if(L.isDictionary(e))if(e=e.id,!c.has(e)){let p;((p=d)==null?0:p.dictionary)&&c.set(e,d.dictionary)}else if(c.get(e)!==d.dictionary)throw Error("Cannot create Schema containing two different dictionaries with the same Id");
}return c}class Uj extends Y{constructor(a){var b=a.fields.map(c=>Q({type:c.type}));b=Q({type:new se(a.fields),nullCount:0,children:b});super(a,b)}};class Vj{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}version(){const a=B(this.g,this.h,4);return a?eb(this.g,this.h+a):w.V1}headerType(){const a=B(this.g,this.h,6);return a?this.g.l[this.h+a]:H.NONE}header(a){const b=B(this.g,this.h,8);return b?gb(this.g,a,this.h+b):null}bodyLength(){const a=B(this.g,this.h,10);return a?fb(this.g,this.h+a):BigInt("0")}Ga(a){const b=B(this.g,this.h,12);return b?(new Tb).i(ib(this.g,jb(this.g,this.h+b)+a*4),this.g):null}Ha(){const a=B(this.g,
this.h,12);return a?kb(this.g,this.h+a):0}};class Wj extends Ue{visit(a,b){return a==null||b==null?void 0:super.visit(a,b)}visitNull(a,b){D(b,0);return E(b)}visitInt(a,b){D(b,2);sb(b,0,a.bitWidth,0);qb(b,1,+a.isSigned,0);return E(b)}visitFloat(a,b){D(b,1);rb(b,a.precision,y.HALF);return E(b)}visitBinary(a,b){D(b,0);return E(b)}visitLargeBinary(a,b){D(b,0);return E(b)}visitBool(a,b){D(b,0);return E(b)}visitUtf8(a,b){D(b,0);return E(b)}visitLargeUtf8(a,b){D(b,0);return E(b)}visitDecimal(a,b){D(b,3);sb(b,1,a.scale,0);sb(b,0,a.precision,0);sb(b,
2,a.bitWidth,128);return E(b)}visitDate(a,b){D(b,1);rb(b,a.unit,Ya.MILLISECOND);return E(b)}visitTime(a,b){D(b,2);rb(b,a.unit,z.MILLISECOND);sb(b,1,a.bitWidth,32);return E(b)}visitTimestamp(a,b){const c=a.timezone&&yb(b,a.timezone)||void 0;D(b,2);rb(b,a.unit,z.SECOND);c!==void 0&&C(b,1,c);return E(b)}visitInterval(a,b){D(b,1);rb(b,a.unit,A.YEAR_MONTH);return E(b)}visitDuration(a,b){D(b,1);rb(b,a.unit,z.MILLISECOND);return E(b)}visitList(a,b){D(b,0);return E(b)}visitStruct(a,b){D(b,0);return E(b)}visitUnion(a,
b){wb(b,4,a.typeIds.length,4);var c=a.typeIds;wb(b,4,c.length,4);for(let d=c.length-1;d>=0;d--)pb(b,c[d]);c=xb(b);D(b,2);rb(b,a.mode,x.Sparse);C(b,1,c);return E(b)}visitDictionary(a,b){const c=this.visit(a.indices,b);D(b,4);tb(b,0,BigInt(a.id));qb(b,2,+a.isOrdered,0);c!==void 0&&C(b,1,c);return E(b)}visitFixedSizeBinary(a,b){D(b,1);sb(b,0,a.byteWidth,0);return E(b)}visitFixedSizeList(a,b){D(b,1);sb(b,0,a.listSize,0);return E(b)}visitMap(a,b){D(b,1);qb(b,0,+a.keysSorted,0);return E(b)}}const Xj=new Wj;function Yj(a){return new Zj(a.count,ak(a.columns),bk(a.columns))}function ck(a,b){return(a.fields||[]).filter(Boolean).map(c=>V.fromJSON(c,b))}function dk(a,b){return(a.children||[]).filter(Boolean).map(c=>V.fromJSON(c,b))}function ak(a){return(a||[]).reduce((b,c)=>[...b,new ek(c.count,fk(c.VALIDITY)),...ak(c.children)],[])}
function bk(a,b=[]){for(let c=-1,d=(a||[]).length;++c<d;){const e=a[c];e.VALIDITY&&b.push(new gk(b.length,e.VALIDITY.length));e.TYPE_ID&&b.push(new gk(b.length,e.TYPE_ID.length));e.OFFSET&&b.push(new gk(b.length,e.OFFSET.length));e.DATA&&b.push(new gk(b.length,e.DATA.length));b=bk(e.children,b)}return b}function fk(a){return(a||[]).reduce((b,c)=>b+ +(c===0),0)}function hk(a=[]){return new Map(a.map(({key:b,value:c})=>[b,c]))}function ik(a){return new Oc(a.isSigned,a.bitWidth)}
function jk(a,b){const c=a.type.name;switch(c){case "NONE":return new Mc;case "null":return new Mc;case "binary":return new gd;case "largebinary":return new kd;case "utf8":return new od;case "largeutf8":return new sd;case "bool":return new wd;case "list":return new oe((b||[])[0]);case "struct":return new se(b||[]);case "struct_":return new se(b||[])}switch(c){case "int":return b=a.type,new Oc(b.isSigned,b.bitWidth);case "floatingpoint":return new $c(y[a.type.precision]);case "decimal":return b=a.type,
new Ad(b.scale,b.precision,b.bitWidth);case "date":return new Ed(Ya[a.type.unit]);case "time":return b=a.type,new Kd(z[b.unit],b.bitWidth);case "timestamp":return b=a.type,new Sd(z[b.unit],b.timezone);case "interval":return new $d(A[a.type.unit]);case "duration":return new ge(z[a.type.unit]);case "union":a=a.type;const [d,...e]=(a.mode+"").toLowerCase();return new we(x[d.toUpperCase()+e.join("")],a.typeIds||[],b||[]);case "fixedsizebinary":return new Ce(a.type.byteWidth);case "fixedsizelist":return new Ge(a.type.listSize,
(b||[])[0]);case "map":return new Ke((b||[])[0],a.type.keysSorted)}throw Error(`Unrecognized type: "${c}"`);};class kk{static fromJSON(a,b){const c=new kk(0,w.V5,b);c.Pa=lk(a,b);return c}static decode(a){a=new lb(u(Uint8Array,a));a=(new Vj).i(a.v(a.position())+a.position(),a);var b=a.bodyLength();const c=a.version(),d=a.headerType();b=new kk(b,c,d);b.Pa=mk(a,d);return b}static encode(a){const b=new zb;let c=-1;a.isSchema()?c=T.encode(b,a.header()):a.isRecordBatch()?c=Zj.encode(b,a.header()):a.isDictionaryBatch()&&(c=nk.encode(b,a.header()));D(b,5);rb(b,w.V5,w.V1);C(b,2,c);qb(b,1,a.headerType,H.NONE);tb(b,
3,BigInt(a.bodyLength));a=E(b);b.finish(a);return mb(b)}static from(a,b=0){if(a instanceof T)return new kk(0,w.V5,H.Schema,a);if(a instanceof Zj)return new kk(b,w.V5,H.RecordBatch,a);if(a instanceof nk)return new kk(b,w.V5,H.DictionaryBatch,a);throw Error(`Unrecognized Message header: ${a}`);}get type(){return this.headerType}get version(){return this.Ub}get headerType(){return this.Qb}get bodyLength(){return this.Kb}header(){return this.Pa()}isSchema(){return this.headerType===H.Schema}isRecordBatch(){return this.headerType===
H.RecordBatch}isDictionaryBatch(){return this.headerType===H.DictionaryBatch}constructor(a,b,c,d){this.Ub=b;this.Qb=c;this.body=new Uint8Array(0);d&&(this.Pa=()=>d);this.Kb=K(a)}}class Zj{get N(){return this.Ta}get length(){return this.Tb}get buffers(){return this.Na}constructor(a,b,c){this.Ta=b;this.Na=c;this.Tb=K(a)}}
class nk{get id(){return this.Rb}get data(){return this.Mb}get Ja(){return this.Sb}get length(){return this.data.length}get N(){return this.data.N}get buffers(){return this.data.buffers}constructor(a,b,c=!1){this.Mb=a;this.Sb=c;this.Rb=K(b)}}class gk{constructor(a,b){this.offset=K(a);this.length=K(b)}}class ek{constructor(a,b){this.length=K(a);this.nullCount=K(b)}}
function lk(a,b){return()=>{switch(b){case H.Schema:return T.fromJSON(a);case H.RecordBatch:return Zj.fromJSON(a);case H.DictionaryBatch:return nk.fromJSON(a)}throw Error(`Unrecognized Message type: { name: ${H[b]}, type: ${b} }`);}}
function mk(a,b){return()=>{switch(b){case H.Schema:return T.decode(a.header(new mc),new Map,a.version());case H.RecordBatch:return Zj.decode(a.header(new Kb),a.version());case H.DictionaryBatch:return nk.decode(a.header(new Lb),a.version())}throw Error(`Unrecognized Message type: { name: ${H[b]}, type: ${b} }`);}}V.encode=ok;V.decode=pk;
V.fromJSON=function(a,b){var c;let d,e;b&&(e=a.dictionary)?(b.has(c=e.id)?(d=(d=e.indexType)?ik(d):new Uc,c=new Pe(b.get(c),d,c,e.isOrdered)):(d=(d=e.indexType)?ik(d):new Uc,b.set(c,b=jk(a,dk(a,b))),c=new Pe(b,d,c,e.isOrdered)),a=new V(a.name,c,a.nullable,hk(a.metadata))):(b=jk(a,dk(a,b)),a=new V(a.name,b,a.nullable,hk(a.metadata)));return a||null};T.encode=qk;T.decode=rk;T.fromJSON=function(a,b=new Map){return new T(ck(a,b),hk(a.metadata),b)};Zj.encode=sk;Zj.decode=tk;Zj.fromJSON=Yj;nk.encode=uk;
nk.decode=vk;nk.fromJSON=function(a){return new nk(Yj(a.data),a.id,a.isDelta)};ek.encode=wk;ek.decode=xk;gk.encode=yk;gk.decode=zk;function rk(a,b=new Map,c=w.V5){const d=[];for(let e,f=-1,g=-1,k=lc(a);++f<k;)if(e=a.fields(f))d[++g]=V.decode(e,b);return new T(d,Ak(a),b,c)}
function tk(a,b=w.V5){var c=B(a.g,a.h,10);if((c?(new Fb).i(ib(a.g,a.h+c),a.g):null)!==null)throw Error("Record batch compression not implemented");c=a.length();const d=[];for(let f,g=-1,k=-1,m=Ib(a);++g<m;)if(f=a.N(g))d[++k]=ek.decode(f);const e=[];for(let f,g=-1,k=-1,m=Jb(a);++g<m;)if(f=a.buffers(g))b<w.V4&&(f.h+=8*(g+1)),e[++k]=gk.decode(f);return new Zj(c,d,e)}function vk(a,b=w.V5){return new nk(Zj.decode(a.data(),b),a.id(),a.Ja())}function zk(a){return new gk(a.offset(),a.length())}
function xk(a){return new ek(a.length(),a.nullCount())}function Bk(a,b){const c=[];for(let d,e=-1,f=-1,g=hc(a);++e<g;)if(d=a.children(e))c[++f]=V.decode(d,b);return c}function pk(a,b){var c;let d,e;b&&(e=a.dictionary())?(b.has(c=K(e.id()))?(d=(d=Rb(e))?Ck(d):new Uc,c=new Pe(b.get(c),d,c,e.isOrdered())):(d=(d=Rb(e))?Ck(d):new Uc,b.set(c,b=Dk(a,Bk(a,b))),c=new Pe(b,d,c,e.isOrdered())),a=new V(a.name(),c,a.nullable(),Ak(a))):(b=Dk(a,Bk(a,b)),a=new V(a.name(),b,a.nullable(),Ak(a)));return a||null}
function Ak(a){const b=new Map;if(a)for(let c,d,e=-1,f=Math.trunc(a.Ha());++e<f;)(c=a.Ga(e))&&(d=c.key())!=null&&b.set(d,c.value());return b}function Ck(a){return new Oc(a.isSigned(),a.bitWidth())}
function Dk(a,b){var c=(c=B(a.g,a.h,8))?a.g.l[a.h+c]:F.NONE;switch(c){case F.NONE:return new Mc;case F.Null:return new Mc;case F.Binary:return new gd;case F.LargeBinary:return new kd;case F.Utf8:return new od;case F.LargeUtf8:return new sd;case F.Bool:return new wd;case F.List:return new oe((b||[])[0]);case F.Struct_:return new se(b||[])}switch(c){case F.Int:return b=a.type(new Qb),new Oc(b.isSigned(),b.bitWidth());case F.FloatingPoint:return b=a.type(new Zb),new $c(b.precision());case F.Decimal:return b=
a.type(new Vb),new Ad(b.scale(),b.precision(),b.bitWidth());case F.Date:return b=a.type(new Ub),new Ed(b.unit());case F.Time:return b=a.type(new bc),new Kd(b.unit(),b.bitWidth());case F.Timestamp:return b=a.type(new cc),new Sd(b.unit(),b.timezone());case F.Interval:return b=a.type(new $b),new $d(b.unit());case F.Duration:return b=a.type(new Wb),new ge(b.unit());case F.Union:c=a.type(new dc);a=c.mode();const d=B(c.g,c.h,6);c=d?new Int32Array(c.g.bytes().buffer,c.g.bytes().byteOffset+jb(c.g,c.h+d),
kb(c.g,c.h+d)):null;return new we(a,c||[],b||[]);case F.FixedSizeBinary:return b=a.type(new Xb),new Ce(b.byteWidth());case F.FixedSizeList:return a=a.type(new Yb),new Ge(a.listSize(),(b||[])[0]);case F.Map:return a=a.type(new ac),new Ke((b||[])[0],a.keysSorted())}throw Error(`Unrecognized type: "${F[c]}" (${c})`);}
function qk(a,b){var c=b.fields.map(d=>V.encode(a,d));wb(a,4,c.length,4);c=jc(a,c);b=b.metadata&&b.metadata.size>0?kc(a,[...b.metadata].map(([d,e])=>{d=yb(a,`${d}`);e=yb(a,`${e}`);D(a,2);C(a,0,d);C(a,1,e);return E(a)})):-1;D(a,4);C(a,1,c);rb(a,Ek?Mb.Jb:Mb.ec,Mb.Jb);b!==-1&&C(a,2,b);return E(a)}
function ok(a,b){let c=-1,d=-1,e=-1;var f=b.type;let g=b.typeId;L.isDictionary(f)?(g=f.dictionary.typeId,e=Xj.visit(f,a),d=Xj.visit(f.dictionary,a)):d=Xj.visit(f,a);f=(f.children||[]).map(m=>V.encode(a,m));f=ec(a,f);const k=b.metadata&&b.metadata.size>0?fc(a,[...b.metadata].map(([m,p])=>{m=yb(a,`${m}`);p=yb(a,`${p}`);D(a,2);C(a,0,m);C(a,1,p);return E(a)})):-1;b.name&&(c=yb(a,b.name));D(a,7);C(a,3,d);qb(a,2,g,F.NONE);C(a,5,f);qb(a,1,+!!b.nullable,0);c!==-1&&C(a,0,c);e!==-1&&C(a,4,e);k!==-1&&C(a,6,
k);return E(a)}function sk(a,b){var c=b.N||[],d=b.buffers||[];wb(a,16,c.length,8);for(const e of c.slice().reverse())ek.encode(a,e);c=xb(a);wb(a,16,d.length,8);for(const e of d.slice().reverse())gk.encode(a,e);d=xb(a);D(a,4);tb(a,0,BigInt(b.length));C(a,1,c);C(a,2,d);return E(a)}function uk(a,b){const c=Zj.encode(a,b.data);D(a,3);tb(a,0,BigInt(b.id));qb(a,2,+b.Ja,0);C(a,1,c);return E(a)}
function wk(a,b){var c=BigInt(b.length);b=BigInt(b.nullCount);nb(a,8,16);a.aa(BigInt(b!=null?b:0));a.aa(BigInt(c!=null?c:0));return a.offset()}function yk(a,b){var c=BigInt(b.offset);b=BigInt(b.length);nb(a,8,16);a.aa(BigInt(b!=null?b:0));a.aa(BigInt(c!=null?c:0));return a.offset()}const Fk=new ArrayBuffer(2);(new DataView(Fk)).setInt16(0,256,!0);const Ek=(new Int16Array(Fk))[0]===256;const Gk=a=>`Expected ${H[a]} Message in stream, but was null or length 0.`,Hk=a=>`Header pointer of flatbuffer-encoded ${H[a]} Message is null or length 0.`,Ik=(a,b)=>`Expected to read ${a} metadata bytes, but only read ${b}.`,Jk=(a,b)=>`Expected to read ${a} bytes for message body, but only read ${b}.`;
class Kk{constructor(a){this.source=a instanceof Th?a:new Th(a)}[Symbol.iterator](){return this}next(){let a;return(a=this.readMetadataLength()).done||a.value===-1&&(a=this.readMetadataLength()).done||(a=this.readMetadata(a.value)).done?Mh:a}throw(a){return this.source.throw(a)}return(a){return this.source.return(a)}readMessage(a){let b;if((b=this.next()).done)return null;if(a!=null&&b.value.headerType!==a)throw Error(Gk(a));return b.value}readMessageBody(a){if(a<=0)return new Uint8Array(0);var b=
this.source.read(a);b=u(Uint8Array,b);if(b.byteLength<a)throw Error(Jk(a,b.byteLength));return b.byteOffset%8===0&&b.byteOffset+b.byteLength<=b.buffer.byteLength?b:b.slice()}readSchema(a=!1){const b=H.Schema;let c;const d=(c=this.readMessage(b))==null?void 0:c.header();if(a&&!d)throw Error(Hk(b));return d}readMetadataLength(){var a=this.source.read(4);let b;a=((b=a&&new lb(a))==null?void 0:b.v(0))||0;return{done:a===0,value:a}}readMetadata(a){const b=this.source.read(a);if(!b)return Mh;if(b.byteLength<
a)throw Error(Ik(a,b.byteLength));return{done:!1,value:kk.decode(b)}}}
class Lk{constructor(a,b){this.source=a instanceof Vh?a:t(a)&&q(a.stat)&&typeof a.fd==="number"?new Yh(a,b):new Vh(a)}[Symbol.asyncIterator](){return this}next(){const a=this;return l(function*(){let b;return(b=yield a.readMetadataLength()).done||b.value===-1&&(b=yield a.readMetadataLength()).done||(b=yield a.readMetadata(b.value)).done?Mh:b})}throw(a){const b=this;return l(function*(){return yield b.source.throw(a)})}return(a){const b=this;return l(function*(){return yield b.source.return(a)})}readMessage(a){const b=
this;return l(function*(){let c;if((c=yield b.next()).done)return null;if(a!=null&&c.value.headerType!==a)throw Error(Gk(a));return c.value})}readMessageBody(a){const b=this;return l(function*(){if(a<=0)return new Uint8Array(0);var c=yield b.source.read(a);c=u(Uint8Array,c);if(c.byteLength<a)throw Error(Jk(a,c.byteLength));return c.byteOffset%8===0&&c.byteOffset+c.byteLength<=c.buffer.byteLength?c:c.slice()})}readSchema(a=!1){const b=this;return l(function*(){const c=H.Schema;let d;const e=(d=yield b.readMessage(c))==
null?void 0:d.header();if(a&&!e)throw Error(Hk(c));return e})}readMetadataLength(){const a=this;return l(function*(){var b=yield a.source.read(4);let c;b=((c=b&&new lb(b))==null?void 0:c.v(0))||0;return{done:b===0,value:b}})}readMetadata(a){const b=this;return l(function*(){const c=yield b.source.read(a);if(!c)return Mh;if(c.byteLength<a)throw Error(Ik(a,c.byteLength));return{done:!1,value:kk.decode(c)}})}}
class Mk extends Kk{constructor(a){super(new Uint8Array(0));this.T=!1;this.xa=[];this.Z=this.nb=0;this.na=a instanceof Nh?a:new Nh(a)}next(){var a=this.na;if(!this.T)return this.T=!0,{done:!1,value:kk.fromJSON(a.schema,H.Schema)};if(this.Z<a.dictionaries.length)return a=a.dictionaries[this.Z++],this.xa=a.data.columns,{done:!1,value:kk.fromJSON(a,H.DictionaryBatch)};if(this.nb<a.batches.length)return a=a.batches[this.nb++],this.xa=a.columns,{done:!1,value:kk.fromJSON(a,H.RecordBatch)};this.xa=[];return Mh}readMessageBody(){function a(b){return(b||
[]).reduce((c,d)=>[...c,...(d.VALIDITY&&[d.VALIDITY]||[]),...(d.TYPE_ID&&[d.TYPE_ID]||[]),...(d.OFFSET&&[d.OFFSET]||[]),...(d.DATA&&[d.DATA]||[]),...a(d.children)],[])}return a(this.xa)}readMessage(a){let b;if((b=this.next()).done)return null;if(a!=null&&b.value.headerType!==a)throw Error(Gk(a));return b.value}readSchema(){const a=H.Schema,b=this.readMessage(a),c=b==null?void 0:b.header();if(!b||!c)throw Error(Hk(a));return c}}const Nk=new Uint8Array(6);for(let a=0;a<6;a+=1)Nk[a]="ARROW1".codePointAt(a);
function Ok(a){for(let b=-1,c=Nk.length;++b<c;)if(Nk[b]!==a[0+b])return!1;return!0}const Pk=Nk.length,Qk=Pk+4,Rk=Pk*2+4;class Sk extends Qh{constructor(a){super();this.u=a}get closed(){return this.u.closed}get schema(){return this.u.schema}get autoDestroy(){return this.u.autoDestroy}get dictionaries(){return this.u.dictionaries}get numDictionaries(){return this.u.numDictionaries}get numRecordBatches(){return this.u.numRecordBatches}get footer(){return this.u.isFile()?this.u.footer:null}isSync(){return this.u.isSync()}isAsync(){return this.u.isAsync()}isFile(){return this.u.isFile()}isStream(){return this.u.isStream()}next(){return this.u.next()}throw(a){return this.u.throw(a)}return(a){return this.u.return(a)}cancel(){return this.u.cancel()}reset(a){this.u.reset(a);
this.sb=this.mb=void 0;return this}open(a){a=this.u.open(a);return t(a)&&q(a.then)?a.then(()=>this):this}readRecordBatch(a){return this.u.isFile()?this.u.readRecordBatch(a):null}[Symbol.iterator](){return this.u[Symbol.iterator]()}[Symbol.asyncIterator](){return this.u[Symbol.asyncIterator]()}toDOMStream(){return Ma(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this})}toNodeStream(){return Na(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this})}static throughNode(){throw Error('"throughNode" not available in this environment');
}static throughDOM(){throw Error('"throughDOM" not available in this environment');}static from(a){return a instanceof Sk?a:t(a)&&t(a.schema)?new Tk(new Uk(a)):t(a)&&q(a.stat)&&typeof a.fd==="number"?Vk(a):t(a)&&q(a.then)?(()=>l(function*(){return yield Sk.from(yield a)}))():t(a)&&za(a.body)||za(a)||Aa(a)||t(a)&&q(a[Symbol.asyncIterator])?Wk(new Vh(a)):Xk(new Th(a))}static readAll(a){return a instanceof Sk?a.isSync()?Yk(a):Zk(a):t(a)&&t(a.schema)||ArrayBuffer.isView(a)||t(a)&&q(a[Symbol.iterator])||
t(a)&&"done"in a&&"value"in a?Yk(a):Zk(a)}}class Tk extends Sk{constructor(a){super(a);this.u=a}readAll(){return[...this]}[Symbol.iterator](){return this.u[Symbol.iterator]()}[Symbol.asyncIterator](){const a=this;return new oa(function*(){yield new n(1,a[Symbol.iterator]())}())}}
class $k extends Sk{constructor(a){super(a);this.u=a}readAll(){const a=this;return l(function*(){const b=[];var c;try{for(var d=ia(a);;){var e=yield d.next();if(e.done)break;b.push(e.value)}}catch(g){var f={error:g}}finally{try{e&&!e.done&&(c=d.return)&&(yield c.call(d))}finally{if(f)throw f.error;}}return b})}[Symbol.iterator](){throw Error("AsyncRecordBatchStreamReader is not Iterable");}[Symbol.asyncIterator](){return this.u[Symbol.asyncIterator]()}}
class al extends Tk{constructor(a){super(a);this.u=a}}class bl extends $k{constructor(a){super(a);this.u=a}}function cl(a,b,c){c=a.Sa(b,c,a.schema.fields);b=Q({type:new se(a.schema.fields),length:b.length,children:c});return new Y(a.schema,b)}function dl(a,b,c){var d=b.id;const e=b.Ja,f=a.schema,g=a.dictionaries.get(d);d=f.dictionaries.get(d);a=a.Sa(b.data,c,[d]);return(g&&e?g.concat(new N(a)):new N(a)).memoize()}
class el{get numDictionaries(){return this.Z}get numRecordBatches(){return this.R}constructor(a=new Map){this.closed=!1;this.autoDestroy=!0;this.R=this.Z=0;this.dictionaries=a}isSync(){return!1}isAsync(){return!1}isFile(){return!1}isStream(){return!1}reset(a){this.R=this.Z=0;this.schema=a;this.dictionaries=new Map;return this}Sa(a,b,c){return(new mi(b,a.N,a.buffers,this.dictionaries,this.schema.Ka)).visitMany(c)}}
class fl extends el{constructor(a){super();this.A=t(a)&&t(a.schema)?new Mk(this.J=a):new Kk(this.J=a)}isSync(){return!0}isStream(){return!0}[Symbol.iterator](){return this}cancel(){!this.closed&&(this.closed=!0)&&(this.reset().A.return(),this.dictionaries=this.A=null)}open(a){this.closed||(this.autoDestroy=gl(this,a),this.schema||(this.schema=this.A.readSchema())||this.cancel());return this}throw(a){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset().A.throw(a):Mh}return(a){return!this.closed&&
this.autoDestroy&&(this.closed=!0)?this.reset().A.return(a):Mh}next(){if(this.closed)return Mh;for(var a,b=this.A;a=this.pa();)if(a.isSchema())this.reset(a.header());else{if(a.isRecordBatch()){this.R++;var c=a.header();b=b.readMessageBody(a.bodyLength);return{done:!1,value:cl(this,c,b)}}a.isDictionaryBatch()&&(this.Z++,c=a.header(),a=b.readMessageBody(a.bodyLength),a=dl(this,c,a),this.dictionaries.set(c.id,a))}return this.schema&&this.R===0?(this.R++,{done:!1,value:new Uj(this.schema)}):this.return()}pa(){return this.A.readMessage(void 0)}}
class hl extends el{constructor(a,b){super(b);this.A=new Lk(this.J=a)}isAsync(){return!0}isStream(){return!0}[Symbol.asyncIterator](){return this}cancel(){const a=this;return l(function*(){!a.closed&&(a.closed=!0)&&(yield a.reset().A.return(),a.A=null,a.dictionaries=null)})}open(a){const b=this;return l(function*(){b.closed||(b.autoDestroy=gl(b,a),b.schema||(b.schema=yield b.A.readSchema())||(yield b.cancel()));return b})}throw(a){const b=this;return l(function*(){return!b.closed&&b.autoDestroy&&
(b.closed=!0)?yield b.reset().A.throw(a):Mh})}return(a){const b=this;return l(function*(){return!b.closed&&b.autoDestroy&&(b.closed=!0)?yield b.reset().A.return(a):Mh})}next(){const a=this;return l(function*(){if(a.closed)return Mh;for(var b,c=a.A;b=yield a.pa();)if(b.isSchema())yield a.reset(b.header());else{if(b.isRecordBatch()){a.R++;var d=b.header();c=yield c.readMessageBody(b.bodyLength);return{done:!1,value:cl(a,d,c)}}b.isDictionaryBatch()&&(a.Z++,d=b.header(),b=yield c.readMessageBody(b.bodyLength),
b=dl(a,d,b),a.dictionaries.set(d.id,b))}return a.schema&&a.R===0?(a.R++,{done:!1,value:new Uj(a.schema)}):yield a.return()})}pa(){const a=this;return l(function*(){return yield a.A.readMessage(void 0)})}}
class il extends fl{get footer(){return this.m}get numDictionaries(){return this.m?this.m.numDictionaries:0}get numRecordBatches(){return this.m?this.m.numRecordBatches:0}constructor(a){super(a instanceof Xh?a:new Xh(a))}isSync(){return!0}isFile(){return!0}open(a){if(!this.closed&&!this.m){this.schema=(this.m=this.Wa()).schema;for(const b of Ih(this.m))b&&this.Va(this.Z++)}return super.open(a)}readRecordBatch(a){if(this.closed)return null;this.m||this.open();var b;const c=(b=this.m)==null?void 0:
b.ga(a);return c&&this.J.seek(c.offset)&&(b=this.A.readMessage(H.RecordBatch),b==null?0:b.isRecordBatch())?(a=b.header(),b=this.A.readMessageBody(b.bodyLength),cl(this,a,b)):null}Va(a){var b;const c=(b=this.m)==null?void 0:b.Ia(a);c&&this.J.seek(c.offset)&&(b=this.A.readMessage(H.DictionaryBatch),b==null?0:b.isDictionaryBatch())&&(a=b.header(),b=this.A.readMessageBody(b.bodyLength),b=dl(this,a,b),this.dictionaries.set(a.id,b))}Wa(){var a=this.J;const b=a.size-Qk,c=a.v(b);a=a.ha(b-c,c);return Jh.decode(a)}pa(){this.m||
this.open();if(this.m&&this.R<this.numRecordBatches){let a;const b=(a=this.m)==null?void 0:a.ga(this.R);if(b&&this.J.seek(b.offset))return this.A.readMessage(void 0)}return null}}
class jl extends hl{get footer(){return this.m}get numDictionaries(){return this.m?this.m.numDictionaries:0}get numRecordBatches(){return this.m?this.m.numRecordBatches:0}constructor(a){var b=[];const c=typeof b[0]!=="number"?b.shift():void 0;b=b[0]instanceof Map?b.shift():void 0;super(a instanceof Yh?a:new Yh(a,c),b)}isFile(){return!0}isAsync(){return!0}open(a){const b=this,c=()=>super.open;return l(function*(){if(!b.closed&&!b.m){b.schema=(b.m=yield b.Wa()).schema;for(const d of Ih(b.m))d&&(yield b.Va(b.Z++))}return yield c().call(b,
a)})}readRecordBatch(a){const b=this;return l(function*(){if(b.closed)return null;b.m||(yield b.open());var c,d=(c=b.m)==null?void 0:c.ga(a);return d&&(yield b.J.seek(d.offset))&&(d=yield b.A.readMessage(H.RecordBatch),d==null?0:d.isRecordBatch())?(c=d.header(),d=yield b.A.readMessageBody(d.bodyLength),cl(b,c,d)):null})}Va(a){const b=this;return l(function*(){var c,d=(c=b.m)==null?void 0:c.Ia(a);d&&(yield b.J.seek(d.offset))&&(d=yield b.A.readMessage(H.DictionaryBatch),d==null?0:d.isDictionaryBatch())&&
(c=d.header(),d=yield b.A.readMessageBody(d.bodyLength),d=dl(b,c,d),b.dictionaries.set(c.id,d))})}Wa(){const a=this;return l(function*(){var b=a.J;b.H&&(yield b.H);const c=b.size-Qk,d=yield b.v(c);b=yield b.ha(c-d,d);return Jh.decode(b)})}pa(){const a=this;return l(function*(){a.m||(yield a.open());if(a.m&&a.R<a.numRecordBatches){const b=a.m.ga(a.R);if(b&&(yield a.J.seek(b.offset)))return yield a.A.readMessage(void 0)}return null})}}
class Uk extends fl{Sa(a,b,c){return(new ni(b,a.N,a.buffers,this.dictionaries,this.schema.Ka)).visitMany(c)}}function gl(a,b){return b&&typeof b.autoDestroy==="boolean"?b.autoDestroy:a.autoDestroy}function*Yk(a){a=Sk.from(a);try{if(!a.open({autoDestroy:!1}).closed){do yield a;while(!a.reset().open().closed)}}finally{a.cancel()}}
function Zk(a){return new oa(function*(){const b=yield new n(2,Sk.from(a));try{if(!(yield new n(2,b.open({autoDestroy:!1}))).closed){do yield new n(0,b);while(!(yield new n(2,b.reset().open())).closed)}}finally{yield new n(2,b.cancel())}}())}function Xk(a){const b=a.peek(Pk+7&-8);return b&&b.byteLength>=4?Ok(b)?new al(new il(a.read())):new Tk(new fl(a)):new Tk(new fl(function*(){}()))}
function Wk(a){return l(function*(){const b=yield a.peek(Pk+7&-8);return b&&b.byteLength>=4?Ok(b)?new al(new il(yield a.read())):new $k(new hl(a)):new $k(new hl(function(){return new oa(function*(){}())}()))})}function Vk(a){return l(function*(){const {size:b}=yield a.stat(),c=new Yh(a,b);return b>=Rk&&Ok(yield c.ha(0,Pk+7&-8))?new bl(new jl(c)):new $k(new hl(c))})};class kl extends Ue{static sa(...a){const b=d=>d.flatMap(e=>Array.isArray(e)?b(e):e instanceof Y?e.data.children:e.data),c=new kl;c.visitMany(b(a));return c}constructor(){super();this.ya=0;this.Ta=[];this.Na=[];this.Lb=[]}visit(a){if(a instanceof N)return this.visitMany(a.data),this;const b=a.type;if(!L.isDictionary(b)){const c=a.length;if(c>2147483647)throw new RangeError("Cannot write arrays larger than 2^31 - 1 in length");if(L.isUnion(b))this.N.push(new ek(c,0));else{const d=a.nullCount;L.isNull(b)||
ll.call(this,d<=0?new Uint8Array(0):Og(a.offset,c,a.nullBitmap));this.N.push(new ek(c,d))}}return super.visit(a)}visitNull(){return this}visitDictionary(a){return this.visit(a.clone(a.type.indices))}get N(){return this.Ta}get buffers(){return this.Na}get byteLength(){return this.ya}get ab(){return this.Lb}}function ll(a){const b=a.byteLength+7&-8;this.buffers.push(a);this.ab.push(new gk(this.ya,b));this.ya+=b;return this}function ml(a){return ll.call(this,a.values.subarray(0,a.length*a.stride))}
function nl(a){const b=a.length,c=a.values;a=a.valueOffsets;const d=K(a[0]);var e=K(a[b]);e=Math.min(e-d,c.byteLength-d);ll.call(this,Ka(-d,b+1,a));ll.call(this,c.subarray(d,d+e));return this}function ol(a){const b=a.length,c=a.valueOffsets;if(c){const {[0]:d,[b]:e}=c;ll.call(this,Ka(-d,b+1,c));return this.visit(a.children[0].slice(d,e-d))}return this.visit(a.children[0])}function pl(a){return this.visitMany(a.type.children.map((b,c)=>a.children[c]).filter(Boolean))[0]}h=kl.prototype;
h.visitBool=function(a){let b;return a.nullCount>=a.length?ll.call(this,new Uint8Array(0)):(b=a.values)instanceof Uint8Array?ll.call(this,Og(a.offset,a.length,b)):ll.call(this,Pg(a.values))};h.visitInt=ml;h.visitFloat=ml;h.visitUtf8=nl;h.visitLargeUtf8=nl;h.visitBinary=nl;h.visitLargeBinary=nl;h.visitFixedSizeBinary=ml;h.visitDate=ml;h.visitTimestamp=ml;h.visitTime=ml;h.visitDecimal=ml;h.visitList=ol;h.visitStruct=pl;
h.visitUnion=function(a){const b=a.type,c=a.length,d=a.typeIds,e=a.valueOffsets;ll.call(this,d);if(b.mode===x.Sparse)return pl.call(this,a);if(b.mode===x.Dense){if(a.offset<=0)return ll.call(this,e),pl.call(this,a);const f=new Int32Array(c),g=Object.create(null),k=Object.create(null);for(let m,p,r=-1;++r<c;){if((m=d[r])===void 0)continue;(p=g[m])===void 0&&(p=g[m]=e[r]);f[r]=e[r]-p;let U;k[m]=((U=k[m])!=null?U:0)+1}ll.call(this,f);this.visitMany(a.children.map((m,p)=>{p=b.typeIds[p];return m.slice(g[p],
Math.min(c,k[p]))}))}return this};h.visitInterval=ml;h.visitDuration=ml;h.visitFixedSizeList=ol;h.visitMap=ol;class ql extends Ue{visit(a){return a==null?void 0:super.visit(a)}visitNull({typeId:a}){return{name:F[a].toLowerCase()}}visitInt({typeId:a,bitWidth:b,isSigned:c}){return{name:F[a].toLowerCase(),bitWidth:b,isSigned:c}}visitFloat({typeId:a,precision:b}){return{name:F[a].toLowerCase(),precision:y[b]}}visitBinary({typeId:a}){return{name:F[a].toLowerCase()}}visitLargeBinary({typeId:a}){return{name:F[a].toLowerCase()}}visitBool({typeId:a}){return{name:F[a].toLowerCase()}}visitUtf8({typeId:a}){return{name:F[a].toLowerCase()}}visitLargeUtf8({typeId:a}){return{name:F[a].toLowerCase()}}visitDecimal({typeId:a,
scale:b,precision:c,bitWidth:d}){return{name:F[a].toLowerCase(),scale:b,precision:c,bitWidth:d}}visitDate({typeId:a,unit:b}){return{name:F[a].toLowerCase(),unit:Ya[b]}}visitTime({typeId:a,unit:b,bitWidth:c}){return{name:F[a].toLowerCase(),unit:z[b],bitWidth:c}}visitTimestamp({typeId:a,timezone:b,unit:c}){return{name:F[a].toLowerCase(),unit:z[c],timezone:b}}visitInterval({typeId:a,unit:b}){return{name:F[a].toLowerCase(),unit:A[b]}}visitDuration({typeId:a,unit:b}){return{name:F[a].toLocaleLowerCase(),
unit:z[b]}}visitList({typeId:a}){return{name:F[a].toLowerCase()}}visitStruct({typeId:a}){return{name:F[a].toLowerCase()}}visitUnion({typeId:a,mode:b,typeIds:c}){return{name:F[a].toLowerCase(),mode:x[b].toUpperCase(),typeIds:[...c]}}visitDictionary(a){return this.visit(a.dictionary)}visitFixedSizeBinary({typeId:a,byteWidth:b}){return{name:F[a].toLowerCase(),byteWidth:b}}visitFixedSizeList({typeId:a,listSize:b}){return{name:F[a].toLowerCase(),listSize:b}}visitMap({typeId:a,keysSorted:b}){return{name:F[a].toLowerCase(),
keysSorted:b}}};class rl extends Ue{static sa(...a){const b=new rl;return a.map(({schema:c,data:d})=>b.visitMany(c.fields,d.children))}visit({name:a},b){const c=b.length,d=b.offset,e=b.nullCount,f=b.nullBitmap,g=L.isDictionary(b.type)?b.type.indices:b.type,k=Object.assign([],b.buffers,{[sc.VALIDITY]:void 0});return Object.assign({},{name:a,count:c,VALIDITY:L.isNull(g)||L.isUnion(g)?void 0:e<=0?Array.from({length:c},()=>1):[...(new Qg(f,d,c,null,Ng))]},super.visit(b.clone(g,d,c,0,k)))}visitNull(){return{}}visitBool({values:a,
offset:b,length:c}){return{DATA:[...(new Qg(a,b,c,null,Mg))]}}visitInt(a){return{DATA:a.type.bitWidth<64?[...a.values]:[...sl(a.values,2)]}}visitFloat(a){return{DATA:[...a.values]}}visitUtf8(a){return{DATA:[...(new N([a]))],OFFSET:[...a.valueOffsets]}}visitLargeUtf8(a){return{DATA:[...(new N([a]))],OFFSET:[...sl(a.valueOffsets,2)]}}visitBinary(a){return{DATA:[...tl(new N([a]))],OFFSET:[...a.valueOffsets]}}visitLargeBinary(a){return{DATA:[...tl(new N([a]))],OFFSET:[...sl(a.valueOffsets,2)]}}visitFixedSizeBinary(a){return{DATA:[...tl(new N([a]))]}}visitDate(a){return{DATA:a.type.unit===
Ya.DAY?[...a.values]:[...sl(a.values,2)]}}visitTimestamp(a){return{DATA:[...sl(a.values,2)]}}visitTime(a){return{DATA:a.type.unit<z.MICROSECOND?[...a.values]:[...sl(a.values,2)]}}visitDecimal(a){return{DATA:[...sl(a.values,4)]}}visitList(a){return{OFFSET:[...a.valueOffsets],children:this.visitMany(a.type.children,a.children)}}visitStruct(a){return{children:this.visitMany(a.type.children,a.children)}}visitUnion(a){return{TYPE_ID:[...a.typeIds],OFFSET:a.type.mode===x.Dense?[...a.valueOffsets]:void 0,
children:this.visitMany(a.type.children,a.children)}}visitInterval(a){switch(a.type.unit){case A.YEAR_MONTH:return{DATA:[...a.values]};case A.DAY_TIME:return{DATA:ii(a.values)};case A.MONTH_DAY_NANO:return{DATA:ji(a.values,!0)}}}visitDuration(a){return{DATA:[...sl(a.values,2)]}}visitFixedSizeList(a){return{children:this.visitMany(a.type.children,a.children)}}visitMap(a){return{OFFSET:[...a.valueOffsets],children:this.visitMany(a.type.children,a.children)}}}
function*tl(a){for(const b of a)yield b.reduce((c,d)=>`${c}${("0"+(d&255).toString(16)).slice(-2)}`,"").toUpperCase()}function*sl(a,b){a=new Uint32Array(a.buffer);for(let c=-1,d=a.length/b;++c<d;)yield`${Hc.new(a.subarray((c+0)*b,(c+1)*b),!1)}`};function ul(a,b){a.qa&&(b=u(Uint8Array,b))&&b.byteLength>0&&(a.I.write(b),a.oa+=b.byteLength);return a}function vl(a,b){return b>0?ul(a,new Uint8Array(b)):a}function wl(a,b){let c,d,e;for(let f=-1,g=b.length;++f<g;)(c=b[f])&&(d=c.byteLength)>0&&(ul(a,c),(e=(d+7&-8)-d)>0&&vl(a,e));return a}
class xl extends Qh{static throughNode(){throw Error('"throughNode" not available in this environment');}static throughDOM(){throw Error('"throughDOM" not available in this environment');}constructor(a){super();this.oa=0;this.qa=!1;this.I=new Sh;this.T=null;this.ma=[];this.Aa=[];this.Ca=new Map;this.Qa=new Map;t(a)||(a={autoDestroy:!0,Hb:!1});this.wa=typeof a.autoDestroy==="boolean"?a.autoDestroy:!0;this.Xa=typeof a.Hb==="boolean"?a.Hb:!1}toString(a=!1){return this.I.toString(a)}toUint8Array(a=!1){return this.I.toUint8Array(a)}writeAll(a){return t(a)&&
q(a.then)?a.then(b=>this.writeAll(b)):t(a)&&q(a[Symbol.asyncIterator])?yl(this,a):zl(this,a)}get closed(){return this.I.closed}[Symbol.asyncIterator](){return this.I[Symbol.asyncIterator]()}toDOMStream(a){return this.I.toDOMStream(a)}toNodeStream(a){return this.I.toNodeStream(a)}close(){return this.reset().I.close()}abort(a){return this.reset().I.abort(a)}finish(){this.wa?this.close():this.reset(this.I,this.T);return this}reset(a=this.I,b=null){a===this.I||a instanceof Sh?this.I=a:(this.I=new Sh,
a&&t(a)&&q(a.abort)&&q(a.getWriter)&&!ya(a)?this.toDOMStream({type:"bytes"}).pipeTo(a):a&&t(a)&&q(a.end)&&q(a.write)&&typeof a.writable==="boolean"&&!ya(a)&&Ph(this.toNodeStream({jc:!1}),a));this.qa&&this.T&&this.Ea(this.T);this.qa=!1;this.ma=[];this.Aa=[];this.Ca=new Map;this.Qa=new Map;b&&Fj(b,this.T)||(b==null?(this.oa=0,this.T=null):(this.qa=!0,this.T=b,this.Ya(b)));return this}write(a){let b=null;if(this.I){if(a==null||a instanceof Nj&&!(b=a.schema)||a instanceof Y&&!(b=a.schema))return this.finish()&&
void 0}else throw Error("RecordBatchWriter is closed");if(b&&!Fj(b,this.T)){if(this.qa&&this.wa)return this.close();this.reset(this.I,b)}a instanceof Y?a instanceof Uj||this.ub(a):a instanceof Nj?this.writeAll(a.batches):t(a)&&q(a[Symbol.iterator])&&this.writeAll(a)}Fa(a){const b=kk.encode(a),c=b.byteLength,d=this.Xa?4:8,e=c+d+7&-8,f=e-c-d;a.headerType===H.RecordBatch?this.Aa.push(new Lh(e,a.bodyLength,this.oa)):a.headerType===H.DictionaryBatch&&this.ma.push(new Lh(e,a.bodyLength,this.oa));this.Xa||
ul(this,Int32Array.of(-1));ul(this,Int32Array.of(e-d));c>0&&ul(this,b);return vl(this,f)}Ya(a){this.Fa(kk.from(a))}Ea(){return this.Xa?ul(this,Int32Array.of(0)):ul(this,Int32Array.of(-1,0))}ub(a){const {byteLength:b,N:c,ab:d,buffers:e}=kl.sa(a);var f=new Zj(a.numRows,c,d);f=kk.from(f,b);wl(this.Da(a).Fa(f),e)}ra(a,b,c=!1){const {byteLength:d,N:e,ab:f,buffers:g}=kl.sa(new N([a]));a=new Zj(a.length,e,f);b=new nk(a,b,c);b=kk.from(b,d);return wl(this.Fa(b),g)}Da(a){for(const [b,c]of a.dictionaries){let d,
e;a=(e=(d=c)==null?void 0:d.data)!=null?e:[];const f=this.Ca.get(b);let g;const k=(g=this.Qa.get(b))!=null?g:0;if(!f||f.data[0]!==a[0])for(const [m,p]of a.entries())this.ra(p,b,m>0);else if(k<a.length)for(const m of a.slice(k))this.ra(m,b,!0);this.Ca.set(b,c);this.Qa.set(b,a.length)}return this}}class Al extends xl{static writeAll(a,b){const c=new Al(b);return t(a)&&q(a.then)?a.then(d=>c.writeAll(d)):t(a)&&q(a[Symbol.asyncIterator])?yl(c,a):zl(c,a)}}
class Bl extends xl{static writeAll(a){const b=new Bl;return t(a)&&q(a.then)?a.then(c=>b.writeAll(c)):t(a)&&q(a[Symbol.asyncIterator])?yl(b,a):zl(b,a)}constructor(){super();this.wa=!0}Ya(){vl(ul(this,Nk),2)}ra(a,b,c=!1){if(!c&&this.Ca.has(b))throw Error("The Arrow File format does not support replacement dictionaries. ");return super.ra(a,b,c)}Ea(a){const b=Jh.encode(new Jh(a,w.V5,this.Aa,this.ma));a=ul(ul(super.Ea(a),b),Int32Array.of(b.byteLength));return ul(a,Nk)}}
class Cl extends xl{static writeAll(a){return(new Cl).writeAll(a)}constructor(){super();this.wa=!0;this.ba=[];this.Ba=[]}Fa(){return this}Ea(){return this}Ya(a){ul(this,`{\n  "schema": ${JSON.stringify({fields:a.fields.map(b=>Dl(b))},null,2)}`)}Da(a){a.dictionaries.size>0&&this.Ba.push(a);return this}ra(a,b,c=!1){ul(this,this.ma.length===0?"    ":",\n    ");ul(this,El(a,b,c));this.ma.push(new Lh(0,0,0));return this}ub(a){this.Da(a);this.ba.push(a)}close(){if(this.Ba.length>0){ul(this,',\n  "dictionaries": [\n');
for(var a of this.Ba)super.Da(a);ul(this,"\n  ]")}if(this.ba.length>0){for(let b=-1,c=this.ba.length;++b<c;){ul(this,b===0?',\n  "batches": [\n    ':",\n    ");a=this.ba[b];const [d]=rl.sa(a);a=JSON.stringify({count:a.numRows,columns:d},null,2);ul(this,a);this.Aa.push(new Lh(0,0,0))}ul(this,"\n  ]")}this.T&&ul(this,"\n}");this.Ba=[];this.ba=[];return super.close()}}function zl(a,b){let c=b;b instanceof Nj&&(c=b.batches,a.reset(void 0,b.schema));for(const d of c)a.write(d);return a.finish()}
function yl(a,b){return l(function*(){var c;try{for(var d=ia(b);;){var e=yield d.next();if(e.done)break;a.write(e.value)}}catch(g){var f={error:g}}finally{try{e&&!e.done&&(c=d.return)&&(yield c.call(d))}finally{if(f)throw f.error;}}return a.finish()})}function Dl({name:a,type:b,nullable:c}){const d=new ql;return{name:a,nullable:c,type:d.visit(b),children:(b.children||[]).map(e=>Dl(e)),dictionary:L.isDictionary(b)?{id:b.id,isOrdered:b.isOrdered,indexType:d.visit(b.indices)}:void 0}}
function El(a,b,c=!1){const [d]=rl.sa(new Y({[b]:a}));return JSON.stringify({id:b,isDelta:c,data:{count:a.length,columns:d}},null,2)};function Fl(a,b){function c(g,k){let m,p,r=g.desiredSize||null;for(;!(p=k.next(e?r:null)).done;)if(ArrayBuffer.isView(p.value)&&(m=u(Uint8Array,p.value))&&(r!=null&&e&&(r=r-m.byteLength+1),p.value=m),g.enqueue(p.value),r!=null&&--r<=0)return;g.close()}let d=null;const e=(b==null?void 0:b.type)==="bytes"||!1,f=(b==null?void 0:b.highWaterMark)||16777216;return new ReadableStream(Object.assign({},b,{start(g){c(g,d||(d=a[Symbol.iterator]()))},pull(g){d?c(g,d):g.close()},cancel(){let g;((g=d)==null?0:
g.return)&&d.return();d=null}}),Object.assign({},{highWaterMark:e?f:void 0},b))}
function Gl(a,b){function c(g,k){return l(function*(){let m,p,r=g.desiredSize||null;for(;!(p=yield k.next(e?r:null)).done;)if(ArrayBuffer.isView(p.value)&&(m=u(Uint8Array,p.value))&&(r!=null&&e&&(r=r-m.byteLength+1),p.value=m),g.enqueue(p.value),r!=null&&--r<=0)return;g.close()})}let d=null;const e=(b==null?void 0:b.type)==="bytes"||!1,f=(b==null?void 0:b.highWaterMark)||16777216;return new ReadableStream(Object.assign({},b,{start(g){return l(function*(){yield c(g,d||(d=a[Symbol.asyncIterator]()))})},
pull(g){return l(function*(){d?yield c(g,d):g.close()})},cancel(){return l(function*(){let g;((g=d)==null?0:g.return)&&(yield d.return());d=null})}}),Object.assign({},{highWaterMark:e?f:void 0},b))};function Hl(a,b,c){c!=null&&(a.ka>=c.desiredSize&&++a.Ua&&Il(a,c,b.toVector()),b.finished&&((b.length>0||a.Ua===0)&&++a.Ua&&Il(a,c,b.toVector()),!a.pb&&(a.pb=!0)&&Il(a,c,null)))}function Il(a,b,c){a.ka=0;a.la=null;c==null?b.close():b.enqueue(c)}
class Jl{constructor(a){this.Ua=0;this.pb=!1;this.ka=0;var b=Object.assign({},a),c=a.readableStrategy,d=a.writableStrategy;a=a.queueingStrategy;a=a===void 0?"count":a;b=(delete b.readableStrategy,delete b.writableStrategy,delete b.queueingStrategy,b);this.la=null;this.da=xi(b);this.Pb=a!=="bytes"?Kl:Ll;({highWaterMark:c=a==="bytes"?16384:1E3}=Object.assign({},c));({highWaterMark:d=a==="bytes"?16384:1E3}=Object.assign({},d));this.readable=new ReadableStream({cancel:()=>{this.da.clear()},pull:e=>{Hl(this,
this.da,this.la=e)},start:e=>{Hl(this,this.da,this.la=e)}},{highWaterMark:c,size:a!=="bytes"?Kl:Ll});this.writable=new WritableStream({abort:()=>{this.da.clear()},write:()=>{Hl(this,this.da,this.la)},close:()=>{Hl(this,this.da.finish(),this.la)}},{highWaterMark:d,size:e=>{const f=this.ka;this.ka=this.Pb(this.da.append(e));return this.ka-f}})}}const Kl=a=>{let b;return(b=a==null?void 0:a.length)!=null?b:0},Ll=a=>{let b;return(b=a==null?void 0:a.byteLength)!=null?b:0};function Ml(a,b){function c(){return l(function*(){return yield(yield Sk.from(e)).open(b)})}function d(k,m){return l(function*(){let p=k.desiredSize,r;for(;!(r=yield m.next()).done;)if(k.enqueue(r.value),p!=null&&--p<=0)return;k.close()})}const e=new Sh;let f=null;const g=new ReadableStream({cancel(){return l(function*(){yield e.close()})},start(k){return l(function*(){yield d(k,f||(f=yield c()))})},pull(k){return l(function*(){f?yield d(k,f):k.close()})}});return{writable:new WritableStream(e,Object.assign({},
{highWaterMark:16384},a)),readable:g}};function Nl(a,b){function c(f){return l(function*(){let g,k=f.desiredSize;for(;g=yield e.read(k||null);)if(f.enqueue(g),k!=null&&(k-=g.byteLength)<=0)return;f.close()})}const d=new this(a),e=new Vh(d);b=new ReadableStream({cancel(){return l(function*(){yield e.cancel()})},pull(f){return l(function*(){yield c(f)})},start(f){return l(function*(){yield c(f)})}},Object.assign({},{highWaterMark:16384},b));return{writable:new WritableStream(d,a),readable:b}};function Ol(a){a=Sk.from(a);return t(a)&&q(a.then)?a.then(b=>Ol(b)):a.isAsync()?a.readAll().then(b=>new Nj(b)):new Nj(a.readAll())};const Pl=Object.assign({},Ic,fi,Ug,bf,v,Lg,vc,ki,{compareSchemas:Fj,compareFields:function(a,b){return Cj.compareFields(a,b)},compareTypes:Gj});Ma=function(a,b){if(t(a)&&q(a[Symbol.asyncIterator]))return Gl(a,b);if(t(a)&&q(a[Symbol.iterator]))return Fl(a,b);throw Error("toDOMStream() must be called with an Iterable or AsyncIterable");};Ah.throughDOM=function(a){return new Jl(a)};Sk.throughDOM=Ml;al.throughDOM=Ml;Tk.throughDOM=Ml;xl.throughDOM=Nl;Bl.throughDOM=Nl;Al.throughDOM=Nl;var Z={};Z.AsyncByteQueue=Sh;Z.AsyncByteStream=Vh;Z.AsyncMessageReader=Lk;Z.AsyncRecordBatchFileReader=bl;Z.AsyncRecordBatchStreamReader=$k;Z.Binary=gd;
Z.BinaryBuilder=pi;Z.Bool=wd;Z.BoolBuilder=ri;Z.BufferType=sc;Z.Builder=Ah;Z.ByteStream=Th;Z.Data=P;Z.DataType=L;Z.DateBuilder=si;Z.DateDay=Id;Z.DateDayBuilder=ti;Z.DateMillisecond=Jd;Z.DateMillisecondBuilder=ui;Z.DateUnit=Ya;Z.Date_=Ed;Z.Decimal=Ad;Z.DecimalBuilder=vi;Z.DenseUnion=Ae;Z.DenseUnionBuilder=lj;Z.Dictionary=Pe;Z.DictionaryBuilder=wi;Z.Duration=ge;Z.DurationBuilder=Ii;Z.DurationMicrosecond=me;Z.DurationMicrosecondBuilder=Li;Z.DurationMillisecond=le;Z.DurationMillisecondBuilder=Ki;
Z.DurationNanosecond=ne;Z.DurationNanosecondBuilder=Mi;Z.DurationSecond=ke;Z.DurationSecondBuilder=Ji;Z.Field=V;Z.FixedSizeBinary=Ce;Z.FixedSizeBinaryBuilder=yi;Z.FixedSizeList=Ge;Z.FixedSizeListBuilder=zi;Z.Float=$c;Z.Float16=dd;Z.Float16Builder=Bi;Z.Float32=ed;Z.Float32Builder=Ci;Z.Float64=fd;Z.Float64Builder=Di;Z.FloatBuilder=Ai;Z.Int=Oc;Z.Int16=Tc;Z.Int16Builder=Pi;Z.Int32=Uc;Z.Int32Builder=Qi;Z.Int64=Vc;Z.Int64Builder=Ri;Z.Int8=Sc;Z.Int8Builder=Oi;Z.IntBuilder=Ni;Z.Interval=$d;
Z.IntervalBuilder=Ei;Z.IntervalDayTime=de;Z.IntervalDayTimeBuilder=Fi;Z.IntervalMonthDayNano=fe;Z.IntervalMonthDayNanoBuilder=Hi;Z.IntervalUnit=A;Z.IntervalYearMonth=ee;Z.IntervalYearMonthBuilder=Gi;Z.JSONMessageReader=Mk;Z.LargeBinary=kd;Z.LargeBinaryBuilder=qi;Z.LargeUtf8=sd;Z.LargeUtf8Builder=nj;Z.List=oe;Z.ListBuilder=Wi;Z.MapBuilder=Xi;Z.MapRow=ug;Z.Map_=Ke;Z.Message=kk;Z.MessageHeader=H;Z.MessageReader=Kk;Z.MetadataVersion=w;Z.Null=Mc;Z.NullBuilder=Yi;Z.Precision=y;Z.RecordBatch=Y;
Z.RecordBatchFileReader=al;Z.RecordBatchFileWriter=Bl;Z.RecordBatchJSONWriter=Cl;Z.RecordBatchReader=Sk;Z.RecordBatchStreamReader=Tk;Z.RecordBatchStreamWriter=Al;Z.RecordBatchWriter=xl;Z.Schema=T;Z.SparseUnion=Be;Z.SparseUnionBuilder=kj;Z.Struct=se;Z.StructBuilder=Zi;Z.StructRow=Rf;Z.Table=Nj;Z.Time=Kd;Z.TimeBuilder=ej;Z.TimeMicrosecond=Qd;Z.TimeMicrosecondBuilder=hj;Z.TimeMillisecond=Pd;Z.TimeMillisecondBuilder=gj;Z.TimeNanosecond=Rd;Z.TimeNanosecondBuilder=ij;Z.TimeSecond=Od;
Z.TimeSecondBuilder=fj;Z.TimeUnit=z;Z.Timestamp=Sd;Z.TimestampBuilder=$i;Z.TimestampMicrosecond=Yd;Z.TimestampMicrosecondBuilder=cj;Z.TimestampMillisecond=Xd;Z.TimestampMillisecondBuilder=bj;Z.TimestampNanosecond=Zd;Z.TimestampNanosecondBuilder=dj;Z.TimestampSecond=Wd;Z.TimestampSecondBuilder=aj;Z.Type=I;Z.Uint16=Xc;Z.Uint16Builder=Ti;Z.Uint32=Yc;Z.Uint32Builder=Ui;Z.Uint64=Zc;Z.Uint64Builder=Vi;Z.Uint8=Wc;Z.Uint8Builder=Si;Z.Union=we;Z.UnionBuilder=jj;Z.UnionMode=x;Z.Utf8=od;Z.Utf8Builder=mj;
Z.Vector=N;Z.Visitor=Ue;
Z.builderThroughAsyncIterable=function(a){const {queueingStrategy:b="count"}=a,{highWaterMark:c=b!=="bytes"?Number.POSITIVE_INFINITY:16384}=a,d=b!=="bytes"?"length":"byteLength";return function(e){return new oa(function*(){let f=0;const g=xi(a);var k;try{for(var m=ia(e);;){var p=yield new n(2,m.next());if(p.done)break;g.append(p.value)[d]>=c&&++f&&(yield new n(0,g.toVector()))}}catch(U){var r={error:U}}finally{try{p&&!p.done&&(k=m.return)&&(yield new n(2,k.call(m)))}finally{if(r)throw r.error;}}if(g.finish().length>
0||f===0)yield new n(0,g.toVector())}())}};Z.builderThroughIterable=Jj;Z.makeBuilder=xi;Z.makeData=Q;Z.makeTable=function(a){const b={};a=Object.entries(a);for(const [c,d]of a)b[c]=rh(d);return new Nj(b)};Z.makeVector=rh;Z.tableFromArrays=function(a){const b={};a=Object.entries(a);for(const [c,d]of a)b[c]=Hj(d);return new Nj(b)};Z.tableFromIPC=Ol;Z.tableFromJSON=function(a){a=Hj(a);a=new Y(new T(a.type.children),a.data[0]);return new Nj(a)};
Z.tableToIPC=function(a,b="stream"){return(b==="stream"?Al:Bl).writeAll(a).toUint8Array(!0)};Z.util=Pl;Z.vectorFromArray=Hj;Object.assign(arguments[0],Z);}.bind(this))));

//# sourceMappingURL=Arrow.es2015.min.js.map
